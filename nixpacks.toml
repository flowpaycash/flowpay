# FlowPay — Nixpacks build config
#
# Por que este arquivo existe:
# 1. A imagem Ubuntu do Railway tem npm/node mas NAO tem pnpm
#    → pnpm e instalado explicitamente via npm antes do install
# 2. better-sqlite3 e um modulo C++ nativo que precisa de ferramentas de compilacao
#    → python3, gcc, gnumake adicionados via Nix
# 3. @playwright/test em devDeps aciona download do Chromium (imagem enorme)
#    → --prod no install pula todas as devDependencies

[phases.setup]
nixPkgs = ["python3", "gcc", "gnumake"]
cmds = ["npm install -g pnpm"]

[phases.install]
cmds = ["pnpm install --frozen-lockfile --prod"]
