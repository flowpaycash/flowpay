import{G as d,I as a,o as s,v as u,w as l}from"./chunk-MKYDMTOZ.js";import{a as h,b as o}from"./chunk-W44JATXS.js";import{d as g,g as v}from"./chunk-BG6P72OF.js";var p=g((x,c)=>{c.exports=C;function C(i){i=i||{};var e=i.max||Number.MAX_SAFE_INTEGER,t=typeof i.start<"u"?i.start:Math.floor(Math.random()*e);return function(){return t=t%e,t++}}});var m=v(p());var P=(0,m.default)(),f=(function(i){return i.ACCOUNTS_CHANGED="accountsChanged",i.CHAIN_CHANGED="chainChanged",i.CONNECT="connect",i.DISCONNECT="disconnect",i.MESSAGE="message",i})({});var y=class extends u{constructor({config:e,state:t}){super({config:e,state:t}),h(this,"_providerEngineProxy",null),h(this,"keyExportFlagSetByCode",!1);let{chain:r}=e;if(!r)throw d.invalidProviderConfigError("Please provide chain");if(!r.chainId)throw d.invalidProviderConfigError("Please provide chainId inside chain");if(!r.rpcTarget)throw d.invalidProviderConfigError("Please provide rpcTarget inside chain");typeof e.keyExportEnabled=="boolean"&&(this.keyExportFlagSetByCode=!0),this.defaultState={chainId:"loading"},this.defaultConfig={chain:e.chain,chains:e.chains,keyExportEnabled:typeof e.keyExportEnabled=="boolean"?e.keyExportEnabled:!0},super.initialize()}get currentChain(){return this.config.chains.find(e=>e.chainId===this.state.chainId)}get provider(){return this._providerEngineProxy}get chainId(){return this.state.chainId}set provider(e){throw new Error("Method not implemented.")}async request(e){var t;if(!e||typeof e!="object"||Array.isArray(e))throw s.invalidRequest({message:a.invalidRequestArgs().message,data:o(o({},e||{}),{},{cause:a.invalidRequestArgs().message})});let{method:r,params:n}=e;if(typeof r!="string"||r.length===0)throw s.invalidRequest({message:a.invalidRequestMethod().message,data:o(o({},e||{}),{},{cause:a.invalidRequestMethod().message})});if(n!==void 0&&!Array.isArray(n)&&(typeof n!="object"||n===null))throw s.invalidRequest({message:a.invalidRequestParams().message,data:o(o({},e||{}),{},{cause:a.invalidRequestParams().message})});return(t=this.provider)===null||t===void 0?void 0:t.request(e)}sendAsync(e,t){return t?this.send(e,t):this.request(e)}send(e,t){this.request(e).then(r=>t(null,{result:r})).catch(r=>t(r,null))}updateProviderEngineProxy(e){if(this._providerEngineProxy){this._providerEngineProxy.setTarget(e);let t=r=>{r!=="newListener"&&e.on(r,(...n)=>{if(r===f.CHAIN_CHANGED){let E=n[0];this.update({chainId:E})}this.emit(r,...n)})};this.eventNames().forEach(r=>{t(r)}),this.on("newListener",r=>{this.listenerCount(r)>0||t(r)})}else this._providerEngineProxy=l(e)}setKeyExportFlag(e){this.keyExportFlagSetByCode||this.configure({keyExportEnabled:e})}getProviderEngineProxy(){return this._providerEngineProxy}getChain(e){return this.config.chains.find(t=>t.chainId===e)}};export{P as a,f as b,y as c};
