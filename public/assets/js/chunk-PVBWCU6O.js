import{a as N,b as v,d as D,e as M}from"./chunk-U5CWZESK.js";import{a as q}from"./chunk-5XACWPQJ.js";import{d,g as Pt}from"./chunk-BG6P72OF.js";var Z=d((Kr,k)=>{k.exports=de(Mt);k.exports.find=k.exports;k.exports.replace=function(e,t,r,i){return de(Ct).call(this,e,t,r,i),e};k.exports.del=function(e,t,r){return de(St).call(this,e,t,null,r),e};function de(e){return function(t,r,i,n){var a=n&&At(n.normalizer)?n.normalizer:Tt;r=a(r);for(var u,s=!1;!s;)l();function l(){for(u in t){var y=a(u);if(r.indexOf(y)===0){var F=r.substr(y.length);if(F.charAt(0)==="."||F.length===0){r=F.substr(1);var g=t[u];if(g==null){s=!0;return}if(!r.length){s=!0;return}t=g;return}}}u=void 0,s=!0}if(u)return t==null?t:e(t,u,i)}}function Mt(e,t){if(e.hasOwnProperty(t))return e[t]}function St(e,t){return e.hasOwnProperty(t)&&delete e[t],e}function Ct(e,t,r){return e.hasOwnProperty(t)&&(e[t]=r),e}function Tt(e){return e.replace(/[^a-zA-Z0-9\.]+/g,"").toLowerCase()}function At(e){return typeof e=="function"}});var Qe=d(B=>{"use strict";var Nt=B&&B.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(B,"__esModule",{value:!0});var P=Nt(Z());function E(e,t){return function(){var r=this.traits(),i=this.properties?this.properties():{};return P.default(r,"address."+e)||P.default(r,e)||(t?P.default(r,"address."+t):null)||(t?P.default(r,t):null)||P.default(i,"address."+e)||P.default(i,e)||(t?P.default(i,"address."+t):null)||(t?P.default(i,t):null)}}function kt(e){e.zip=E("postalCode","zip"),e.country=E("country"),e.street=E("street"),e.state=E("state"),e.city=E("city"),e.region=E("region")}B.default=kt});var Xe=d(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.clone=void 0;function he(e){if(typeof e!="object")return e;if(Object.prototype.toString.call(e)==="[object Object]"){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=he(e[r]));return t}else return Array.isArray(e)?e.map(he):e}ie.clone=he});var Ze=d(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});var Et={Salesforce:!0};function Rt(e){return!Et[e]}ye.default=Rt});var me=d(ve=>{"use strict";var Be=/^(\d{4})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:([ T])(\d{2}):?(\d{2})(?::?(\d{2})(?:[,\.](\d{1,}))?)?(?:(Z)|([+\-])(\d{2})(?::?(\d{2}))?)?)?$/;ve.parse=function(e){var t=[1,5,6,7,11,12],r=Be.exec(e),i=0;if(!r)return new Date(e);for(var n=0,a;a=t[n];n++)r[a]=parseInt(r[a],10)||0;r[2]=parseInt(r[2],10)||1,r[3]=parseInt(r[3],10)||1,r[2]--,r[8]=r[8]?(r[8]+"00").substring(0,3):0,r[4]===" "?i=new Date().getTimezoneOffset():r[9]!=="Z"&&r[10]&&(i=r[11]*60+r[12],r[10]==="+"&&(i=0-i));var u=Date.UTC(r[1],r[2],r[3],r[5],r[6]+i,r[7],r[8]);return new Date(u)};ve.is=function(e,t){return typeof e!="string"||t&&/^\d{4}-\d{2}-\d{2}/.test(e)===!1?!1:Be.test(e)}});var Ye=d(_e=>{"use strict";var zt=/\d{13}/;_e.is=function(e){return zt.test(e)};_e.parse=function(e){return e=parseInt(e,10),new Date(e)}});var Ke=d(ge=>{"use strict";var Gt=/\d{10}/;ge.is=function(e){return Gt.test(e)};ge.parse=function(e){var t=parseInt(e,10)*1e3;return new Date(t)}});var ne=d((oi,it)=>{"use strict";var We=me(),et=Ye(),tt=Ke(),Lt=Object.prototype,rt=Lt.toString;function Ht(e){return rt.call(e)==="[object Date]"}function Ut(e){return rt.call(e)==="[object Number]"}it.exports=function(t){return Ht(t)?t:Ut(t)?new Date(Vt(t)):We.is(t)?We.parse(t):et.is(t)?et.parse(t):tt.is(t)?tt.parse(t):new Date(t)};function Vt(e){return e<315576e5?e*1e3:e}});var at=d((ai,ot)=>{"use strict";var nt=me();ot.exports=xe;function xe(e,t){return t===void 0&&(t=!0),e&&typeof e=="object"?Jt(e,t):Array.isArray(e)?$t(e,t):nt.is(e,t)?nt.parse(e):e}function Jt(e,t){return Object.keys(e).forEach(function(r){e[r]=xe(e[r],t)}),e}function $t(e,t){return e.forEach(function(r,i){e[i]=xe(r,t)}),e}});var j=d(z=>{"use strict";var Y=z&&z.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(z,"__esModule",{value:!0});z.Facade=void 0;var Qt=Y(Qe()),R=Xe(),Xt=Y(Ze()),Zt=Y(ne()),be=Y(Z()),Bt=Y(at());function x(e,t){t=t||{},this.raw=R.clone(e),"clone"in t||(t.clone=!0),t.clone&&(e=R.clone(e)),"traverse"in t||(t.traverse=!0),"timestamp"in e?e.timestamp=Zt.default(e.timestamp):e.timestamp=new Date,t.traverse&&Bt.default(e),this.opts=t,this.obj=e}z.Facade=x;var f=x.prototype;f.proxy=function(e){var t=e.split(".");e=t.shift();var r=this[e]||this.obj[e];return r&&(typeof r=="function"&&(r=r.call(this)||{}),t.length===0?this.opts.clone?we(r):r:(r=be.default(r,t.join(".")),this.opts.clone?we(r):r))};f.field=function(e){var t=this.obj[e];return this.opts.clone?we(t):t};x.proxy=function(e){return function(){return this.proxy(e)}};x.field=function(e){return function(){return this.field(e)}};x.multi=function(e){return function(){var t=this.proxy(e+"s");if(Array.isArray(t))return t;var r=this.proxy(e);return r&&(r=[this.opts.clone?R.clone(r):r]),r||[]}};x.one=function(e){return function(){var t=this.proxy(e);if(t)return t;var r=this.proxy(e+"s");if(Array.isArray(r))return r[0]}};f.json=function(){var e=this.opts.clone?R.clone(this.obj):this.obj;return this.type&&(e.type=this.type()),e};f.rawEvent=function(){return this.raw};f.options=function(e){var t=this.obj.options||this.obj.context||{},r=this.opts.clone?R.clone(t):t;if(!e)return r;if(this.enabled(e)){var i=this.integrations(),n=i[e]||be.default(i,e);return typeof n!="object"&&(n=be.default(this.options(),e)),typeof n=="object"?n:{}}};f.context=f.options;f.enabled=function(e){var t=this.proxy("options.providers.all");typeof t!="boolean"&&(t=this.proxy("options.all")),typeof t!="boolean"&&(t=this.proxy("integrations.all")),typeof t!="boolean"&&(t=!0);var r=t&&Xt.default(e),i=this.integrations();if(i.providers&&i.providers.hasOwnProperty(e)&&(r=i.providers[e]),i.hasOwnProperty(e)){var n=i[e];typeof n=="boolean"?r=n:r=!0}return!!r};f.integrations=function(){return this.obj.integrations||this.proxy("options.providers")||this.options()};f.active=function(){var e=this.proxy("options.active");return e==null&&(e=!0),e};f.anonymousId=function(){return this.field("anonymousId")||this.field("sessionId")};f.sessionId=f.anonymousId;f.groupId=x.proxy("options.groupId");f.traits=function(e){var t=this.proxy("options.traits")||{},r=this.userId();e=e||{},r&&(t.id=r);for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=this[i]==null?this.proxy("options.traits."+i):this[i]();if(n==null)continue;t[e[i]]=n,delete t[i]}return t};f.library=function(){var e=this.proxy("options.library");return e?typeof e=="string"?{name:e,version:null}:e:{name:"unknown",version:null}};f.device=function(){var e=this.proxy("context.device");(typeof e!="object"||e===null)&&(e={});var t=this.library().name;return e.type||(t.indexOf("ios")>-1&&(e.type="ios"),t.indexOf("android")>-1&&(e.type="android")),e};f.userAgent=x.proxy("context.userAgent");f.timezone=x.proxy("context.timezone");f.timestamp=x.field("timestamp");f.channel=x.field("channel");f.ip=x.proxy("context.ip");f.userId=x.field("userId");Qt.default(f);function we(e){return R.clone(e)}});var st=d(G=>{"use strict";var Yt=G&&G.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(G,"__esModule",{value:!0});G.Alias=void 0;var Kt=Yt(q()),ut=j();function w(e,t){ut.Facade.call(this,e,t)}G.Alias=w;Kt.default(w,ut.Facade);w.prototype.action=function(){return"alias"};w.prototype.type=w.prototype.action;w.prototype.previousId=function(){return this.field("previousId")||this.field("from")};w.prototype.from=w.prototype.previousId;w.prototype.userId=function(){return this.field("userId")||this.field("to")};w.prototype.to=w.prototype.userId});var K=d(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});var Wt=/.+\@.+\..+/;function er(e){return Wt.test(e)}Ie.default=er});var ft=d(L=>{"use strict";var Fe=L&&L.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(L,"__esModule",{value:!0});L.Group=void 0;var tr=Fe(q()),rr=Fe(K()),ir=Fe(ne()),H=j();function Oe(e,t){H.Facade.call(this,e,t)}L.Group=Oe;tr.default(Oe,H.Facade);var I=Oe.prototype;I.action=function(){return"group"};I.type=I.action;I.groupId=H.Facade.field("groupId");I.created=function(){var e=this.proxy("traits.createdAt")||this.proxy("traits.created")||this.proxy("properties.createdAt")||this.proxy("properties.created");if(e)return ir.default(e)};I.email=function(){var e=this.proxy("traits.email");if(e)return e;var t=this.groupId();if(rr.default(t))return t};I.traits=function(e){var t=this.properties(),r=this.groupId();e=e||{},r&&(t.id=r);for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=this[i]==null?this.proxy("traits."+i):this[i]();if(n==null)continue;t[e[i]]=n,delete t[i]}return t};I.name=H.Facade.proxy("traits.name");I.industry=H.Facade.proxy("traits.industry");I.employees=H.Facade.proxy("traits.employees");I.properties=function(){return this.field("traits")||this.field("properties")||{}}});var je=d(V=>{"use strict";var oe=V&&V.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(V,"__esModule",{value:!0});V.Identify=void 0;var O=j(),U=oe(Z()),nr=oe(q()),or=oe(K()),ct=oe(ne()),C=function(e){return e.trim()};function Pe(e,t){O.Facade.call(this,e,t)}V.Identify=Pe;nr.default(Pe,O.Facade);var c=Pe.prototype;c.action=function(){return"identify"};c.type=c.action;c.traits=function(e){var t=this.field("traits")||{},r=this.userId();e=e||{},r&&(t.id=r);for(var i in e){var n=this[i]==null?this.proxy("traits."+i):this[i]();n!=null&&(t[e[i]]=n,i!==e[i]&&delete t[i])}return t};c.email=function(){var e=this.proxy("traits.email");if(e)return e;var t=this.userId();if(or.default(t))return t};c.created=function(){var e=this.proxy("traits.created")||this.proxy("traits.createdAt");if(e)return ct.default(e)};c.companyCreated=function(){var e=this.proxy("traits.company.created")||this.proxy("traits.company.createdAt");if(e)return ct.default(e)};c.companyName=function(){return this.proxy("traits.company.name")};c.name=function(){var e=this.proxy("traits.name");if(typeof e=="string")return C(e);var t=this.firstName(),r=this.lastName();if(t&&r)return C(t+" "+r)};c.firstName=function(){var e=this.proxy("traits.firstName");if(typeof e=="string")return C(e);var t=this.proxy("traits.name");if(typeof t=="string")return C(t).split(" ")[0]};c.lastName=function(){var e=this.proxy("traits.lastName");if(typeof e=="string")return C(e);var t=this.proxy("traits.name");if(typeof t=="string"){var r=C(t).indexOf(" ");if(r!==-1)return C(t.substr(r+1))}};c.uid=function(){return this.userId()||this.username()||this.email()};c.description=function(){return this.proxy("traits.description")||this.proxy("traits.background")};c.age=function(){var e=this.birthday(),t=U.default(this.traits(),"age");if(t!=null)return t;if(e instanceof Date){var r=new Date;return r.getFullYear()-e.getFullYear()}};c.avatar=function(){var e=this.traits();return U.default(e,"avatar")||U.default(e,"photoUrl")||U.default(e,"avatarUrl")};c.position=function(){var e=this.traits();return U.default(e,"position")||U.default(e,"jobTitle")};c.username=O.Facade.proxy("traits.username");c.website=O.Facade.one("traits.website");c.websites=O.Facade.multi("traits.website");c.phone=O.Facade.one("traits.phone");c.phones=O.Facade.multi("traits.phone");c.address=O.Facade.proxy("traits.address");c.gender=O.Facade.proxy("traits.gender");c.birthday=O.Facade.proxy("traits.birthday")});var ae=d(J=>{"use strict";var qe=J&&J.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(J,"__esModule",{value:!0});J.Track=void 0;var ar=qe(q()),h=j(),ur=je(),sr=qe(K()),pt=qe(Z());function De(e,t){h.Facade.call(this,e,t)}J.Track=De;ar.default(De,h.Facade);var o=De.prototype;o.action=function(){return"track"};o.type=o.action;o.event=h.Facade.field("event");o.value=h.Facade.proxy("properties.value");o.category=h.Facade.proxy("properties.category");o.id=h.Facade.proxy("properties.id");o.productId=function(){return this.proxy("properties.product_id")||this.proxy("properties.productId")};o.promotionId=function(){return this.proxy("properties.promotion_id")||this.proxy("properties.promotionId")};o.cartId=function(){return this.proxy("properties.cart_id")||this.proxy("properties.cartId")};o.checkoutId=function(){return this.proxy("properties.checkout_id")||this.proxy("properties.checkoutId")};o.paymentId=function(){return this.proxy("properties.payment_id")||this.proxy("properties.paymentId")};o.couponId=function(){return this.proxy("properties.coupon_id")||this.proxy("properties.couponId")};o.wishlistId=function(){return this.proxy("properties.wishlist_id")||this.proxy("properties.wishlistId")};o.reviewId=function(){return this.proxy("properties.review_id")||this.proxy("properties.reviewId")};o.orderId=function(){return this.proxy("properties.id")||this.proxy("properties.order_id")||this.proxy("properties.orderId")};o.sku=h.Facade.proxy("properties.sku");o.tax=h.Facade.proxy("properties.tax");o.name=h.Facade.proxy("properties.name");o.price=h.Facade.proxy("properties.price");o.total=h.Facade.proxy("properties.total");o.repeat=h.Facade.proxy("properties.repeat");o.coupon=h.Facade.proxy("properties.coupon");o.shipping=h.Facade.proxy("properties.shipping");o.discount=h.Facade.proxy("properties.discount");o.shippingMethod=function(){return this.proxy("properties.shipping_method")||this.proxy("properties.shippingMethod")};o.paymentMethod=function(){return this.proxy("properties.payment_method")||this.proxy("properties.paymentMethod")};o.description=h.Facade.proxy("properties.description");o.plan=h.Facade.proxy("properties.plan");o.subtotal=function(){var e=pt.default(this.properties(),"subtotal"),t=this.total()||this.revenue();if(e)return e;if(!t)return 0;if(this.total()){var r=this.tax();r&&(t-=r),r=this.shipping(),r&&(t-=r),r=this.discount(),r&&(t+=r)}return t};o.products=function(){var e=this.properties(),t=pt.default(e,"products");return Array.isArray(t)?t.filter(function(r){return r!==null}):[]};o.quantity=function(){var e=this.obj.properties||{};return e.quantity||1};o.currency=function(){var e=this.obj.properties||{};return e.currency||"USD"};o.referrer=function(){return this.proxy("context.referrer.url")||this.proxy("context.page.referrer")||this.proxy("properties.referrer")};o.query=h.Facade.proxy("options.query");o.properties=function(e){var t=this.field("properties")||{};e=e||{};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=this[r]==null?this.proxy("properties."+r):this[r]();if(i==null)continue;t[e[r]]=i,delete t[r]}return t};o.username=function(){return this.proxy("traits.username")||this.proxy("properties.username")||this.userId()||this.sessionId()};o.email=function(){var e=this.proxy("traits.email")||this.proxy("properties.email")||this.proxy("options.traits.email");if(e)return e;var t=this.userId();if(sr.default(t))return t};o.revenue=function(){var e=this.proxy("properties.revenue"),t=this.event(),r=/^[ _]?completed[ _]?order[ _]?|^[ _]?order[ _]?completed[ _]?$/i;return!e&&t&&t.match(r)&&(e=this.proxy("properties.total")),fr(e)};o.cents=function(){var e=this.revenue();return typeof e!="number"?this.value()||0:e*100};o.identify=function(){var e=this.json();return e.traits=this.traits(),new ur.Identify(e,this.opts)};function fr(e){if(e){if(typeof e=="number")return e;if(typeof e=="string"&&(e=e.replace(/\$/g,""),e=parseFloat(e),!isNaN(e)))return e}}});var Se=d($=>{"use strict";var lt=$&&$.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($,"__esModule",{value:!0});$.Page=void 0;var cr=lt(q()),T=j(),pr=ae(),lr=lt(K());function Me(e,t){T.Facade.call(this,e,t)}$.Page=Me;cr.default(Me,T.Facade);var m=Me.prototype;m.action=function(){return"page"};m.type=m.action;m.category=T.Facade.field("category");m.name=T.Facade.field("name");m.title=T.Facade.proxy("properties.title");m.path=T.Facade.proxy("properties.path");m.url=T.Facade.proxy("properties.url");m.referrer=function(){return this.proxy("context.referrer.url")||this.proxy("context.page.referrer")||this.proxy("properties.referrer")};m.properties=function(e){var t=this.field("properties")||{},r=this.category(),i=this.name();e=e||{},r&&(t.category=r),i&&(t.name=i);for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=this[n]==null?this.proxy("properties."+n):this[n]();if(a==null)continue;t[e[n]]=a,n!==e[n]&&delete t[n]}return t};m.email=function(){var e=this.proxy("context.traits.email")||this.proxy("properties.email");if(e)return e;var t=this.userId();if(lr.default(t))return t};m.fullName=function(){var e=this.category(),t=this.name();return t&&e?e+" "+t:t};m.event=function(e){return e?"Viewed "+e+" Page":"Loaded a Page"};m.track=function(e){var t=this.json();return t.event=this.event(e),t.timestamp=this.timestamp(),t.properties=this.properties(),new pr.Track(t,this.opts)}});var ht=d(Q=>{"use strict";var dr=Q&&Q.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Q,"__esModule",{value:!0});Q.Screen=void 0;var hr=dr(q()),dt=Se(),yr=ae();function A(e,t){dt.Page.call(this,e,t)}Q.Screen=A;hr.default(A,dt.Page);A.prototype.action=function(){return"screen"};A.prototype.type=A.prototype.action;A.prototype.event=function(e){return e?"Viewed "+e+" Screen":"Loaded a Screen"};A.prototype.track=function(e){var t=this.json();return t.event=this.event(e),t.timestamp=this.timestamp(),t.properties=this.properties(),new yr.Track(t,this.opts)}});var vt=d(X=>{"use strict";var vr=X&&X.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(X,"__esModule",{value:!0});X.Delete=void 0;var mr=vr(q()),yt=j();function Ce(e,t){yt.Facade.call(this,e,t)}X.Delete=Ce;mr.default(Ce,yt.Facade);Ce.prototype.type=function(){return"delete"}});var Ot=d(p=>{"use strict";var ue=p&&p.__assign||function(){return ue=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},ue.apply(this,arguments)};Object.defineProperty(p,"__esModule",{value:!0});p.Delete=p.Screen=p.Page=p.Track=p.Identify=p.Group=p.Alias=p.Facade=void 0;var mt=j();Object.defineProperty(p,"Facade",{enumerable:!0,get:function(){return mt.Facade}});var _t=st();Object.defineProperty(p,"Alias",{enumerable:!0,get:function(){return _t.Alias}});var gt=ft();Object.defineProperty(p,"Group",{enumerable:!0,get:function(){return gt.Group}});var xt=je();Object.defineProperty(p,"Identify",{enumerable:!0,get:function(){return xt.Identify}});var bt=ae();Object.defineProperty(p,"Track",{enumerable:!0,get:function(){return bt.Track}});var wt=Se();Object.defineProperty(p,"Page",{enumerable:!0,get:function(){return wt.Page}});var It=ht();Object.defineProperty(p,"Screen",{enumerable:!0,get:function(){return It.Screen}});var Ft=vt();Object.defineProperty(p,"Delete",{enumerable:!0,get:function(){return Ft.Delete}});p.default=ue(ue({},mt.Facade),{Alias:_t.Alias,Group:gt.Group,Identify:xt.Identify,Track:bt.Track,Page:wt.Page,Screen:It.Screen,Delete:Ft.Delete})});function Ae(e,t,r){t.split&&(t=t.split("."));for(var i=0,n=t.length,a=e,u,s;i<n&&(s=""+t[i++],!(s==="__proto__"||s==="constructor"||s==="prototype"));)a=a[s]=i===n?r:typeof(u=a[s])==typeof t?u:t[i]*0!==0||~(""+t[i]).indexOf(".")?{}:[]}var S=256,ee=[],W;for(;S--;)ee[S]=(S+256).toString(16).substring(1);function Ne(){var e=0,t,r="";if(!W||S+16>256){for(W=Array(e=256);e--;)W[e]=256*Math.random()|0;e=S=0}for(;e<16;e++)t=W[S+e],e==6?r+=ee[t&15|64]:e==8?r+=ee[t&63|128]:r+=ee[t],e&1&&e>1&&e<11&&(r+="-");return S++,r}var ke=(function(){function e(){this._logs=[]}return e.prototype.log=function(t,r,i){var n=new Date;this._logs.push({level:t,message:r,time:n,extras:i})},Object.defineProperty(e.prototype,"logs",{get:function(){return this._logs},enumerable:!1,configurable:!0}),e.prototype.flush=function(){if(this.logs.length>1)var t=this._logs.reduce(function(r,i){var n,a,u,s=v(v({},i),{json:JSON.stringify(i.extras,null," "),extras:i.extras});delete s.time;var l=(u=(a=i.time)===null||a===void 0?void 0:a.toISOString())!==null&&u!==void 0?u:"";return r[l]&&(l="".concat(l,"-").concat(Math.random())),v(v({},r),(n={},n[l]=s,n))},{});else this.logs.forEach(function(r){var i=r.level,n=r.message,a=r.extras});this._logs=[]},e})();var jt=function(e){var t={gauge:"g",counter:"c"};return t[e]},pe=(function(){function e(){this.metrics=[]}return e.prototype.increment=function(t,r,i){r===void 0&&(r=1),this.metrics.push({metric:t,value:r,tags:i??[],type:"counter",timestamp:Date.now()})},e.prototype.gauge=function(t,r,i){this.metrics.push({metric:t,value:r,tags:i??[],type:"gauge",timestamp:Date.now()})},e.prototype.flush=function(){var t=this.metrics.map(function(r){return v(v({},r),{tags:r.tags.join(",")})});this.metrics=[]},e.prototype.serialize=function(){return this.metrics.map(function(t){return{m:t.metric,v:t.value,t:t.tags,k:jt(t.type),e:t.timestamp}})},e})();var Ee=(function(e){N(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.gauge=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i]},t.prototype.increment=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i]},t.prototype.flush=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i]},t.prototype.serialize=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return[]},t})(pe);var te=(function(){function e(t){var r,i,n;this.retry=(r=t.retry)!==null&&r!==void 0?r:!0,this.type=(i=t.type)!==null&&i!==void 0?i:"plugin Error",this.reason=(n=t.reason)!==null&&n!==void 0?n:""}return e})();var Re=(function(){function e(t,r,i,n){r===void 0&&(r=Ne()),i===void 0&&(i=new Ee),n===void 0&&(n=new ke),this.attempts=0,this.event=t,this._id=r,this.logger=n,this.stats=i}return e.system=function(){},e.prototype.isSame=function(t){return t.id===this.id},e.prototype.cancel=function(t){throw t||new te({reason:"Context Cancel"})},e.prototype.log=function(t,r,i){this.logger.log(t,r,i)},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),e.prototype.updateEvent=function(t,r){var i;if(t.split(".")[0]==="integrations"){var n=t.split(".")[1];if(((i=this.event.integrations)===null||i===void 0?void 0:i[n])===!1)return this.event}return Ae(this.event,t,r),this.event},e.prototype.failedDelivery=function(){return this._failedDelivery},e.prototype.setFailedDelivery=function(t){this._failedDelivery=t},e.prototype.logs=function(){return this.logger.logs},e.prototype.flush=function(){this.logger.flush(),this.stats.flush()},e.prototype.toJSON=function(){return{id:this._id,event:this.event,logs:this.logger.logs,metrics:this.stats.metrics}},e})();function ze(e,t){return t=t||{},new Promise(function(r,i){var n=new XMLHttpRequest,a=[],u=[],s={},l=function(){return{ok:(n.status/100|0)==2,statusText:n.statusText,status:n.status,url:n.responseURL,text:function(){return Promise.resolve(n.responseText)},json:function(){return Promise.resolve(n.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([n.response]))},clone:l,headers:{keys:function(){return a},entries:function(){return u},get:function(F){return s[F.toLowerCase()]},has:function(F){return F.toLowerCase()in s}}}};for(var y in n.open(t.method||"get",e,!0),n.onload=function(){n.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(F,g,b){a.push(g=g.toLowerCase()),u.push([g,b]),s[g]=s[g]?s[g]+","+b:b}),r(l())},n.onerror=i,n.withCredentials=t.credentials=="include",t.headers)n.setRequestHeader(y,t.headers[y]);n.send(t.body||null)})}var Ge=function(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:null};var Le=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Ge();return(r&&r.fetch||ze).apply(void 0,e)};var le="1.81.1";var qt="npm";function He(){return qt}var Ue="api.segment.io/v1";var Dt=function(e,t,r){var i=t.reduce(function(n,a){var u=a.split(":"),s=u[0],l=u[1];return n[s]=l,n},{});return{type:"Counter",metric:e,value:1,tags:v(v({},i),{library:"analytics.js",library_version:r==="web"?"next-".concat(le):"npm:next-".concat(le)})}};function Ve(e){}var Je=(function(){function e(t){var r=this,i,n,a,u,s;if(this.host=(i=t?.host)!==null&&i!==void 0?i:Ue,this.sampleRate=(n=t?.sampleRate)!==null&&n!==void 0?n:1,this.flushTimer=(a=t?.flushTimer)!==null&&a!==void 0?a:30*1e3,this.maxQueueSize=(u=t?.maxQueueSize)!==null&&u!==void 0?u:20,this.protocol=(s=t?.protocol)!==null&&s!==void 0?s:"https",this.queue=[],this.sampleRate>0){var l=!1,y=function(){l||(l=!0,r.flush().catch(Ve),l=!1,setTimeout(y,r.flushTimer))};y()}}return e.prototype.increment=function(t,r){if(t.includes("analytics_js.")&&r.length!==0&&!(Math.random()>this.sampleRate)&&!(this.queue.length>=this.maxQueueSize)){var i=Dt(t,r,He());this.queue.push(i),t.includes("error")&&this.flush().catch(Ve)}},e.prototype.flush=function(){return D(this,void 0,void 0,function(){var t=this;return M(this,function(r){switch(r.label){case 0:return this.queue.length<=0?[2]:[4,this.send().catch(function(i){t.sampleRate=0})];case 1:return r.sent(),[2]}})})},e.prototype.send=function(){return D(this,void 0,void 0,function(){var t,r,i;return M(this,function(n){return t={series:this.queue},this.queue=[],r={"Content-Type":"text/plain"},i="".concat(this.protocol,"://").concat(this.host,"/m"),[2,Le(i,{headers:r,body:JSON.stringify(t),method:"POST"})]})})},e})();var re,$e=(function(e){N(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.initRemoteMetrics=function(r){re=new Je(r)},t.prototype.increment=function(r,i,n){e.prototype.increment.call(this,r,i,n),re?.increment(r,n??[])},t})(pe);var Br=(function(e){N(t,e);function t(r,i){return e.call(this,r,i,new $e)||this}return t.system=function(){return new this({type:"track",event:"system"})},t})(Re);var _=Pt(Ot());function se(e,t){var r=new _.Facade(e,t);return e.type==="track"&&(r=new _.Track(e,t)),e.type==="identify"&&(r=new _.Identify(e,t)),e.type==="page"&&(r=new _.Page(e,t)),e.type==="alias"&&(r=new _.Alias(e,t)),e.type==="group"&&(r=new _.Group(e,t)),e.type==="screen"&&(r=new _.Screen(e,t)),Object.defineProperty(r,"obj",{value:e,writable:!0}),r}function bi(e,t,r){return D(this,void 0,void 0,function(){function i(y,F){return D(this,void 0,void 0,function(){var g,b,fe;return M(this,function(Te){switch(Te.label){case 0:return g=!1,b=null,[4,F({payload:se(y,{clone:!0,traverse:!1}),integration:e,next:function(ce){g=!0,ce===null&&(b=null),ce&&(b=ce.obj)}})];case 1:return Te.sent(),!g&&b!==null&&(b=b,b.integrations=v(v({},y.integrations),(fe={},fe[e]=!1,fe))),[2,b]}})})}var n,a,u,s,l;return M(this,function(y){switch(y.label){case 0:n=se(t,{clone:!0,traverse:!1}).rawEvent(),a=0,u=r,y.label=1;case 1:return a<u.length?(s=u[a],[4,i(n,s)]):[3,4];case 2:if(l=y.sent(),l===null)return[2,null];n=l,y.label=3;case 3:return a++,[3,1];case 4:return[2,n]}})})}function wi(e,t){function r(i){return D(this,void 0,void 0,function(){var n;return M(this,function(a){switch(a.label){case 0:return n=!1,[4,e({payload:se(i.event,{clone:!0,traverse:!1}),integrations:t??{},next:function(u){n=!0,u&&(i.event=u.obj)}})];case 1:if(a.sent(),!n)throw new te({retry:!1,type:"middleware_cancellation",reason:"Middleware `next` function skipped"});return[2,i]}})})}return{name:"Source Middleware ".concat(e.name),type:"before",version:"0.1.0",isLoaded:function(){return!0},load:function(i){return Promise.resolve(i)},track:r,page:r,screen:r,identify:r,alias:r,group:r}}export{Ae as a,Ne as b,te as c,Re as d,Ge as e,Le as f,le as g,He as h,Ue as i,$e as j,Br as k,Ot as l,se as m,bi as n,wi as o};
