import{b as Cr,c as De,d as Kn,e as jn,g as Ro,i as Rr,j as Po,k as Wt,l as Oo,m as Uo,o as Mo,r as Fo,u as Ko}from"./chunk-GWB75M73.js";import{a as Ho}from"./chunk-NJS66JOX.js";import{a as y,b as M,d as Fn,e as Co,f as Gt,j as Bo}from"./chunk-W44JATXS.js";import{a as Lo,b as Pr,c as Do,d as ko}from"./chunk-BXV67TBK.js";import{a as No,d as Hn,g as Te}from"./chunk-BG6P72OF.js";var jo=Hn((ri,$t)=>{(function(o){"use strict";var t=function(r){var i,s=new Float64Array(16);if(r)for(i=0;i<r.length;i++)s[i]=r[i];return s},n=function(){throw new Error("no PRNG")},f=new Uint8Array(16),d=new Uint8Array(32);d[0]=9;var h=t(),m=t([1]),A=t([56129,1]),D=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),z=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),fe=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),ie=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),xe=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Ae(r,i,s,e){r[i]=s>>24&255,r[i+1]=s>>16&255,r[i+2]=s>>8&255,r[i+3]=s&255,r[i+4]=e>>24&255,r[i+5]=e>>16&255,r[i+6]=e>>8&255,r[i+7]=e&255}function we(r,i,s,e,a){var u,l=0;for(u=0;u<a;u++)l|=r[i+u]^s[e+u];return(1&l-1>>>8)-1}function Ee(r,i,s,e){return we(r,i,s,e,16)}function Le(r,i,s,e){return we(r,i,s,e,32)}function ye(r,i,s,e){for(var a=e[0]&255|(e[1]&255)<<8|(e[2]&255)<<16|(e[3]&255)<<24,u=s[0]&255|(s[1]&255)<<8|(s[2]&255)<<16|(s[3]&255)<<24,l=s[4]&255|(s[5]&255)<<8|(s[6]&255)<<16|(s[7]&255)<<24,g=s[8]&255|(s[9]&255)<<8|(s[10]&255)<<16|(s[11]&255)<<24,T=s[12]&255|(s[13]&255)<<8|(s[14]&255)<<16|(s[15]&255)<<24,O=e[4]&255|(e[5]&255)<<8|(e[6]&255)<<16|(e[7]&255)<<24,v=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,Z=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,N=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,k=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24,B=e[8]&255|(e[9]&255)<<8|(e[10]&255)<<16|(e[11]&255)<<24,Y=s[16]&255|(s[17]&255)<<8|(s[18]&255)<<16|(s[19]&255)<<24,j=s[20]&255|(s[21]&255)<<8|(s[22]&255)<<16|(s[23]&255)<<24,H=s[24]&255|(s[25]&255)<<8|(s[26]&255)<<16|(s[27]&255)<<24,K=s[28]&255|(s[29]&255)<<8|(s[30]&255)<<16|(s[31]&255)<<24,F=e[12]&255|(e[13]&255)<<8|(e[14]&255)<<16|(e[15]&255)<<24,C=a,U=u,I=l,R=g,P=T,b=O,p=v,x=Z,_=N,E=k,S=B,w=Y,L=j,V=H,W=K,G=F,c,J=0;J<20;J+=2)c=C+L|0,P^=c<<7|c>>>25,c=P+C|0,_^=c<<9|c>>>23,c=_+P|0,L^=c<<13|c>>>19,c=L+_|0,C^=c<<18|c>>>14,c=b+U|0,E^=c<<7|c>>>25,c=E+b|0,V^=c<<9|c>>>23,c=V+E|0,U^=c<<13|c>>>19,c=U+V|0,b^=c<<18|c>>>14,c=S+p|0,W^=c<<7|c>>>25,c=W+S|0,I^=c<<9|c>>>23,c=I+W|0,p^=c<<13|c>>>19,c=p+I|0,S^=c<<18|c>>>14,c=G+w|0,R^=c<<7|c>>>25,c=R+G|0,x^=c<<9|c>>>23,c=x+R|0,w^=c<<13|c>>>19,c=w+x|0,G^=c<<18|c>>>14,c=C+R|0,U^=c<<7|c>>>25,c=U+C|0,I^=c<<9|c>>>23,c=I+U|0,R^=c<<13|c>>>19,c=R+I|0,C^=c<<18|c>>>14,c=b+P|0,p^=c<<7|c>>>25,c=p+b|0,x^=c<<9|c>>>23,c=x+p|0,P^=c<<13|c>>>19,c=P+x|0,b^=c<<18|c>>>14,c=S+E|0,w^=c<<7|c>>>25,c=w+S|0,_^=c<<9|c>>>23,c=_+w|0,E^=c<<13|c>>>19,c=E+_|0,S^=c<<18|c>>>14,c=G+W|0,L^=c<<7|c>>>25,c=L+G|0,V^=c<<9|c>>>23,c=V+L|0,W^=c<<13|c>>>19,c=W+V|0,G^=c<<18|c>>>14;C=C+a|0,U=U+u|0,I=I+l|0,R=R+g|0,P=P+T|0,b=b+O|0,p=p+v|0,x=x+Z|0,_=_+N|0,E=E+k|0,S=S+B|0,w=w+Y|0,L=L+j|0,V=V+H|0,W=W+K|0,G=G+F|0,r[0]=C>>>0&255,r[1]=C>>>8&255,r[2]=C>>>16&255,r[3]=C>>>24&255,r[4]=U>>>0&255,r[5]=U>>>8&255,r[6]=U>>>16&255,r[7]=U>>>24&255,r[8]=I>>>0&255,r[9]=I>>>8&255,r[10]=I>>>16&255,r[11]=I>>>24&255,r[12]=R>>>0&255,r[13]=R>>>8&255,r[14]=R>>>16&255,r[15]=R>>>24&255,r[16]=P>>>0&255,r[17]=P>>>8&255,r[18]=P>>>16&255,r[19]=P>>>24&255,r[20]=b>>>0&255,r[21]=b>>>8&255,r[22]=b>>>16&255,r[23]=b>>>24&255,r[24]=p>>>0&255,r[25]=p>>>8&255,r[26]=p>>>16&255,r[27]=p>>>24&255,r[28]=x>>>0&255,r[29]=x>>>8&255,r[30]=x>>>16&255,r[31]=x>>>24&255,r[32]=_>>>0&255,r[33]=_>>>8&255,r[34]=_>>>16&255,r[35]=_>>>24&255,r[36]=E>>>0&255,r[37]=E>>>8&255,r[38]=E>>>16&255,r[39]=E>>>24&255,r[40]=S>>>0&255,r[41]=S>>>8&255,r[42]=S>>>16&255,r[43]=S>>>24&255,r[44]=w>>>0&255,r[45]=w>>>8&255,r[46]=w>>>16&255,r[47]=w>>>24&255,r[48]=L>>>0&255,r[49]=L>>>8&255,r[50]=L>>>16&255,r[51]=L>>>24&255,r[52]=V>>>0&255,r[53]=V>>>8&255,r[54]=V>>>16&255,r[55]=V>>>24&255,r[56]=W>>>0&255,r[57]=W>>>8&255,r[58]=W>>>16&255,r[59]=W>>>24&255,r[60]=G>>>0&255,r[61]=G>>>8&255,r[62]=G>>>16&255,r[63]=G>>>24&255}function Ot(r,i,s,e){for(var a=e[0]&255|(e[1]&255)<<8|(e[2]&255)<<16|(e[3]&255)<<24,u=s[0]&255|(s[1]&255)<<8|(s[2]&255)<<16|(s[3]&255)<<24,l=s[4]&255|(s[5]&255)<<8|(s[6]&255)<<16|(s[7]&255)<<24,g=s[8]&255|(s[9]&255)<<8|(s[10]&255)<<16|(s[11]&255)<<24,T=s[12]&255|(s[13]&255)<<8|(s[14]&255)<<16|(s[15]&255)<<24,O=e[4]&255|(e[5]&255)<<8|(e[6]&255)<<16|(e[7]&255)<<24,v=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,Z=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,N=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,k=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24,B=e[8]&255|(e[9]&255)<<8|(e[10]&255)<<16|(e[11]&255)<<24,Y=s[16]&255|(s[17]&255)<<8|(s[18]&255)<<16|(s[19]&255)<<24,j=s[20]&255|(s[21]&255)<<8|(s[22]&255)<<16|(s[23]&255)<<24,H=s[24]&255|(s[25]&255)<<8|(s[26]&255)<<16|(s[27]&255)<<24,K=s[28]&255|(s[29]&255)<<8|(s[30]&255)<<16|(s[31]&255)<<24,F=e[12]&255|(e[13]&255)<<8|(e[14]&255)<<16|(e[15]&255)<<24,C=a,U=u,I=l,R=g,P=T,b=O,p=v,x=Z,_=N,E=k,S=B,w=Y,L=j,V=H,W=K,G=F,c,J=0;J<20;J+=2)c=C+L|0,P^=c<<7|c>>>25,c=P+C|0,_^=c<<9|c>>>23,c=_+P|0,L^=c<<13|c>>>19,c=L+_|0,C^=c<<18|c>>>14,c=b+U|0,E^=c<<7|c>>>25,c=E+b|0,V^=c<<9|c>>>23,c=V+E|0,U^=c<<13|c>>>19,c=U+V|0,b^=c<<18|c>>>14,c=S+p|0,W^=c<<7|c>>>25,c=W+S|0,I^=c<<9|c>>>23,c=I+W|0,p^=c<<13|c>>>19,c=p+I|0,S^=c<<18|c>>>14,c=G+w|0,R^=c<<7|c>>>25,c=R+G|0,x^=c<<9|c>>>23,c=x+R|0,w^=c<<13|c>>>19,c=w+x|0,G^=c<<18|c>>>14,c=C+R|0,U^=c<<7|c>>>25,c=U+C|0,I^=c<<9|c>>>23,c=I+U|0,R^=c<<13|c>>>19,c=R+I|0,C^=c<<18|c>>>14,c=b+P|0,p^=c<<7|c>>>25,c=p+b|0,x^=c<<9|c>>>23,c=x+p|0,P^=c<<13|c>>>19,c=P+x|0,b^=c<<18|c>>>14,c=S+E|0,w^=c<<7|c>>>25,c=w+S|0,_^=c<<9|c>>>23,c=_+w|0,E^=c<<13|c>>>19,c=E+_|0,S^=c<<18|c>>>14,c=G+W|0,L^=c<<7|c>>>25,c=L+G|0,V^=c<<9|c>>>23,c=V+L|0,W^=c<<13|c>>>19,c=W+V|0,G^=c<<18|c>>>14;r[0]=C>>>0&255,r[1]=C>>>8&255,r[2]=C>>>16&255,r[3]=C>>>24&255,r[4]=b>>>0&255,r[5]=b>>>8&255,r[6]=b>>>16&255,r[7]=b>>>24&255,r[8]=S>>>0&255,r[9]=S>>>8&255,r[10]=S>>>16&255,r[11]=S>>>24&255,r[12]=G>>>0&255,r[13]=G>>>8&255,r[14]=G>>>16&255,r[15]=G>>>24&255,r[16]=p>>>0&255,r[17]=p>>>8&255,r[18]=p>>>16&255,r[19]=p>>>24&255,r[20]=x>>>0&255,r[21]=x>>>8&255,r[22]=x>>>16&255,r[23]=x>>>24&255,r[24]=_>>>0&255,r[25]=_>>>8&255,r[26]=_>>>16&255,r[27]=_>>>24&255,r[28]=E>>>0&255,r[29]=E>>>8&255,r[30]=E>>>16&255,r[31]=E>>>24&255}function Ut(r,i,s,e){ye(r,i,s,e)}function Mt(r,i,s,e){Ot(r,i,s,e)}var Qe=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function uo(r,i,s,e,a,u,l){var g=new Uint8Array(16),T=new Uint8Array(64),O,v;for(v=0;v<16;v++)g[v]=0;for(v=0;v<8;v++)g[v]=u[v];for(;a>=64;){for(Ut(T,g,l,Qe),v=0;v<64;v++)r[i+v]=s[e+v]^T[v];for(O=1,v=8;v<16;v++)O=O+(g[v]&255)|0,g[v]=O&255,O>>>=8;a-=64,i+=64,e+=64}if(a>0)for(Ut(T,g,l,Qe),v=0;v<a;v++)r[i+v]=s[e+v]^T[v];return 0}function ho(r,i,s,e,a){var u=new Uint8Array(16),l=new Uint8Array(64),g,T;for(T=0;T<16;T++)u[T]=0;for(T=0;T<8;T++)u[T]=e[T];for(;s>=64;){for(Ut(l,u,a,Qe),T=0;T<64;T++)r[i+T]=l[T];for(g=1,T=8;T<16;T++)g=g+(u[T]&255)|0,u[T]=g&255,g>>>=8;s-=64,i+=64}if(s>0)for(Ut(l,u,a,Qe),T=0;T<s;T++)r[i+T]=l[T];return 0}function lo(r,i,s,e,a){var u=new Uint8Array(32);Mt(u,e,a,Qe);for(var l=new Uint8Array(8),g=0;g<8;g++)l[g]=e[g+16];return ho(r,i,s,l,u)}function pr(r,i,s,e,a,u,l){var g=new Uint8Array(32);Mt(g,u,l,Qe);for(var T=new Uint8Array(8),O=0;O<8;O++)T[O]=u[O+16];return uo(r,i,s,e,a,T,g)}var Lt=function(r){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var i,s,e,a,u,l,g,T;i=r[0]&255|(r[1]&255)<<8,this.r[0]=i&8191,s=r[2]&255|(r[3]&255)<<8,this.r[1]=(i>>>13|s<<3)&8191,e=r[4]&255|(r[5]&255)<<8,this.r[2]=(s>>>10|e<<6)&7939,a=r[6]&255|(r[7]&255)<<8,this.r[3]=(e>>>7|a<<9)&8191,u=r[8]&255|(r[9]&255)<<8,this.r[4]=(a>>>4|u<<12)&255,this.r[5]=u>>>1&8190,l=r[10]&255|(r[11]&255)<<8,this.r[6]=(u>>>14|l<<2)&8191,g=r[12]&255|(r[13]&255)<<8,this.r[7]=(l>>>11|g<<5)&8065,T=r[14]&255|(r[15]&255)<<8,this.r[8]=(g>>>8|T<<8)&8191,this.r[9]=T>>>5&127,this.pad[0]=r[16]&255|(r[17]&255)<<8,this.pad[1]=r[18]&255|(r[19]&255)<<8,this.pad[2]=r[20]&255|(r[21]&255)<<8,this.pad[3]=r[22]&255|(r[23]&255)<<8,this.pad[4]=r[24]&255|(r[25]&255)<<8,this.pad[5]=r[26]&255|(r[27]&255)<<8,this.pad[6]=r[28]&255|(r[29]&255)<<8,this.pad[7]=r[30]&255|(r[31]&255)<<8};Lt.prototype.blocks=function(r,i,s){for(var e=this.fin?0:2048,a,u,l,g,T,O,v,Z,N,k,B,Y,j,H,K,F,C,U,I,R=this.h[0],P=this.h[1],b=this.h[2],p=this.h[3],x=this.h[4],_=this.h[5],E=this.h[6],S=this.h[7],w=this.h[8],L=this.h[9],V=this.r[0],W=this.r[1],G=this.r[2],c=this.r[3],J=this.r[4],ee=this.r[5],te=this.r[6],$=this.r[7],Q=this.r[8],X=this.r[9];s>=16;)a=r[i+0]&255|(r[i+1]&255)<<8,R+=a&8191,u=r[i+2]&255|(r[i+3]&255)<<8,P+=(a>>>13|u<<3)&8191,l=r[i+4]&255|(r[i+5]&255)<<8,b+=(u>>>10|l<<6)&8191,g=r[i+6]&255|(r[i+7]&255)<<8,p+=(l>>>7|g<<9)&8191,T=r[i+8]&255|(r[i+9]&255)<<8,x+=(g>>>4|T<<12)&8191,_+=T>>>1&8191,O=r[i+10]&255|(r[i+11]&255)<<8,E+=(T>>>14|O<<2)&8191,v=r[i+12]&255|(r[i+13]&255)<<8,S+=(O>>>11|v<<5)&8191,Z=r[i+14]&255|(r[i+15]&255)<<8,w+=(v>>>8|Z<<8)&8191,L+=Z>>>5|e,N=0,k=N,k+=R*V,k+=P*(5*X),k+=b*(5*Q),k+=p*(5*$),k+=x*(5*te),N=k>>>13,k&=8191,k+=_*(5*ee),k+=E*(5*J),k+=S*(5*c),k+=w*(5*G),k+=L*(5*W),N+=k>>>13,k&=8191,B=N,B+=R*W,B+=P*V,B+=b*(5*X),B+=p*(5*Q),B+=x*(5*$),N=B>>>13,B&=8191,B+=_*(5*te),B+=E*(5*ee),B+=S*(5*J),B+=w*(5*c),B+=L*(5*G),N+=B>>>13,B&=8191,Y=N,Y+=R*G,Y+=P*W,Y+=b*V,Y+=p*(5*X),Y+=x*(5*Q),N=Y>>>13,Y&=8191,Y+=_*(5*$),Y+=E*(5*te),Y+=S*(5*ee),Y+=w*(5*J),Y+=L*(5*c),N+=Y>>>13,Y&=8191,j=N,j+=R*c,j+=P*G,j+=b*W,j+=p*V,j+=x*(5*X),N=j>>>13,j&=8191,j+=_*(5*Q),j+=E*(5*$),j+=S*(5*te),j+=w*(5*ee),j+=L*(5*J),N+=j>>>13,j&=8191,H=N,H+=R*J,H+=P*c,H+=b*G,H+=p*W,H+=x*V,N=H>>>13,H&=8191,H+=_*(5*X),H+=E*(5*Q),H+=S*(5*$),H+=w*(5*te),H+=L*(5*ee),N+=H>>>13,H&=8191,K=N,K+=R*ee,K+=P*J,K+=b*c,K+=p*G,K+=x*W,N=K>>>13,K&=8191,K+=_*V,K+=E*(5*X),K+=S*(5*Q),K+=w*(5*$),K+=L*(5*te),N+=K>>>13,K&=8191,F=N,F+=R*te,F+=P*ee,F+=b*J,F+=p*c,F+=x*G,N=F>>>13,F&=8191,F+=_*W,F+=E*V,F+=S*(5*X),F+=w*(5*Q),F+=L*(5*$),N+=F>>>13,F&=8191,C=N,C+=R*$,C+=P*te,C+=b*ee,C+=p*J,C+=x*c,N=C>>>13,C&=8191,C+=_*G,C+=E*W,C+=S*V,C+=w*(5*X),C+=L*(5*Q),N+=C>>>13,C&=8191,U=N,U+=R*Q,U+=P*$,U+=b*te,U+=p*ee,U+=x*J,N=U>>>13,U&=8191,U+=_*c,U+=E*G,U+=S*W,U+=w*V,U+=L*(5*X),N+=U>>>13,U&=8191,I=N,I+=R*X,I+=P*Q,I+=b*$,I+=p*te,I+=x*ee,N=I>>>13,I&=8191,I+=_*J,I+=E*c,I+=S*G,I+=w*W,I+=L*V,N+=I>>>13,I&=8191,N=(N<<2)+N|0,N=N+k|0,k=N&8191,N=N>>>13,B+=N,R=k,P=B,b=Y,p=j,x=H,_=K,E=F,S=C,w=U,L=I,i+=16,s-=16;this.h[0]=R,this.h[1]=P,this.h[2]=b,this.h[3]=p,this.h[4]=x,this.h[5]=_,this.h[6]=E,this.h[7]=S,this.h[8]=w,this.h[9]=L},Lt.prototype.finish=function(r,i){var s=new Uint16Array(10),e,a,u,l;if(this.leftover){for(l=this.leftover,this.buffer[l++]=1;l<16;l++)this.buffer[l]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(e=this.h[1]>>>13,this.h[1]&=8191,l=2;l<10;l++)this.h[l]+=e,e=this.h[l]>>>13,this.h[l]&=8191;for(this.h[0]+=e*5,e=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=e,e=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=e,s[0]=this.h[0]+5,e=s[0]>>>13,s[0]&=8191,l=1;l<10;l++)s[l]=this.h[l]+e,e=s[l]>>>13,s[l]&=8191;for(s[9]-=8192,a=(e^1)-1,l=0;l<10;l++)s[l]&=a;for(a=~a,l=0;l<10;l++)this.h[l]=this.h[l]&a|s[l];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,u=this.h[0]+this.pad[0],this.h[0]=u&65535,l=1;l<8;l++)u=(this.h[l]+this.pad[l]|0)+(u>>>16)|0,this.h[l]=u&65535;r[i+0]=this.h[0]>>>0&255,r[i+1]=this.h[0]>>>8&255,r[i+2]=this.h[1]>>>0&255,r[i+3]=this.h[1]>>>8&255,r[i+4]=this.h[2]>>>0&255,r[i+5]=this.h[2]>>>8&255,r[i+6]=this.h[3]>>>0&255,r[i+7]=this.h[3]>>>8&255,r[i+8]=this.h[4]>>>0&255,r[i+9]=this.h[4]>>>8&255,r[i+10]=this.h[5]>>>0&255,r[i+11]=this.h[5]>>>8&255,r[i+12]=this.h[6]>>>0&255,r[i+13]=this.h[6]>>>8&255,r[i+14]=this.h[7]>>>0&255,r[i+15]=this.h[7]>>>8&255},Lt.prototype.update=function(r,i,s){var e,a;if(this.leftover){for(a=16-this.leftover,a>s&&(a=s),e=0;e<a;e++)this.buffer[this.leftover+e]=r[i+e];if(s-=a,i+=a,this.leftover+=a,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(s>=16&&(a=s-s%16,this.blocks(r,i,a),i+=a,s-=a),s){for(e=0;e<s;e++)this.buffer[this.leftover+e]=r[i+e];this.leftover+=s}};function mr(r,i,s,e,a,u){var l=new Lt(u);return l.update(s,e,a),l.finish(r,i),0}function po(r,i,s,e,a,u){var l=new Uint8Array(16);return mr(l,0,s,e,a,u),Ee(r,i,l,0)}function xr(r,i,s,e,a){var u;if(s<32)return-1;for(pr(r,0,i,0,s,e,a),mr(r,16,r,32,s-32,r),u=0;u<16;u++)r[u]=0;return 0}function Er(r,i,s,e,a){var u,l=new Uint8Array(32);if(s<32||(lo(l,0,32,e,a),po(i,16,i,32,s-32,l)!==0))return-1;for(pr(r,0,i,0,s,e,a),u=0;u<32;u++)r[u]=0;return 0}function He(r,i){var s;for(s=0;s<16;s++)r[s]=i[s]|0}function gr(r){var i,s,e=1;for(i=0;i<16;i++)s=r[i]+e+65535,e=Math.floor(s/65536),r[i]=s-e*65536;r[0]+=e-1+37*(e-1)}function st(r,i,s){for(var e,a=~(s-1),u=0;u<16;u++)e=a&(r[u]^i[u]),r[u]^=e,i[u]^=e}function it(r,i){var s,e,a,u=t(),l=t();for(s=0;s<16;s++)l[s]=i[s];for(gr(l),gr(l),gr(l),e=0;e<2;e++){for(u[0]=l[0]-65517,s=1;s<15;s++)u[s]=l[s]-65535-(u[s-1]>>16&1),u[s-1]&=65535;u[15]=l[15]-32767-(u[14]>>16&1),a=u[15]>>16&1,u[14]&=65535,st(l,u,1-a)}for(s=0;s<16;s++)r[2*s]=l[s]&255,r[2*s+1]=l[s]>>8}function mo(r,i){var s=new Uint8Array(32),e=new Uint8Array(32);return it(s,r),it(e,i),Le(s,0,e,0)}function xo(r){var i=new Uint8Array(32);return it(i,r),i[0]&1}function Sr(r,i){var s;for(s=0;s<16;s++)r[s]=i[2*s]+(i[2*s+1]<<8);r[15]&=32767}function Pe(r,i,s){for(var e=0;e<16;e++)r[e]=i[e]+s[e]}function Oe(r,i,s){for(var e=0;e<16;e++)r[e]=i[e]-s[e]}function q(r,i,s){var e,a,u=0,l=0,g=0,T=0,O=0,v=0,Z=0,N=0,k=0,B=0,Y=0,j=0,H=0,K=0,F=0,C=0,U=0,I=0,R=0,P=0,b=0,p=0,x=0,_=0,E=0,S=0,w=0,L=0,V=0,W=0,G=0,c=s[0],J=s[1],ee=s[2],te=s[3],$=s[4],Q=s[5],X=s[6],he=s[7],re=s[8],ce=s[9],de=s[10],ue=s[11],le=s[12],ge=s[13],Se=s[14],_e=s[15];e=i[0],u+=e*c,l+=e*J,g+=e*ee,T+=e*te,O+=e*$,v+=e*Q,Z+=e*X,N+=e*he,k+=e*re,B+=e*ce,Y+=e*de,j+=e*ue,H+=e*le,K+=e*ge,F+=e*Se,C+=e*_e,e=i[1],l+=e*c,g+=e*J,T+=e*ee,O+=e*te,v+=e*$,Z+=e*Q,N+=e*X,k+=e*he,B+=e*re,Y+=e*ce,j+=e*de,H+=e*ue,K+=e*le,F+=e*ge,C+=e*Se,U+=e*_e,e=i[2],g+=e*c,T+=e*J,O+=e*ee,v+=e*te,Z+=e*$,N+=e*Q,k+=e*X,B+=e*he,Y+=e*re,j+=e*ce,H+=e*de,K+=e*ue,F+=e*le,C+=e*ge,U+=e*Se,I+=e*_e,e=i[3],T+=e*c,O+=e*J,v+=e*ee,Z+=e*te,N+=e*$,k+=e*Q,B+=e*X,Y+=e*he,j+=e*re,H+=e*ce,K+=e*de,F+=e*ue,C+=e*le,U+=e*ge,I+=e*Se,R+=e*_e,e=i[4],O+=e*c,v+=e*J,Z+=e*ee,N+=e*te,k+=e*$,B+=e*Q,Y+=e*X,j+=e*he,H+=e*re,K+=e*ce,F+=e*de,C+=e*ue,U+=e*le,I+=e*ge,R+=e*Se,P+=e*_e,e=i[5],v+=e*c,Z+=e*J,N+=e*ee,k+=e*te,B+=e*$,Y+=e*Q,j+=e*X,H+=e*he,K+=e*re,F+=e*ce,C+=e*de,U+=e*ue,I+=e*le,R+=e*ge,P+=e*Se,b+=e*_e,e=i[6],Z+=e*c,N+=e*J,k+=e*ee,B+=e*te,Y+=e*$,j+=e*Q,H+=e*X,K+=e*he,F+=e*re,C+=e*ce,U+=e*de,I+=e*ue,R+=e*le,P+=e*ge,b+=e*Se,p+=e*_e,e=i[7],N+=e*c,k+=e*J,B+=e*ee,Y+=e*te,j+=e*$,H+=e*Q,K+=e*X,F+=e*he,C+=e*re,U+=e*ce,I+=e*de,R+=e*ue,P+=e*le,b+=e*ge,p+=e*Se,x+=e*_e,e=i[8],k+=e*c,B+=e*J,Y+=e*ee,j+=e*te,H+=e*$,K+=e*Q,F+=e*X,C+=e*he,U+=e*re,I+=e*ce,R+=e*de,P+=e*ue,b+=e*le,p+=e*ge,x+=e*Se,_+=e*_e,e=i[9],B+=e*c,Y+=e*J,j+=e*ee,H+=e*te,K+=e*$,F+=e*Q,C+=e*X,U+=e*he,I+=e*re,R+=e*ce,P+=e*de,b+=e*ue,p+=e*le,x+=e*ge,_+=e*Se,E+=e*_e,e=i[10],Y+=e*c,j+=e*J,H+=e*ee,K+=e*te,F+=e*$,C+=e*Q,U+=e*X,I+=e*he,R+=e*re,P+=e*ce,b+=e*de,p+=e*ue,x+=e*le,_+=e*ge,E+=e*Se,S+=e*_e,e=i[11],j+=e*c,H+=e*J,K+=e*ee,F+=e*te,C+=e*$,U+=e*Q,I+=e*X,R+=e*he,P+=e*re,b+=e*ce,p+=e*de,x+=e*ue,_+=e*le,E+=e*ge,S+=e*Se,w+=e*_e,e=i[12],H+=e*c,K+=e*J,F+=e*ee,C+=e*te,U+=e*$,I+=e*Q,R+=e*X,P+=e*he,b+=e*re,p+=e*ce,x+=e*de,_+=e*ue,E+=e*le,S+=e*ge,w+=e*Se,L+=e*_e,e=i[13],K+=e*c,F+=e*J,C+=e*ee,U+=e*te,I+=e*$,R+=e*Q,P+=e*X,b+=e*he,p+=e*re,x+=e*ce,_+=e*de,E+=e*ue,S+=e*le,w+=e*ge,L+=e*Se,V+=e*_e,e=i[14],F+=e*c,C+=e*J,U+=e*ee,I+=e*te,R+=e*$,P+=e*Q,b+=e*X,p+=e*he,x+=e*re,_+=e*ce,E+=e*de,S+=e*ue,w+=e*le,L+=e*ge,V+=e*Se,W+=e*_e,e=i[15],C+=e*c,U+=e*J,I+=e*ee,R+=e*te,P+=e*$,b+=e*Q,p+=e*X,x+=e*he,_+=e*re,E+=e*ce,S+=e*de,w+=e*ue,L+=e*le,V+=e*ge,W+=e*Se,G+=e*_e,u+=38*U,l+=38*I,g+=38*R,T+=38*P,O+=38*b,v+=38*p,Z+=38*x,N+=38*_,k+=38*E,B+=38*S,Y+=38*w,j+=38*L,H+=38*V,K+=38*W,F+=38*G,a=1,e=u+a+65535,a=Math.floor(e/65536),u=e-a*65536,e=l+a+65535,a=Math.floor(e/65536),l=e-a*65536,e=g+a+65535,a=Math.floor(e/65536),g=e-a*65536,e=T+a+65535,a=Math.floor(e/65536),T=e-a*65536,e=O+a+65535,a=Math.floor(e/65536),O=e-a*65536,e=v+a+65535,a=Math.floor(e/65536),v=e-a*65536,e=Z+a+65535,a=Math.floor(e/65536),Z=e-a*65536,e=N+a+65535,a=Math.floor(e/65536),N=e-a*65536,e=k+a+65535,a=Math.floor(e/65536),k=e-a*65536,e=B+a+65535,a=Math.floor(e/65536),B=e-a*65536,e=Y+a+65535,a=Math.floor(e/65536),Y=e-a*65536,e=j+a+65535,a=Math.floor(e/65536),j=e-a*65536,e=H+a+65535,a=Math.floor(e/65536),H=e-a*65536,e=K+a+65535,a=Math.floor(e/65536),K=e-a*65536,e=F+a+65535,a=Math.floor(e/65536),F=e-a*65536,e=C+a+65535,a=Math.floor(e/65536),C=e-a*65536,u+=a-1+37*(a-1),a=1,e=u+a+65535,a=Math.floor(e/65536),u=e-a*65536,e=l+a+65535,a=Math.floor(e/65536),l=e-a*65536,e=g+a+65535,a=Math.floor(e/65536),g=e-a*65536,e=T+a+65535,a=Math.floor(e/65536),T=e-a*65536,e=O+a+65535,a=Math.floor(e/65536),O=e-a*65536,e=v+a+65535,a=Math.floor(e/65536),v=e-a*65536,e=Z+a+65535,a=Math.floor(e/65536),Z=e-a*65536,e=N+a+65535,a=Math.floor(e/65536),N=e-a*65536,e=k+a+65535,a=Math.floor(e/65536),k=e-a*65536,e=B+a+65535,a=Math.floor(e/65536),B=e-a*65536,e=Y+a+65535,a=Math.floor(e/65536),Y=e-a*65536,e=j+a+65535,a=Math.floor(e/65536),j=e-a*65536,e=H+a+65535,a=Math.floor(e/65536),H=e-a*65536,e=K+a+65535,a=Math.floor(e/65536),K=e-a*65536,e=F+a+65535,a=Math.floor(e/65536),F=e-a*65536,e=C+a+65535,a=Math.floor(e/65536),C=e-a*65536,u+=a-1+37*(a-1),r[0]=u,r[1]=l,r[2]=g,r[3]=T,r[4]=O,r[5]=v,r[6]=Z,r[7]=N,r[8]=k,r[9]=B,r[10]=Y,r[11]=j,r[12]=H,r[13]=K,r[14]=F,r[15]=C}function Ce(r,i){q(r,i,i)}function Eo(r,i){var s=t(),e;for(e=0;e<16;e++)s[e]=i[e];for(e=253;e>=0;e--)Ce(s,s),e!==2&&e!==4&&q(s,s,i);for(e=0;e<16;e++)r[e]=s[e]}function go(r,i){var s=t(),e;for(e=0;e<16;e++)s[e]=i[e];for(e=250;e>=0;e--)Ce(s,s),e!==1&&q(s,s,i);for(e=0;e<16;e++)r[e]=s[e]}function Dt(r,i,s){var e=new Uint8Array(32),a=new Float64Array(80),u,l,g=t(),T=t(),O=t(),v=t(),Z=t(),N=t();for(l=0;l<31;l++)e[l]=i[l];for(e[31]=i[31]&127|64,e[0]&=248,Sr(a,s),l=0;l<16;l++)T[l]=a[l],v[l]=g[l]=O[l]=0;for(g[0]=v[0]=1,l=254;l>=0;--l)u=e[l>>>3]>>>(l&7)&1,st(g,T,u),st(O,v,u),Pe(Z,g,O),Oe(g,g,O),Pe(O,T,v),Oe(T,T,v),Ce(v,Z),Ce(N,g),q(g,O,g),q(O,T,Z),Pe(Z,g,O),Oe(g,g,O),Ce(T,g),Oe(O,v,N),q(g,O,A),Pe(g,g,v),q(O,O,g),q(g,v,N),q(v,T,a),Ce(T,Z),st(g,T,u),st(O,v,u);for(l=0;l<16;l++)a[l+16]=g[l],a[l+32]=O[l],a[l+48]=T[l],a[l+64]=v[l];var k=a.subarray(32),B=a.subarray(16);return Eo(k,k),q(B,B,k),it(r,B),0}function kt(r,i){return Dt(r,i,d)}function So(r,i){return n(i,32),kt(r,i)}function Bt(r,i,s){var e=new Uint8Array(32);return Dt(e,s,i),Mt(r,f,e,Qe)}var _o=xr,On=Er;function Un(r,i,s,e,a,u){var l=new Uint8Array(32);return Bt(l,a,u),_o(r,i,s,e,l)}function Mn(r,i,s,e,a,u){var l=new Uint8Array(32);return Bt(l,a,u),On(r,i,s,e,l)}var wo=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function To(r,i,s,e){for(var a=new Int32Array(16),u=new Int32Array(16),l,g,T,O,v,Z,N,k,B,Y,j,H,K,F,C,U,I,R,P,b,p,x,_,E,S,w,L=r[0],V=r[1],W=r[2],G=r[3],c=r[4],J=r[5],ee=r[6],te=r[7],$=i[0],Q=i[1],X=i[2],he=i[3],re=i[4],ce=i[5],de=i[6],ue=i[7],le=0;e>=128;){for(P=0;P<16;P++)b=8*P+le,a[P]=s[b+0]<<24|s[b+1]<<16|s[b+2]<<8|s[b+3],u[P]=s[b+4]<<24|s[b+5]<<16|s[b+6]<<8|s[b+7];for(P=0;P<80;P++)if(l=L,g=V,T=W,O=G,v=c,Z=J,N=ee,k=te,B=$,Y=Q,j=X,H=he,K=re,F=ce,C=de,U=ue,p=te,x=ue,_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=(c>>>14|re<<18)^(c>>>18|re<<14)^(re>>>9|c<<23),x=(re>>>14|c<<18)^(re>>>18|c<<14)^(c>>>9|re<<23),_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,p=c&J^~c&ee,x=re&ce^~re&de,_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,p=wo[P*2],x=wo[P*2+1],_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,p=a[P%16],x=u[P%16],_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,I=S&65535|w<<16,R=_&65535|E<<16,p=I,x=R,_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=(L>>>28|$<<4)^($>>>2|L<<30)^($>>>7|L<<25),x=($>>>28|L<<4)^(L>>>2|$<<30)^(L>>>7|$<<25),_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,p=L&V^L&W^V&W,x=$&Q^$&X^Q&X,_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,k=S&65535|w<<16,U=_&65535|E<<16,p=O,x=H,_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=I,x=R,_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,O=S&65535|w<<16,H=_&65535|E<<16,V=l,W=g,G=T,c=O,J=v,ee=Z,te=N,L=k,Q=B,X=Y,he=j,re=H,ce=K,de=F,ue=C,$=U,P%16===15)for(b=0;b<16;b++)p=a[b],x=u[b],_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=a[(b+9)%16],x=u[(b+9)%16],_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,I=a[(b+1)%16],R=u[(b+1)%16],p=(I>>>1|R<<31)^(I>>>8|R<<24)^I>>>7,x=(R>>>1|I<<31)^(R>>>8|I<<24)^(R>>>7|I<<25),_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,I=a[(b+14)%16],R=u[(b+14)%16],p=(I>>>19|R<<13)^(R>>>29|I<<3)^I>>>6,x=(R>>>19|I<<13)^(I>>>29|R<<3)^(R>>>6|I<<26),_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,a[b]=S&65535|w<<16,u[b]=_&65535|E<<16;p=L,x=$,_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=r[0],x=i[0],_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,r[0]=L=S&65535|w<<16,i[0]=$=_&65535|E<<16,p=V,x=Q,_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=r[1],x=i[1],_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,r[1]=V=S&65535|w<<16,i[1]=Q=_&65535|E<<16,p=W,x=X,_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=r[2],x=i[2],_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,r[2]=W=S&65535|w<<16,i[2]=X=_&65535|E<<16,p=G,x=he,_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=r[3],x=i[3],_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,r[3]=G=S&65535|w<<16,i[3]=he=_&65535|E<<16,p=c,x=re,_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=r[4],x=i[4],_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,r[4]=c=S&65535|w<<16,i[4]=re=_&65535|E<<16,p=J,x=ce,_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=r[5],x=i[5],_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,r[5]=J=S&65535|w<<16,i[5]=ce=_&65535|E<<16,p=ee,x=de,_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=r[6],x=i[6],_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,r[6]=ee=S&65535|w<<16,i[6]=de=_&65535|E<<16,p=te,x=ue,_=x&65535,E=x>>>16,S=p&65535,w=p>>>16,p=r[7],x=i[7],_+=x&65535,E+=x>>>16,S+=p&65535,w+=p>>>16,E+=_>>>16,S+=E>>>16,w+=S>>>16,r[7]=te=S&65535|w<<16,i[7]=ue=_&65535|E<<16,le+=128,e-=128}return e}function Xe(r,i,s){var e=new Int32Array(8),a=new Int32Array(8),u=new Uint8Array(256),l,g=s;for(e[0]=1779033703,e[1]=3144134277,e[2]=1013904242,e[3]=2773480762,e[4]=1359893119,e[5]=2600822924,e[6]=528734635,e[7]=1541459225,a[0]=4089235720,a[1]=2227873595,a[2]=4271175723,a[3]=1595750129,a[4]=2917565137,a[5]=725511199,a[6]=4215389547,a[7]=327033209,To(e,a,i,s),s%=128,l=0;l<s;l++)u[l]=i[g-s+l];for(u[s]=128,s=256-128*(s<112?1:0),u[s-9]=0,Ae(u,s-8,g/536870912|0,g<<3),To(e,a,u,s),l=0;l<8;l++)Ae(r,8*l,e[l],a[l]);return 0}function Ht(r,i){var s=t(),e=t(),a=t(),u=t(),l=t(),g=t(),T=t(),O=t(),v=t();Oe(s,r[1],r[0]),Oe(v,i[1],i[0]),q(s,s,v),Pe(e,r[0],r[1]),Pe(v,i[0],i[1]),q(e,e,v),q(a,r[3],i[3]),q(a,a,z),q(u,r[2],i[2]),Pe(u,u,u),Oe(l,e,s),Oe(g,u,a),Pe(T,u,a),Pe(O,e,s),q(r[0],l,g),q(r[1],O,T),q(r[2],T,g),q(r[3],l,O)}function Ao(r,i,s){var e;for(e=0;e<4;e++)st(r[e],i[e],s)}function Ft(r,i){var s=t(),e=t(),a=t();Eo(a,i[2]),q(s,i[0],a),q(e,i[1],a),it(r,e),r[31]^=xo(s)<<7}function _r(r,i,s){var e,a;for(He(r[0],h),He(r[1],m),He(r[2],m),He(r[3],h),a=255;a>=0;--a)e=s[a/8|0]>>(a&7)&1,Ao(r,i,e),Ht(i,r),Ht(r,r),Ao(r,i,e)}function Kt(r,i){var s=[t(),t(),t(),t()];He(s[0],fe),He(s[1],ie),He(s[2],m),q(s[3],fe,ie),_r(r,s,i)}function wr(r,i,s){var e=new Uint8Array(64),a=[t(),t(),t(),t()],u;for(s||n(i,32),Xe(e,i,32),e[0]&=248,e[31]&=127,e[31]|=64,Kt(a,e),Ft(r,a),u=0;u<32;u++)i[u+32]=r[u];return 0}var jt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Tr(r,i){var s,e,a,u;for(e=63;e>=32;--e){for(s=0,a=e-32,u=e-12;a<u;++a)i[a]+=s-16*i[e]*jt[a-(e-32)],s=Math.floor((i[a]+128)/256),i[a]-=s*256;i[a]+=s,i[e]=0}for(s=0,a=0;a<32;a++)i[a]+=s-(i[31]>>4)*jt[a],s=i[a]>>8,i[a]&=255;for(a=0;a<32;a++)i[a]-=s*jt[a];for(e=0;e<32;e++)i[e+1]+=i[e]>>8,r[e]=i[e]&255}function Ar(r){var i=new Float64Array(64),s;for(s=0;s<64;s++)i[s]=r[s];for(s=0;s<64;s++)r[s]=0;Tr(r,i)}function yo(r,i,s,e){var a=new Uint8Array(64),u=new Uint8Array(64),l=new Uint8Array(64),g,T,O=new Float64Array(64),v=[t(),t(),t(),t()];Xe(a,e,32),a[0]&=248,a[31]&=127,a[31]|=64;var Z=s+64;for(g=0;g<s;g++)r[64+g]=i[g];for(g=0;g<32;g++)r[32+g]=a[32+g];for(Xe(l,r.subarray(32),s+32),Ar(l),Kt(v,l),Ft(r,v),g=32;g<64;g++)r[g]=e[g];for(Xe(u,r,s+64),Ar(u),g=0;g<64;g++)O[g]=0;for(g=0;g<32;g++)O[g]=l[g];for(g=0;g<32;g++)for(T=0;T<32;T++)O[g+T]+=u[g]*a[T];return Tr(r.subarray(32),O),Z}function Ln(r,i){var s=t(),e=t(),a=t(),u=t(),l=t(),g=t(),T=t();return He(r[2],m),Sr(r[1],i),Ce(a,r[1]),q(u,a,D),Oe(a,a,r[2]),Pe(u,r[2],u),Ce(l,u),Ce(g,l),q(T,g,l),q(s,T,a),q(s,s,u),go(s,s),q(s,s,a),q(s,s,u),q(s,s,u),q(r[0],s,u),Ce(e,r[0]),q(e,e,u),mo(e,a)&&q(r[0],r[0],xe),Ce(e,r[0]),q(e,e,u),mo(e,a)?-1:(xo(r[0])===i[31]>>7&&Oe(r[0],h,r[0]),q(r[3],r[0],r[1]),0)}function yr(r,i,s,e){var a,u=new Uint8Array(32),l=new Uint8Array(64),g=[t(),t(),t(),t()],T=[t(),t(),t(),t()];if(s<64||Ln(T,e))return-1;for(a=0;a<s;a++)r[a]=i[a];for(a=0;a<32;a++)r[a+32]=e[a];if(Xe(l,r,s),Ar(l),_r(g,T,l),Kt(T,i.subarray(32)),Ht(g,T),Ft(u,g),s-=64,Le(i,0,u,0)){for(a=0;a<s;a++)r[a]=0;return-1}for(a=0;a<s;a++)r[a]=i[a+64];return s}var br=32,Yt=24,pt=32,at=16,mt=32,Vt=32,xt=32,Et=32,vr=32,bo=Yt,Dn=pt,kn=at,Fe=64,Ze=32,ft=64,Ir=32,Nr=64;o.lowlevel={crypto_core_hsalsa20:Mt,crypto_stream_xor:pr,crypto_stream:lo,crypto_stream_salsa20_xor:uo,crypto_stream_salsa20:ho,crypto_onetimeauth:mr,crypto_onetimeauth_verify:po,crypto_verify_16:Ee,crypto_verify_32:Le,crypto_secretbox:xr,crypto_secretbox_open:Er,crypto_scalarmult:Dt,crypto_scalarmult_base:kt,crypto_box_beforenm:Bt,crypto_box_afternm:_o,crypto_box:Un,crypto_box_open:Mn,crypto_box_keypair:So,crypto_hash:Xe,crypto_sign:yo,crypto_sign_keypair:wr,crypto_sign_open:yr,crypto_secretbox_KEYBYTES:br,crypto_secretbox_NONCEBYTES:Yt,crypto_secretbox_ZEROBYTES:pt,crypto_secretbox_BOXZEROBYTES:at,crypto_scalarmult_BYTES:mt,crypto_scalarmult_SCALARBYTES:Vt,crypto_box_PUBLICKEYBYTES:xt,crypto_box_SECRETKEYBYTES:Et,crypto_box_BEFORENMBYTES:vr,crypto_box_NONCEBYTES:bo,crypto_box_ZEROBYTES:Dn,crypto_box_BOXZEROBYTES:kn,crypto_sign_BYTES:Fe,crypto_sign_PUBLICKEYBYTES:Ze,crypto_sign_SECRETKEYBYTES:ft,crypto_sign_SEEDBYTES:Ir,crypto_hash_BYTES:Nr,gf:t,D,L:jt,pack:Ft,pack25519:it,unpack25519:Sr,M:q,A:Pe,S:Ce,Z:Oe,pow2523:go,add:Ht,set25519:He,modL:Tr,scalarmult:_r,scalarbase:Kt};function vo(r,i){if(r.length!==br)throw new Error("bad key size");if(i.length!==Yt)throw new Error("bad nonce size")}function Bn(r,i){if(r.length!==xt)throw new Error("bad public key size");if(i.length!==Et)throw new Error("bad secret key size")}function be(){for(var r=0;r<arguments.length;r++)if(!(arguments[r]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Io(r){for(var i=0;i<r.length;i++)r[i]=0}o.randomBytes=function(r){var i=new Uint8Array(r);return n(i,r),i},o.secretbox=function(r,i,s){be(r,i,s),vo(s,i);for(var e=new Uint8Array(pt+r.length),a=new Uint8Array(e.length),u=0;u<r.length;u++)e[u+pt]=r[u];return xr(a,e,e.length,i,s),a.subarray(at)},o.secretbox.open=function(r,i,s){be(r,i,s),vo(s,i);for(var e=new Uint8Array(at+r.length),a=new Uint8Array(e.length),u=0;u<r.length;u++)e[u+at]=r[u];return e.length<32||Er(a,e,e.length,i,s)!==0?null:a.subarray(pt)},o.secretbox.keyLength=br,o.secretbox.nonceLength=Yt,o.secretbox.overheadLength=at,o.scalarMult=function(r,i){if(be(r,i),r.length!==Vt)throw new Error("bad n size");if(i.length!==mt)throw new Error("bad p size");var s=new Uint8Array(mt);return Dt(s,r,i),s},o.scalarMult.base=function(r){if(be(r),r.length!==Vt)throw new Error("bad n size");var i=new Uint8Array(mt);return kt(i,r),i},o.scalarMult.scalarLength=Vt,o.scalarMult.groupElementLength=mt,o.box=function(r,i,s,e){var a=o.box.before(s,e);return o.secretbox(r,i,a)},o.box.before=function(r,i){be(r,i),Bn(r,i);var s=new Uint8Array(vr);return Bt(s,r,i),s},o.box.after=o.secretbox,o.box.open=function(r,i,s,e){var a=o.box.before(s,e);return o.secretbox.open(r,i,a)},o.box.open.after=o.secretbox.open,o.box.keyPair=function(){var r=new Uint8Array(xt),i=new Uint8Array(Et);return So(r,i),{publicKey:r,secretKey:i}},o.box.keyPair.fromSecretKey=function(r){if(be(r),r.length!==Et)throw new Error("bad secret key size");var i=new Uint8Array(xt);return kt(i,r),{publicKey:i,secretKey:new Uint8Array(r)}},o.box.publicKeyLength=xt,o.box.secretKeyLength=Et,o.box.sharedKeyLength=vr,o.box.nonceLength=bo,o.box.overheadLength=o.secretbox.overheadLength,o.sign=function(r,i){if(be(r,i),i.length!==ft)throw new Error("bad secret key size");var s=new Uint8Array(Fe+r.length);return yo(s,r,r.length,i),s},o.sign.open=function(r,i){if(be(r,i),i.length!==Ze)throw new Error("bad public key size");var s=new Uint8Array(r.length),e=yr(s,r,r.length,i);if(e<0)return null;for(var a=new Uint8Array(e),u=0;u<a.length;u++)a[u]=s[u];return a},o.sign.detached=function(r,i){for(var s=o.sign(r,i),e=new Uint8Array(Fe),a=0;a<e.length;a++)e[a]=s[a];return e},o.sign.detached.verify=function(r,i,s){if(be(r,i,s),i.length!==Fe)throw new Error("bad signature size");if(s.length!==Ze)throw new Error("bad public key size");var e=new Uint8Array(Fe+r.length),a=new Uint8Array(Fe+r.length),u;for(u=0;u<Fe;u++)e[u]=i[u];for(u=0;u<r.length;u++)e[u+Fe]=r[u];return yr(a,e,e.length,s)>=0},o.sign.keyPair=function(){var r=new Uint8Array(Ze),i=new Uint8Array(ft);return wr(r,i),{publicKey:r,secretKey:i}},o.sign.keyPair.fromSecretKey=function(r){if(be(r),r.length!==ft)throw new Error("bad secret key size");for(var i=new Uint8Array(Ze),s=0;s<i.length;s++)i[s]=r[32+s];return{publicKey:i,secretKey:new Uint8Array(r)}},o.sign.keyPair.fromSeed=function(r){if(be(r),r.length!==Ir)throw new Error("bad seed size");for(var i=new Uint8Array(Ze),s=new Uint8Array(ft),e=0;e<32;e++)s[e]=r[e];return wr(i,s,!0),{publicKey:i,secretKey:s}},o.sign.publicKeyLength=Ze,o.sign.secretKeyLength=ft,o.sign.seedLength=Ir,o.sign.signatureLength=Fe,o.hash=function(r){be(r);var i=new Uint8Array(Nr);return Xe(i,r,r.length),i},o.hash.hashLength=Nr,o.verify=function(r,i){return be(r,i),r.length===0||i.length===0||r.length!==i.length?!1:we(r,0,i,0,r.length)===0},o.setPRNG=function(r){n=r},(function(){var r=typeof self<"u"?self.crypto||self.msCrypto:null;if(r&&r.getRandomValues){var i=65536;o.setPRNG(function(s,e){var a,u=new Uint8Array(e);for(a=0;a<e;a+=i)r.getRandomValues(u.subarray(a,a+Math.min(e-a,i)));for(a=0;a<e;a++)s[a]=u[a];Io(u)})}else typeof No<"u"&&(r=Fn(),r&&r.randomBytes&&o.setPRNG(function(s,e){var a,u=r.randomBytes(e);for(a=0;a<e;a++)s[a]=u[a];Io(u)}))})()})(typeof $t<"u"&&$t.exports?$t.exports:self.nacl=self.nacl||{})});var Yo=Te(jo()),et=Yo.default.lowlevel;function Yn(o){let t;typeof o=="string"?t=Buffer.from(o,"hex"):t=o;let n=new Uint8Array(64),f=[et.gf(),et.gf(),et.gf(),et.gf()],d=new Uint8Array([...new Uint8Array(t),...new Uint8Array(32)]),h=new Uint8Array(32);et.crypto_hash(n,d,32),n[0]&=248,n[31]&=127,n[31]|=64,et.scalarbase(f,n),et.pack(h,f);for(let m=0;m<32;m+=1)d[m+32]=h[m];return{sk:Buffer.from(d),pk:Buffer.from(h)}}var Vo=Te(Gt()),ve=Vo.default.getLogger("auth");ve.setLevel("error");var oe={MAINNET:"mainnet",TESTNET:"testnet",CYAN:"cyan",AQUA:"aqua",CELESTE:"celeste"},ke={SAPPHIRE_DEVNET:"sapphire_devnet",SAPPHIRE_MAINNET:"sapphire_mainnet"},Vn={[oe.MAINNET]:"0xf20336e16B5182637f09821c27BDe29b0AFcfe80",[oe.TESTNET]:"0xd084604e5FA387FbC2Da8bAab07fDD6aDED4614A",[oe.CYAN]:"0x9f072ba19b3370e512aa1b4bfcdaf97283168005",[oe.AQUA]:"0x29Dea82a0509153b91040ee13cDBba0f03efb625",[oe.CELESTE]:"0x6Bffb4e89453069E7487f0fa5c9f4a2D771cce6c"};var Gn={[oe.AQUA]:{migrationCompleted:!0,networkIdentifier:"aqua",networkMigratedTo:ke.SAPPHIRE_MAINNET},[oe.CELESTE]:{migrationCompleted:!0,networkIdentifier:"celeste",networkMigratedTo:ke.SAPPHIRE_MAINNET},[oe.CYAN]:{migrationCompleted:!0,networkIdentifier:"cyan",networkMigratedTo:ke.SAPPHIRE_MAINNET},[oe.MAINNET]:{migrationCompleted:!0,networkIdentifier:"mainnet",networkMigratedTo:ke.SAPPHIRE_MAINNET},[oe.TESTNET]:{migrationCompleted:!0,networkIdentifier:"teal",networkMigratedTo:ke.SAPPHIRE_DEVNET}},Wn={[oe.MAINNET]:"mainnet",[oe.TESTNET]:"goerli",[oe.CYAN]:"polygon-mainnet",[oe.AQUA]:"polygon-mainnet",[oe.CELESTE]:"polygon-mainnet"},$n={[ke.SAPPHIRE_MAINNET]:"https://api.web3auth.io/signer-service",[ke.SAPPHIRE_DEVNET]:"https://api.web3auth.io/signer-service",[oe.MAINNET]:"https://api.web3auth.io/signer-service",[oe.TESTNET]:"https://api.web3auth.io/signer-service",[oe.CYAN]:"https://api.web3auth.io/signer-polygon-service",[oe.AQUA]:"https://api.web3auth.io/signer-polygon-service",[oe.CELESTE]:"https://api.web3auth.io/signer-polygon-service"},Jn={[oe.MAINNET]:"https://api.web3auth.io/metadata-service",[oe.TESTNET]:"https://api.web3auth.io/metadata-service",[oe.CYAN]:"https://api.web3auth.io/metadata-service",[oe.AQUA]:"https://api.web3auth.io/metadata-service",[oe.CELESTE]:"https://api.web3auth.io/metadata-service"};var gt="https://api.web3auth.io/session-service",St="https://session.web3auth.io";var wt=Te(Kn()),Jt=Te(Gt()),_t=Jt.default.getLogger("http-helpers");_t.setLevel(Jt.levels.INFO);var Go="torus-default",Wo="",zn="x-api-key",qn="x-embed-host",$o=null,Qn=[],Xn=[];function Jo(o){_t.setLevel(o)}async function zt(o,t){let n=null;try{n=new URL(o)}catch{}return $o&&n&&(Qn.includes(n.origin)||Xn.includes(n.pathname))?await $o.startSpan({name:o,op:"http.client"},async()=>await fetch(o,t)):fetch(o,t)}function qt(){let o={};return Go&&(o[zn]=Go),Wo&&(o[qn]=Wo),o}function Qt(o){_t.info(`Response: ${o.status} ${o.statusText}`),_t.info(`Url: ${o.url}`)}function Zn(o){let t=o.headers.get("x-web3-correlation-id");t&&_t.info(`Request tracing with traceID = ${t}`)}var es=async(o,t)=>{let n=null;try{let f=new Promise((h,m)=>{n=setTimeout(()=>{m(new Error(`Timed out in ${o}ms`))},o)}),d=await Promise.race([t,f]);return n!=null&&clearTimeout(n),d}catch(f){throw n!=null&&clearTimeout(n),f}},zo=async(o,t={},n={})=>{let f={mode:"cors",headers:{}};n.useAPIKey&&(f.headers=M(M({},f.headers),qt())),t.method="GET";let d=(0,wt.default)(f,t),h=await zt(o,d);if(h.ok){let m=h.headers.get("content-type");return m!=null&&m.includes("application/json")?h.json():h.text()}throw Qt(h),h},tt=(o,t={},n={},f={})=>{let d={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};f.useAPIKey&&(d.headers=M(M({},d.headers),qt())),n.method="POST";let h=(0,wt.default)(d,n);return f.isUrlEncodedData?(h.body=t,h.headers["Content-Type"]==="application/json; charset=utf-8"&&delete h.headers["Content-Type"]):h.body=JSON.stringify(t),es(f.timeout||6e4,zt(o,h).then(m=>{if(f.logTracingHeader&&Zn(m),m.ok){let A=m.headers.get("content-type");return A!=null&&A.includes("application/json")?m.json():m.text()}throw Qt(m),m}))},qo=async(o,t={},n={},f={})=>{let d={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};f.useAPIKey&&(d.headers=M(M({},d.headers),qt())),n.method="PATCH";let h=(0,wt.default)(d,n);f.isUrlEncodedData?(h.body=t,h.headers["Content-Type"]==="application/json; charset=utf-8"&&delete h.headers["Content-Type"]):h.body=JSON.stringify(t);let m=await zt(o,h);if(m.ok){let A=m.headers.get("content-type");return A!=null&&A.includes("application/json")?m.json():m.text()}throw Qt(m),m},Qo=async(o,t={},n={},f={})=>{let d={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};f.useAPIKey&&(d.headers=M(M({},d.headers),qt())),n.method="PUT";let h=(0,wt.default)(d,n);f.isUrlEncodedData?(h.body=t,h.headers["Content-Type"]==="application/json; charset=utf-8"&&delete h.headers["Content-Type"]):h.body=JSON.stringify(t);let m=await zt(o,h);if(m.ok){let A=m.headers.get("content-type");return A!=null&&A.includes("application/json")?m.json():m.text()}throw Qt(m),m};var Tt=o=>o.padStart(64,"0").slice(0,64);var Xt=class{constructor(){y(this,"sessionId",void 0)}checkSessionParams(){if(!this.sessionId)throw new Error("Session id is required");this.sessionId=Tt(this.sessionId)}request({method:t="GET",url:n,data:f={},headers:d={}}){let h={headers:d};switch(t){case"GET":return zo(n,h);case"POST":return tt(n,f,h);case"PUT":return Qo(n,f,h);case"PATCH":return qo(n,f,h)}throw new Error("Invalid method type")}};var ne={MAINNET:"mainnet",TESTNET:"testnet",CYAN:"cyan",AQUA:"aqua",CELESTE:"celeste"},Ve={SAPPHIRE_DEVNET:"sapphire_devnet",SAPPHIRE_MAINNET:"sapphire_mainnet"},ts={[ne.MAINNET]:"0xf20336e16B5182637f09821c27BDe29b0AFcfe80",[ne.TESTNET]:"0xd084604e5FA387FbC2Da8bAab07fDD6aDED4614A",[ne.CYAN]:"0x9f072ba19b3370e512aa1b4bfcdaf97283168005",[ne.AQUA]:"0x29Dea82a0509153b91040ee13cDBba0f03efb625",[ne.CELESTE]:"0x6Bffb4e89453069E7487f0fa5c9f4a2D771cce6c"};var rs={[ne.AQUA]:{migrationCompleted:!0,networkIdentifier:"aqua",networkMigratedTo:Ve.SAPPHIRE_MAINNET},[ne.CELESTE]:{migrationCompleted:!0,networkIdentifier:"celeste",networkMigratedTo:Ve.SAPPHIRE_MAINNET},[ne.CYAN]:{migrationCompleted:!0,networkIdentifier:"cyan",networkMigratedTo:Ve.SAPPHIRE_MAINNET},[ne.MAINNET]:{migrationCompleted:!0,networkIdentifier:"mainnet",networkMigratedTo:Ve.SAPPHIRE_MAINNET},[ne.TESTNET]:{migrationCompleted:!0,networkIdentifier:"teal",networkMigratedTo:Ve.SAPPHIRE_DEVNET}},os={[ne.MAINNET]:"mainnet",[ne.TESTNET]:"goerli",[ne.CYAN]:"polygon-mainnet",[ne.AQUA]:"polygon-mainnet",[ne.CELESTE]:"polygon-mainnet"},ns={[Ve.SAPPHIRE_MAINNET]:"https://api.web3auth.io/signer-service",[Ve.SAPPHIRE_DEVNET]:"https://api.web3auth.io/signer-service",[ne.MAINNET]:"https://api.web3auth.io/signer-service",[ne.TESTNET]:"https://api.web3auth.io/signer-service",[ne.CYAN]:"https://api.web3auth.io/signer-polygon-service",[ne.AQUA]:"https://api.web3auth.io/signer-polygon-service",[ne.CELESTE]:"https://api.web3auth.io/signer-polygon-service"},ss={[ne.MAINNET]:"https://api.web3auth.io/metadata-service",[ne.TESTNET]:"https://api.web3auth.io/metadata-service",[ne.CYAN]:"https://api.web3auth.io/metadata-service",[ne.AQUA]:"https://api.web3auth.io/metadata-service",[ne.CELESTE]:"https://api.web3auth.io/metadata-service"};var Or="https://api.web3auth.io/session-service";var Xo=Te(Co()),Zt=new Xo.ec("secp256k1"),Ne=globalThis.crypto||globalThis.msCrypto||{},Ge=Ne.subtle||Ne.webkitSubtle,is=Buffer.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex"),as=Buffer.alloc(32,0);function Ie(o,t){if(!o)throw new Error(t||"Assertion failed")}function fs(o){return Buffer.isBuffer(o)&&o.length===32}function yt(o){return fs(o)?o.compare(as)>0&&o.compare(is)<0:!1}function cs(o,t){if(o.length!==t.length)return!1;let n=0;for(let f=0;f<o.length;f++)n|=o[f]^t[f];return n===0}function At(o){if(typeof Ne.getRandomValues>"u")return Buffer.from(Ne.randomBytes(o));let t=new Uint8Array(o);return Ne.getRandomValues(t),Buffer.from(t)}async function Zo(o){if(!Ne.createHash){let f=await Ge.digest("SHA-512",o);return new Uint8Array(f)}let n=Ne.createHash("sha512").update(o).digest();return new Uint8Array(n)}function en(o){return async function(t,n,f){if(Ge&&Ge[o]&&Ge.importKey){let d={name:"AES-CBC"},h=await Ge.importKey("raw",n,d,!1,[o]),m={name:"AES-CBC",iv:t},A=await Ge[o](m,h,f);return Buffer.from(new Uint8Array(A))}else if(o==="encrypt"&&Ne.createCipheriv){let d=Ne.createCipheriv("aes-256-cbc",n,t),h=d.update(f),m=d.final();return Buffer.concat([h,m])}else if(o==="decrypt"&&Ne.createDecipheriv){let d=Ne.createDecipheriv("aes-256-cbc",n,t),h=d.update(f),m=d.final();return Buffer.concat([h,m])}throw new Error(`Unsupported operation: ${o}`)}}var ds=en("encrypt"),us=en("decrypt");async function tn(o,t){if(!Ne.createHmac){let d={name:"HMAC",hash:{name:"SHA-256"}},h=await Ge.importKey("raw",new Uint8Array(o),d,!1,["sign","verify"]),m=await Ge.sign("HMAC",h,t);return Buffer.from(new Uint8Array(m))}let n=Ne.createHmac("sha256",Buffer.from(o));return n.update(t),n.digest()}async function hs(o,t,n){let f=await tn(o,t);return cs(f,n)}var rn=function(){let o=At(32);for(;!yt(o);)o=At(32);return o},Ue=function(o){return Ie(o.length===32,"Bad private key"),Ie(yt(o),"Bad private key"),Buffer.from(Zt.keyFromPrivate(o).getPublic("array"))};var ct=async function(o,t){return Ie(o.length===32,"Bad private key"),Ie(yt(o),"Bad private key"),Ie(t.length>0,"Message should not be empty"),Ie(t.length<=32,"Message is too long"),Buffer.from(Zt.sign(t,o,{canonical:!0}).toDER())};var on=async function(o,t,n){Ie(Buffer.isBuffer(o),"Bad private key"),Ie(Buffer.isBuffer(t),"Bad public key"),Ie(o.length===32,"Bad private key"),Ie(yt(o),"Bad private key"),Ie(t.length===65||t.length===33,"Bad public key"),t.length===65&&Ie(t[0]===4,"Bad public key"),t.length===33&&Ie(t[0]===2||t[0]===3,"Bad public key");let f=Zt.keyFromPrivate(o),d=Zt.keyFromPublic(t),h=f.derive(d.getPublic());return n?Buffer.from(h.toString(16,64),"hex"):Buffer.from(h.toArray())};var nn=async function(o,t,n){n=n||{};let f=n.ephemPrivateKey||At(32);for(;!yt(f);)f=n.ephemPrivateKey||At(32);let d=Ue(f),h=await on(f,o,n.padding),m=await Zo(h),A=n.iv||At(16),D=m.slice(0,32),z=m.slice(32),ie=await ds(A,Buffer.from(D),t),xe=Buffer.concat([A,d,ie]),Ae=await tn(Buffer.from(z),xe);return{iv:A,ephemPublicKey:d,ciphertext:ie,mac:Ae}},Ur=async function(o,t,n){let f=await on(o,t.ephemPublicKey,n),d=await Zo(f),h=d.slice(0,32),m=d.slice(32),A=Buffer.concat([t.iv,t.ephemPublicKey,t.ciphertext]),D=await hs(Buffer.from(m),A,t.mac);if(!D&&!n)return Ur(o,t,!0);if(!D&&n===!0)throw new Error("bad MAC after trying padded");let z=await us(t.iv,Buffer.from(h),t.ciphertext);return Buffer.from(new Uint8Array(z))};var an=Te(Co());function bt(o){return t=>(Bo(t),o(t))}var Li=bt(Lo),sn=(()=>{let o=bt(Pr);return o.create=Pr.create,o})(),Di=bt(Do),ki=bt(ko);function Ke(o){return Buffer.from(sn(o))}var Mr=new an.ec("secp256k1");function fn(o){return{iv:Buffer.from(o.iv,"hex"),ephemPublicKey:Buffer.from(o.ephemPublicKey,"hex"),ciphertext:Buffer.from(o.ciphertext,"hex"),mac:Buffer.from(o.mac,"hex")}}function cn(o){return{iv:Buffer.from(o.iv).toString("hex"),ephemPublicKey:Buffer.from(o.ephemPublicKey).toString("hex"),ciphertext:Buffer.from(o.ciphertext).toString("hex"),mac:Buffer.from(o.mac).toString("hex")}}async function rt(o,t){let n=JSON.stringify(t),f=Buffer.from(n,"utf-8"),d=await nn(Ue(Buffer.from(o,"hex")),f),h=cn(d);return JSON.stringify(h)}async function vt(o,t){let n=JSON.parse(t),f=fn(n),d=Mr.keyFromPrivate(o),m=(await Ur(Buffer.from(d.getPrivate().toString("hex",64),"hex"),f)).toString("utf-8");return JSON.parse(m)}var ls=86400,We=class extends Xt{constructor({sessionServerBaseUrl:t,sessionNamespace:n,sessionTime:f,sessionId:d,allowedOrigin:h}={}){super(),y(this,"sessionServerBaseUrl",Or),y(this,"sessionNamespace",void 0),y(this,"allowedOrigin",void 0),y(this,"sessionTime",ls),y(this,"sessionId",""),t&&(this.sessionServerBaseUrl=t),n&&(this.sessionNamespace=n),f&&(this.sessionTime=f),d&&(this.sessionId=Tt(d)),h?this.allowedOrigin=h:this.allowedOrigin="*"}static generateRandomSessionKey(){return Tt(rn().toString("hex"))}async createSession(t,n={}){super.checkSessionParams();let f=Buffer.from(this.sessionId,"hex"),d=Ue(f).toString("hex"),h=await rt(this.sessionId,t),m=(await ct(f,Ke(Buffer.from(h,"utf8")))).toString("hex"),A={key:d,data:h,signature:m,namespace:this.sessionNamespace,timeout:this.sessionTime,allowedOrigin:this.allowedOrigin};return await super.request({method:"POST",url:`${this.sessionServerBaseUrl}/v2/store/set`,data:A,headers:n}),this.sessionId}async authorizeSession({headers:t}={headers:{}}){super.checkSessionParams();let f={key:Ue(Buffer.from(this.sessionId,"hex")).toString("hex"),namespace:this.sessionNamespace},d=await super.request({method:"POST",url:`${this.sessionServerBaseUrl}/v2/store/get`,data:f,headers:t});if(!d.message)throw new Error("Session Expired or Invalid public key");let h=await vt(this.sessionId,d.message);if(h.error)throw new Error("There was an error decrypting data.");return h}async updateSession(t,n={}){super.checkSessionParams();let f=Buffer.from(this.sessionId,"hex"),d=Ue(f).toString("hex"),h=await rt(this.sessionId,t),m=(await ct(f,Ke(Buffer.from(h,"utf8")))).toString("hex"),A={key:d,data:h,signature:m,namespace:this.sessionNamespace,allowedOrigin:this.allowedOrigin};await super.request({method:"PUT",url:`${this.sessionServerBaseUrl}/v2/store/update`,data:A,headers:n})}async invalidateSession(t={}){super.checkSessionParams();let n=Buffer.from(this.sessionId,"hex"),f=Ue(n).toString("hex"),d=await rt(this.sessionId,{}),h=(await ct(n,Ke(Buffer.from(d,"utf8")))).toString("hex"),m={key:f,data:d,signature:h,namespace:this.sessionNamespace,timeout:1};return await super.request({method:"POST",url:`${this.sessionServerBaseUrl}/v2/store/set`,data:m,headers:t}),this.sessionId="",!0}};var dn=oe,un=ke,It=M(M({},un),dn),ps={SECP256K1:"secp256k1",ED25519:"ed25519",OTHER:"other"};var $e={LOGIN:"login",ENABLE_MFA:"enable_mfa",MANAGE_MFA:"manage_mfa",ADD_SOCIAL_FACTOR:"add_social_factor",MODIFY_SOCIAL_FACTOR:"modify_social_factor",ADD_AUTHENTICATOR_FACTOR:"add_authenticator_factor",ADD_PASSKEY_FACTOR:"add_passkey_factor"},je={PRODUCTION:"production",DEVELOPMENT:"development",STAGING:"staging",TESTING:"testing"},Me={DEFAULT:"default",IFRAME:"iframe"},Be={SETUP_COMPLETE:"setup_complete",INIT_DAPP:"init_dapp",LOGIN_INITIATED:"login_initiated",LOGIN_CANCELLED:"login_cancelled",LOGIN_FAILED:"login_failed",LOGIN_SUCCESS:"login_success",DISPLAY_IFRAME:"display_iframe",HIDE_IFRAME:"hide_iframe"},er="auth-iframe",Lr="http://localhost:3000",Dr="https://staging-auth.web3auth.io",kr="https://develop-auth.web3auth.io",Br="https://auth.web3auth.io",Hr="http://localhost:5173",Fr="https://staging-account.web3auth.io",Kr="https://develop-account.web3auth.io",jr="https://account.web3auth.io",Yr=1e3*10;var tr={light:"light",dark:"dark",auto:"auto"};var hn=Te(jn()),Vr=hn.default;function rr(o){return Vr.decode(o)}function dt(o){return Vr.encode(JSON.stringify(o))}var Gr=o=>{let t=window.document.createElement("template"),n=o.trim();return t.innerHTML=n,t.content.firstChild};function ms(o){try{return structuredClone(o)}catch{return JSON.parse(JSON.stringify(o))}}var or=new Map;function xs(o){return o===tr.light?"light":o===tr.dark||window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}var nr=class{constructor({sdkUrl:t,whiteLabel:n}){y(this,"sdkUrl",void 0),y(this,"whiteLabel",void 0),y(this,"initialized",!1),y(this,"loginCallbackSuccess",null),y(this,"loginCallbackFailed",null),y(this,"embedNonce",Ro()),this.sdkUrl=t,this.whiteLabel=n}get targetOrigin(){return new URL(this.sdkUrl).origin}getAuthServiceIframe(){return or.get(this.embedNonce)}registerAuthServiceIframe(t){or.set(this.embedNonce,t)}cleanup(){let t=or.get(this.embedNonce);t&&t.parentNode&&(t.parentNode.removeChild(t),or.delete(this.embedNonce))}async init({network:t,clientId:n}){if(typeof window>"u"||typeof document>"u")throw new Error("window or document is not available");if(this.initialized)throw new Error("AuthProvider already initialized");let f=new URL(this.sdkUrl);f.pathname.endsWith("/")?f.pathname+="frame":f.pathname+="/frame";let d=new URLSearchParams;d.append("origin",window.location.origin),d.append("nonce",this.embedNonce),f.hash=d.toString();let h=xs(this.whiteLabel.mode||tr.light),m=Gr(`<iframe
        id="${er}-${this.embedNonce}"
        class="${er}-${this.embedNonce}"
        sandbox="allow-popups allow-scripts allow-same-origin allow-forms allow-modals allow-downloads"
        src="${f.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%; z-index: 10000000;
        height: 100%; border: none; border-radius: 0; color-scheme: ${h};"
        allow="clipboard-write"
      ></iframe>`);return this.registerAuthServiceIframe(m),new Promise((A,D)=>{try{window.document.body.appendChild(m);let z=fe=>{var ie,xe,Ae;if(fe.origin!==this.targetOrigin)return;let{data:we}=fe,{type:Ee,nonce:Le}=we;if(Le!==this.embedNonce)return;let ye=we.data;switch(Ee){case Be.SETUP_COMPLETE:(ie=this.getAuthServiceIframe())===null||ie===void 0||(ie=ie.contentWindow)===null||ie===void 0||ie.postMessage({type:Be.INIT_DAPP,data:{network:t,clientId:n}},this.targetOrigin),this.initialized=!0,A();break;case Be.LOGIN_FAILED:(xe=this.loginCallbackFailed)===null||xe===void 0||xe.call(this,ye?.error||"Login failed, reason: unknown");break;case Be.DISPLAY_IFRAME:this.getAuthServiceIframe().style.display="block";break;case Be.HIDE_IFRAME:this.getAuthServiceIframe().style.display="none";break;case Be.LOGIN_SUCCESS:ve.info("LOGIN_SUCCESS",ye),this.getAuthServiceIframe().style.display="none",ye!=null&&ye.sessionId&&((Ae=this.loginCallbackSuccess)===null||Ae===void 0||Ae.call(this,ye));break;default:ve.warn(`Unknown message type: ${Ee}`);break}};window.addEventListener("message",z)}catch(z){D(z)}})}postLoginInitiatedMessage(t,n){var f;if(!this.initialized)throw new Error("Iframe not initialized");return(f=this.getAuthServiceIframe().contentWindow)===null||f===void 0||f.postMessage({type:Be.LOGIN_INITIATED,data:{loginConfig:t,nonce:n}},this.targetOrigin),new Promise((d,h)=>{this.loginCallbackSuccess=d,this.loginCallbackFailed=h})}postLoginCancelledMessage(t){var n;if(!this.initialized)throw new Error("Iframe not initialized");(n=this.getAuthServiceIframe().contentWindow)===null||n===void 0||n.postMessage({type:Be.LOGIN_CANCELLED,data:{nonce:t}},this.targetOrigin)}};function Es(o,t){var n=Object.setPrototypeOf;n?n(o,t):o.__proto__=t}function gs(o,t){t===void 0&&(t=o.constructor);var n=Error.captureStackTrace;n&&n(o,t)}var Ss=(function(){var o=function(n,f){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&(d[m]=h[m])},o(n,f)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");o(t,n);function f(){this.constructor=t}t.prototype=n===null?Object.create(n):(f.prototype=n.prototype,new f)}})(),sr=(function(o){Ss(t,o);function t(n,f){var d=this.constructor,h=o.call(this,n,f)||this;return Object.defineProperty(h,"name",{value:d.name,enumerable:!1,configurable:!0}),Es(h,d.prototype),gs(h),h}return t})(Error);var ir=class extends sr{constructor(t,n){super(n),y(this,"code",void 0),y(this,"message",void 0),this.code=t,this.message=n||"",Object.defineProperty(this,"name",{value:"AuthError"})}toJSON(){return{name:this.name,code:this.code,message:this.message}}toString(){return JSON.stringify(this.toJSON())}},ot=class o extends ir{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"InitializationError"})}static fromCode(t,n=""){return new o(t,`${o.messages[t]}, ${n}`)}static invalidParams(t=""){return o.fromCode(5001,t)}static notInitialized(t=""){return o.fromCode(5002,t)}};y(ot,"messages",{5e3:"Custom",5001:"Invalid constructor params",5002:"SDK not initialized. please call init first"});var ae=class o extends ir{constructor(t,n){super(t,n),Object.defineProperty(this,"name",{value:"LoginError"})}static fromCode(t,n=""){return new o(t,`${o.messages[t]}, ${n}`)}static invalidLoginParams(t=""){return o.fromCode(5111,t)}static userNotLoggedIn(t=""){return o.fromCode(5112,t)}static popupClosed(t=""){return o.fromCode(5113,t)}static loginFailed(t=""){return o.fromCode(5114,t)}static popupBlocked(t=""){return o.fromCode(5115,t)}static mfaAlreadyEnabled(t=""){return o.fromCode(5116,t)}static mfaNotEnabled(t=""){return o.fromCode(5117,t)}};y(ae,"messages",{5e3:"Custom",5111:"Invalid login params",5112:"User not logged in.",5113:"login popup has been closed by the user",5114:"Login failed",5115:"Popup was blocked. Please call this function as soon as user clicks button or use redirect mode",5116:"MFA already enabled",5117:"MFA not yet enabled. Please call `enableMFA` first"});var se={MAINNET:"mainnet",TESTNET:"testnet",CYAN:"cyan",AQUA:"aqua",CELESTE:"celeste"},Je={SAPPHIRE_DEVNET:"sapphire_devnet",SAPPHIRE_MAINNET:"sapphire_mainnet"},_s={[se.MAINNET]:"0xf20336e16B5182637f09821c27BDe29b0AFcfe80",[se.TESTNET]:"0xd084604e5FA387FbC2Da8bAab07fDD6aDED4614A",[se.CYAN]:"0x9f072ba19b3370e512aa1b4bfcdaf97283168005",[se.AQUA]:"0x29Dea82a0509153b91040ee13cDBba0f03efb625",[se.CELESTE]:"0x6Bffb4e89453069E7487f0fa5c9f4a2D771cce6c"};var ws={[se.AQUA]:{migrationCompleted:!0,networkIdentifier:"aqua",networkMigratedTo:Je.SAPPHIRE_MAINNET},[se.CELESTE]:{migrationCompleted:!0,networkIdentifier:"celeste",networkMigratedTo:Je.SAPPHIRE_MAINNET},[se.CYAN]:{migrationCompleted:!0,networkIdentifier:"cyan",networkMigratedTo:Je.SAPPHIRE_MAINNET},[se.MAINNET]:{migrationCompleted:!0,networkIdentifier:"mainnet",networkMigratedTo:Je.SAPPHIRE_MAINNET},[se.TESTNET]:{migrationCompleted:!0,networkIdentifier:"teal",networkMigratedTo:Je.SAPPHIRE_DEVNET}},Ts={[se.MAINNET]:"mainnet",[se.TESTNET]:"goerli",[se.CYAN]:"polygon-mainnet",[se.AQUA]:"polygon-mainnet",[se.CELESTE]:"polygon-mainnet"},As={[Je.SAPPHIRE_MAINNET]:"https://api.web3auth.io/signer-service",[Je.SAPPHIRE_DEVNET]:"https://api.web3auth.io/signer-service",[se.MAINNET]:"https://api.web3auth.io/signer-service",[se.TESTNET]:"https://api.web3auth.io/signer-service",[se.CYAN]:"https://api.web3auth.io/signer-polygon-service",[se.AQUA]:"https://api.web3auth.io/signer-polygon-service",[se.CELESTE]:"https://api.web3auth.io/signer-polygon-service"},ys={[se.MAINNET]:"https://api.web3auth.io/metadata-service",[se.TESTNET]:"https://api.web3auth.io/metadata-service",[se.CYAN]:"https://api.web3auth.io/metadata-service",[se.AQUA]:"https://api.web3auth.io/metadata-service",[se.CELESTE]:"https://api.web3auth.io/metadata-service"};var Wr="https://api.web3auth.io/session-service",$r="https://session.web3auth.io";var ln=Te(Gt()),me=ln.default.getLogger("SecurePubSub");var Nt=class{constructor(t={}){y(this,"options",void 0),y(this,"SOCKET_CONN",null),this.options=t,this.options.timeout=t.timeout||600,this.options.serverUrl=t.serverUrl||Wr,this.options.socketUrl=t.socketUrl||$r,this.options.enableLogging=t.enableLogging||!1,this.options.namespace=t.namespace||"",this.options.sameIpCheck=t.sameIpCheck||!1,this.options.allowedOrigin=t.allowedOrigin||"*",this.options.enableLogging?me.enableAll():me.disableAll()}static setLogLevel(t){me.setLevel(t),Jo(t)}async publish(t,n){if(!this.isValidTopic(t))throw me.error("Invalid topic"),new Error("Invalid topic");let f=Ke(Buffer.from(t,"utf8")),d=await rt(f.toString("hex"),n),h=await ct(f,Ke(Buffer.from(d,"utf8"))),m={key:Ue(f).toString("hex"),data:d,signature:h.toString("hex"),timeout:this.options.timeout,namespace:this.options.namespace,sameIpCheck:this.options.sameIpCheck,allowedOrigin:this.options.allowedOrigin};return tt(`${this.options.serverUrl}/v2/channel/set`,m)}async subscribe(t){let n=!0,f=Ke(Buffer.from(t,"utf8")),d=Ue(f).toString("hex"),h=this.getSocketConnection();h.connected?(me.debug("already connected with socket"),h.emit("v2:check_auth_status",d,{namespace:this.options.namespace,sameIpCheck:this.options.sameIpCheck,allowedOrigin:this.options.allowedOrigin})):h.once("connect",()=>{me.debug("connected with socket"),h.emit("v2:check_auth_status",d,{namespace:this.options.namespace,sameIpCheck:this.options.sameIpCheck,allowedOrigin:this.options.allowedOrigin})});let m=()=>{h.once("connect",async()=>{me.debug("connected with socket using reconnect"),n&&h.emit("v2:check_auth_status",d,{namespace:this.options.namespace,sameIpCheck:this.options.sameIpCheck,allowedOrigin:this.options.allowedOrigin})})},A=()=>{n||document.removeEventListener("visibilitychange",A),!h.connected&&document.visibilityState==="visible"&&m()},D=()=>{me.debug("socket disconnected",n),n?(me.error("socket disconnected unexpectedly, reconnecting socket"),m()):h.removeListener("disconnect",D)};h.on("disconnect",D);let z=new Promise((fe,ie)=>{let xe=async Ae=>{try{let we=await vt(f.toString("hex"),Ae);me.info("got data",we),fe(we)}catch(we){me.error(we),ie(we)}finally{n=!1,typeof document<"u"&&document.removeEventListener("visibilitychange",A)}};me.info("listening to",`${d}_success`),h.once(`${d}_success`,xe)});return typeof document<"u"&&document.addEventListener("visibilitychange",A),z}cleanup(){this.SOCKET_CONN&&(this.SOCKET_CONN.disconnect(),this.SOCKET_CONN=null)}getSocketConnection(){if(this.SOCKET_CONN)return this.SOCKET_CONN;let t=Ho(this.options.socketUrl,{transports:["websocket","polling"],withCredentials:!0,reconnectionDelayMax:1e4,reconnectionAttempts:10});return t.on("connect_error",n=>{t.io.opts.transports=["polling","websocket"],me.error("connect error",n)}),t.on("connect",async()=>{let{engine:n}=t.io;me.debug("initially connected to",n.transport.name),n.once("upgrade",()=>{me.debug("upgraded",n.transport.name)}),n.once("close",f=>{me.debug("connection closed",f)})}),t.on("error",n=>{me.error("socket errored",n),t.disconnect()}),this.SOCKET_CONN=t,this.SOCKET_CONN}isValidTopic(t){return t&&t.length>0}};var pn=Te(Uo());var ar=class extends pn.EventEmitter{constructor({url:t,target:n,features:f,timeout:d=3e4,sessionSocketUrl:h,sessionServerUrl:m}){super(),y(this,"url",void 0),y(this,"target",void 0),y(this,"features",void 0),y(this,"window",void 0),y(this,"windowTimer",void 0),y(this,"iClosedWindow",void 0),y(this,"timeout",void 0),y(this,"sessionSocketUrl",void 0),y(this,"sessionServerUrl",void 0),this.url=t,this.target=n||"_blank",this.features=f||Po(),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=d,this.sessionServerUrl=m||gt,this.sessionSocketUrl=h||St,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout(()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0},this.timeout)),this.window===void 0&&clearInterval(this.windowTimer)},500))}open(){var t;if(this.window=window.open(this.url,this.target,this.features),!this.window)throw ae.popupBlocked();(t=this.window)!==null&&t!==void 0&&t.focus&&this.window.focus()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(t){t?window.location.replace(this.url):window.location.href=this.url}async listenOnChannel(t){let n=new Nt({serverUrl:this.sessionServerUrl,socketUrl:this.sessionSocketUrl,sameIpCheck:!0,allowedOrigin:!0}),f=await n.subscribe(t);this.close(),n.cleanup();let d=JSON.parse(f);return d.error?{error:d.error,state:d.state}:d.data}};var fr="10.5.0";function Jr(o=!1){let t={},n=new URLSearchParams(window.location.search.slice(1));n.forEach((m,A)=>{A!=="b64Params"&&(t[A]=m)});let f=n.get("b64Params");if(f)try{let m=JSON.parse(rr(f));Object.keys(m).forEach(A=>{t[A]=m[A]})}catch(m){ve.error(m)}let d=new URLSearchParams(window.location.hash.substring(1));d.forEach((m,A)=>{A!=="b64Params"&&(t[A]=m)});let h=d.get("b64Params");if(h)try{let m=JSON.parse(rr(h));Object.keys(m).forEach(A=>{t[A]=m[A]})}catch(m){ve.error(m)}if(o){let m=new URL(window.location.origin+window.location.pathname);n.size!==0&&(n.delete("error"),n.delete("state"),n.delete("b64Params"),n.delete("sessionNamespace"),m.search=n.toString()),d.size!==0&&(d.delete("error"),d.delete("state"),d.delete("b64Params"),d.delete("sessionNamespace"),m.hash=d.toString()),window.history.replaceState(M(M({},window.history.state),{},{as:m.href,url:m.href}),"",m.href)}return t}var cr=class{constructor(){y(this,"store",new Map)}getItem(t){return this.store.get(t)||null}setItem(t,n){this.store.set(t,n)}removeItem(t){this.store.delete(t)}},ut=class{constructor(t,n){y(this,"storage",void 0),y(this,"_storeKey",void 0),this.storage=n,this._storeKey=t;try{n.getItem(t)||this.resetStore()}catch{}}static getInstance(t,n="local"){if(!this.instanceMap.has(t)){let f;n==="local"&&Rr("localStorage")?f=window.localStorage:n==="session"&&Rr("sessionStorage")?f=window.sessionStorage:f=new cr,this.instanceMap.set(t,new this(t,f))}return this.instanceMap.get(t)}toJSON(){return this.storage.getItem(this._storeKey)}resetStore(){let t=this.getStore();return this.storage.removeItem(this._storeKey),t}getStore(){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")}get(t){return JSON.parse(this.storage.getItem(this._storeKey)||"{}")[t]}set(t,n){let f=JSON.parse(this.storage.getItem(this._storeKey)||"{}");f[t]=n,this.storage.setItem(this._storeKey,JSON.stringify(f))}};y(ut,"instanceMap",new Map);var zr=class{constructor(t){if(y(this,"state",{}),y(this,"options",void 0),y(this,"sessionManager",void 0),y(this,"currentStorage",void 0),y(this,"_storageBaseKey","auth_store"),y(this,"dappState",void 0),y(this,"addVersionInUrls",!0),y(this,"authProvider",void 0),y(this,"authProviderPromise",void 0),!t.clientId)throw ot.invalidParams("clientId is required");t.network||(t.network=It.SAPPHIRE_MAINNET),t.buildEnv||(t.buildEnv=je.PRODUCTION),t.sdkMode||(t.sdkMode=Me.DEFAULT),(t.buildEnv===je.DEVELOPMENT||t.buildEnv===je.TESTING||t.sdkUrl)&&(this.addVersionInUrls=!1),!t.sdkUrl&&!t.useMpc&&(t.buildEnv===je.DEVELOPMENT?(t.sdkUrl=Lr,t.dashboardUrl=Hr):t.buildEnv===je.STAGING?(t.sdkUrl=Dr,t.dashboardUrl=Fr):t.buildEnv===je.TESTING?(t.sdkUrl=kr,t.dashboardUrl=Kr):(t.sdkUrl=Br,t.dashboardUrl=jr)),!t.redirectUrl&&typeof window<"u"&&(t.redirectUrl=`${window.location.protocol}//${window.location.host}${window.location.pathname}`),t.uxMode||(t.uxMode=De.REDIRECT),typeof t.replaceUrlOnRedirect!="boolean"&&(t.replaceUrlOnRedirect=!0),typeof t.includeUserDataInToken!="boolean"&&(t.includeUserDataInToken=!0),t.originData||(t.originData={}),t.whiteLabel||(t.whiteLabel={}),t.authConnectionConfig||(t.authConnectionConfig=[]),t.mfaSettings||(t.mfaSettings={}),t.storageServerUrl||(t.storageServerUrl=gt),t.sessionSocketUrl||(t.sessionSocketUrl=St),t.storage||(t.storage="local"),t.sessionTime||(t.sessionTime=86400),this.options=t}get privKey(){return this.options.useMpc?this.state.factorKey||"":this.state.privKey?this.state.privKey.padStart(64,"0"):""}get coreKitKey(){return this.state.coreKitKey?this.state.coreKitKey.padStart(64,"0"):""}get ed25519PrivKey(){return this.state.ed25519PrivKey?this.state.ed25519PrivKey.padStart(128,"0"):""}get coreKitEd25519Key(){return this.state.coreKitEd25519PrivKey?this.state.coreKitEd25519PrivKey.padStart(128,"0"):""}get sessionId(){return this.state.sessionId||""}get sessionNamespace(){return this.options.sessionNamespace||""}get appState(){return this.state.userInfo.appState||this.dappState||""}get baseUrl(){return this.addVersionInUrls?`${this.options.sdkUrl}/v${fr.split(".")[0]}`:`${this.options.sdkUrl}`}get dashboardUrl(){return this.addVersionInUrls?`${this.options.dashboardUrl}/v${fr.split(".")[0]}`:`${this.options.dashboardUrl}`}async init(){let t=Jr(this.options.replaceUrlOnRedirect);t.sessionNamespace&&(this.options.sessionNamespace=t.sessionNamespace);let n=this.options.sessionKey||(this.options.sessionNamespace?`${this._storageBaseKey}_${this.options.sessionNamespace}`:this._storageBaseKey);this.currentStorage=ut.getInstance(n,this.options.storage);let f=this.currentStorage.get("sessionId");if(this.sessionManager=new We({sessionServerBaseUrl:this.options.storageServerUrl,sessionNamespace:this.options.sessionNamespace,sessionTime:this.options.sessionTime,sessionId:f,allowedOrigin:this.options.sdkUrl}),this.options.network===It.TESTNET||(this.options.network,It.SAPPHIRE_DEVNET),this.options.buildEnv,je.PRODUCTION,t.error)throw this.dappState=t.state,ae.loginFailed(t.error);if(t.sessionId&&(this.currentStorage.set("sessionId",t.sessionId),this.sessionManager.sessionId=t.sessionId),this.sessionManager.sessionId){let d=await this._authorizeSession();this.updateState(d),Object.keys(d).length===0?this.currentStorage.set("sessionId",""):this.updateState({sessionId:this.sessionManager.sessionId})}this.options.sdkMode===Me.IFRAME&&(this.authProvider=new nr({sdkUrl:this.baseUrl,whiteLabel:this.options.whiteLabel}),this.state.sessionId||(this.authProviderPromise=this.authProvider.init({network:this.options.network,clientId:this.options.clientId}),t.nonce&&(await this.authProviderPromise,await this.postLoginInitiatedMessage(JSON.parse(t.loginParams),t.nonce))))}async login(t){if(!t.authConnection&&(!t.authConnectionId||!t.groupedAuthConnectionId))throw ae.invalidLoginParams("AuthConnection is required");let n=M({},t),f={actionType:$e.LOGIN,options:this.options,params:n},d=await this.authHandler(`${this.baseUrl}/start`,f,Oo(t.authConnection));if(this.options.uxMode===De.REDIRECT)return null;if(d.error)throw this.dappState=d.state,ae.loginFailed(d.error);return this.sessionManager.sessionId=d.sessionId,this.options.sessionNamespace=d.sessionNamespace,this.currentStorage.set("sessionId",d.sessionId),await this.rehydrateSession(),{privKey:this.privKey}}async postLoginInitiatedMessage(t,n){var f;if(this.options.sdkMode!==Me.IFRAME)throw ae.invalidLoginParams("Cannot perform this action in default mode.");this.authProviderPromise&&await this.authProviderPromise,(f=this.authProvider)!==null&&f!==void 0&&f.initialized||await this.authProvider.init({network:this.options.network,clientId:this.options.clientId});let d=await this.authProvider.postLoginInitiatedMessage({actionType:$e.LOGIN,params:t,options:this.options},n);if(d.error)throw ae.loginFailed(d.error);this.sessionManager.sessionId=d.sessionId,this.options.sessionNamespace=d.sessionNamespace,this.currentStorage.set("sessionId",d.sessionId),await this.rehydrateSession()}async postLoginCancelledMessage(t){var n;if(this.options.sdkMode!==Me.IFRAME)throw ae.invalidLoginParams("Cannot perform this action in default mode.");if(this.authProviderPromise&&await this.authProviderPromise,!((n=this.authProvider)!==null&&n!==void 0&&n.initialized))throw ot.notInitialized();this.authProvider.postLoginCancelledMessage(t)}async logout(){if(!this.sessionManager.sessionId)throw ae.userNotLoggedIn();await this.sessionManager.invalidateSession(),this.updateState({privKey:"",coreKitKey:"",coreKitEd25519PrivKey:"",ed25519PrivKey:"",walletKey:"",oAuthPrivateKey:"",tKey:"",metadataNonce:"",keyMode:void 0,userInfo:{name:"",profileImage:"",dappShare:"",idToken:"",oAuthIdToken:"",oAuthAccessToken:"",appState:"",email:"",authConnectionId:"",userId:"",groupedAuthConnectionId:"",authConnection:"",isMfaEnabled:!1},authToken:"",sessionId:"",factorKey:"",signatures:[],tssShareIndex:-1,tssPubKey:"",tssShare:"",tssNonce:-1}),this.currentStorage.set("sessionId","")}async enableMFA(t){var n;if(!this.sessionId)throw ae.userNotLoggedIn();if(this.state.userInfo.isMfaEnabled)throw ae.mfaAlreadyEnabled();let f={actionType:$e.ENABLE_MFA,options:M(M({},this.options),{},{sdkMode:Me.DEFAULT}),params:M(M({},t),{},{authConnection:this.state.userInfo.authConnection,authConnectionId:this.state.userInfo.authConnectionId,groupedAuthConnectionId:this.state.userInfo.groupedAuthConnectionId,extraLoginOptions:{login_hint:this.state.userInfo.userId},mfaLevel:"mandatory"}),sessionId:this.sessionId},d=await this.authHandler(`${this.baseUrl}/start`,f,Yr);if(this.options.uxMode===De.REDIRECT)return null;if(d.error)throw this.dappState=d.state,ae.loginFailed(d.error);return this.sessionManager.sessionId=d.sessionId,this.options.sessionNamespace=d.sessionNamespace,this.currentStorage.set("sessionId",d.sessionId),await this.rehydrateSession(),!!(!((n=this.state.userInfo)===null||n===void 0)&&n.isMfaEnabled)}async manageMFA(t){if(!this.sessionId)throw ae.userNotLoggedIn();if(!this.state.userInfo.isMfaEnabled)throw ae.mfaNotEnabled();let n={dappUrl:`${window.location.origin}${window.location.pathname}`},f=We.generateRandomSessionKey(),d={actionType:$e.MANAGE_MFA,options:M(M({},this.options),{},{uxMode:De.REDIRECT,sdkMode:Me.DEFAULT,redirectUrl:`${this.dashboardUrl}/wallet/account`}),params:M(M(M({},n),t),{},{authConnection:this.state.userInfo.authConnection,authConnectionId:this.state.userInfo.authConnectionId,groupedAuthConnectionId:this.state.userInfo.groupedAuthConnectionId,extraLoginOptions:{login_hint:this.state.userInfo.userId},appState:dt({loginId:f})}),sessionId:this.sessionId};this.createLoginSession(f,d,d.options.sessionTime,!0);let h={loginId:f,sessionNamespace:this.options.sessionNamespace,storageServerUrl:this.options.storageServerUrl},m=Wt({baseURL:`${this.baseUrl}/start`,hash:{b64Params:dt(h)}});window.open(m,"_blank")}async manageSocialFactor(t,n){if(!this.sessionId)throw ae.userNotLoggedIn();let f={actionType:t,options:M(M({},this.options),{},{sdkMode:Me.DEFAULT}),params:M({},n),sessionId:this.sessionId},d=await this.authHandler(`${this.baseUrl}/start`,f);if(this.options.uxMode!==De.REDIRECT)return!d.error}async addAuthenticatorFactor(t){if(!this.sessionId)throw ae.userNotLoggedIn();let n={actionType:$e.ADD_AUTHENTICATOR_FACTOR,options:M(M({},this.options),{},{sdkMode:Me.DEFAULT}),params:M(M({},t),{},{authConnection:Cr.AUTHENTICATOR}),sessionId:this.sessionId},f=await this.authHandler(`${this.baseUrl}/start`,n);if(this.options.uxMode!==De.REDIRECT)return!f.error}async addPasskeyFactor(t){if(!this.sessionId)throw ae.userNotLoggedIn();let n={actionType:$e.ADD_PASSKEY_FACTOR,options:M(M({},this.options),{},{sdkMode:Me.DEFAULT}),params:M(M({},t),{},{authConnection:Cr.PASSKEYS}),sessionId:this.sessionId},f=await this.authHandler(`${this.baseUrl}/start`,n);if(this.options.uxMode!==De.REDIRECT)return!f.error}async cleanup(){this.authProvider&&this.authProvider.cleanup()}getUserInfo(){if(!this.sessionManager.sessionId)throw ae.userNotLoggedIn();return this.state.userInfo}async createLoginSession(t,n,f=600,d=!1){if(!this.sessionManager)throw ot.notInitialized();let m=new We({sessionServerBaseUrl:n.options.storageServerUrl,sessionNamespace:n.options.sessionNamespace,sessionTime:f,sessionId:t,allowedOrigin:this.options.sdkUrl}).createSession(JSON.parse(JSON.stringify(n)));n.options.uxMode===De.REDIRECT&&!d&&await m}async _authorizeSession(){try{return this.sessionManager.sessionId?await this.sessionManager.authorizeSession():{}}catch(t){return ve.error("authorization failed",t),{}}}updateState(t){this.state=M(M({},this.state),t)}async rehydrateSession(){let t=await this._authorizeSession();this.updateState(t)}async authHandler(t,n,f=1e3*10){let d=We.generateRandomSessionKey();await this.createLoginSession(d,n);let h={loginId:d,sessionNamespace:this.options.sessionNamespace,storageServerUrl:this.options.storageServerUrl};if(this.options.uxMode===De.REDIRECT){let D=Wt({baseURL:t,hash:{b64Params:dt(h)}});window.location.href=D;return}let m=Wt({baseURL:t,hash:{b64Params:dt(h)}}),A=new ar({url:m,timeout:f,sessionServerUrl:this.options.storageServerUrl,sessionSocketUrl:this.options.sessionSocketUrl});return new Promise((D,z)=>{A.on("close",()=>{z(ae.popupClosed())}),A.listenOnChannel(d).then(D).catch(z);try{A.open()}catch(fe){z(fe)}})}};var xn=Te(Uo());function mn(o,t,n){try{Reflect.apply(o,t,n)}catch(f){setTimeout(()=>{throw f})}}function bs(o){let t=o.length,n=new Array(t);for(let f=0;f<t;f+=1)n[f]=o[f];return n}var ze=class extends xn.EventEmitter{emit(t,...n){let f=t==="error",d=this._events;if(d!==void 0)f=f&&d.error===void 0;else if(!f)return!1;if(f){let m;if(n.length>0&&([m]=n),m instanceof Error)throw m;let A=new Error(`Unhandled error.${m?` (${m.message})`:""}`);throw A.context=m,A}let h=d[t];if(h===void 0)return!1;if(typeof h=="function")mn(h,this,n);else{let m=h.length,A=bs(h);for(let D=0;D<m;D+=1)mn(A[D],this,n)}return!0}};var En=Te(Mo()),qe=class extends Error{constructor({code:t,message:n,data:f}){if(!Number.isInteger(t))throw new Error("code must be an integer");if(!n||typeof n!="string")throw new Error("message must be string");super(n),y(this,"code",void 0),y(this,"data",void 0),this.code=t,f!==void 0&&(this.data=f)}toString(){return(0,En.default)({code:this.code,message:this.message,data:this.data,stack:this.stack})}};var vn=Te(Mo());var pe={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}},qr={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}};var wn=function(o,t){if(typeof o>"u"||o===null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(o),t)},gn=pe.rpc.internal,vs="Unspecified error message. This is a bug, please report it.",Is="Unspecified server error.";function Tn(o){return Number.isInteger(o)}function Sn(o){return typeof o=="string"&&o.length>0}function dr(o){return!!o&&typeof o=="object"&&!Array.isArray(o)}function An(o){if(typeof o!="object"||o===null)return!1;try{let t=o;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(o)===t}catch{return!1}}function Ns(o){return o>=-32099&&o<=-32e3}function yn(o){let t=o;return!(!t||!Tn(t.code)||!Sn(t.message)||t.stack&&!Sn(t.stack))}function ht(o,t=vs){if(Tn(o)){let n=o.toString();if(wn(qr,n))return qr[n].message;if(Ns(o))return Is}return t}var Cs={code:gn,message:ht(gn)};function Qr(o){try{JSON.parse(JSON.stringify(o,(t,n)=>{if(t==="__proto__"||t==="constructor")throw new Error("Not valid json");if(typeof n=="function"||typeof n=="symbol")throw new Error("Not valid json");return n}),(t,n)=>{if(!(t==="__proto__"||t==="constructor"))return n})}catch{return!1}return!0}function _n(o){return Object.getOwnPropertyNames(o).reduce((t,n)=>{let f=o[n];return Qr(f)&&(t[n]=f),t},{})}function Xr(o){return Array.isArray(o)?o.map(t=>Qr(t)?t:dr(t)?_n(t):null):dr(o)?_n(o):Qr(o)?o:null}function Rs(o,t){if(o&&typeof o=="object"&&"serialize"in o&&typeof o.serialize=="function")return o.serialize();if(yn(o))return o;let n=Xr(o);return M(M({},t),{},{data:{cause:n}})}function ur(o,{fallbackError:t=Cs,shouldIncludeStack:n=!0}={}){if(!yn(t))throw new Error("Must provide fallback error with integer number code and string message.");let f=Rs(o,t);return n||delete f.stack,f}function bn(o){return dr(o)&&wn(o,"cause")&&dr(o.cause)}var Ps=function(o,t){if(typeof o>"u"||o===null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(o),t)};function Os(o){return Number.isInteger(o)&&o>=1e3&&o<=4999}function Us(o,t){if(t!=="[Circular]")return t}var Ct=class extends Error{constructor(t,n,f){if(!Number.isInteger(t))throw new Error('"code" must be an integer.');if(!n||typeof n!="string")throw new Error('"message" must be a non-empty string.');bn(f)?(super(n,{cause:f.cause}),y(this,"cause",void 0),y(this,"code",void 0),y(this,"data",void 0),Ps(this,"cause")||Object.assign(this,{cause:f.cause})):(super(n),y(this,"cause",void 0),y(this,"code",void 0),y(this,"data",void 0)),f!==void 0&&(this.data=f),this.code=t,this.cause=f?.cause}serialize(){let t={code:this.code,message:this.message};return this.data!==void 0&&(t.data=this.data,An(this.data)&&(t.data.cause=Xr(this.data.cause))),this.stack&&(t.stack=this.stack),t}toString(){return(0,vn.default)(this.serialize(),{replacer:Us,space:2})}},Rt=class extends Ct{constructor(t,n,f){if(!Os(t))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(t,n,f)}};function In(o){if(o){if(typeof o=="string")return[o];if(typeof o=="object"&&!Array.isArray(o)){let{message:t,data:n}=o;if(t&&typeof t!="string")throw new Error("Must specify string message.");return[t??void 0,n]}}return[]}function Re(o,t){let[n,f]=In(t);return new Ct(o,n??ht(o),f)}function Pt(o,t){let[n,f]=In(t);return new Rt(o,n??ht(o),f)}var Ye={parse:o=>Re(pe.rpc.parse,o),invalidRequest:o=>Re(pe.rpc.invalidRequest,o),invalidParams:o=>Re(pe.rpc.invalidParams,o),methodNotFound:o=>Re(pe.rpc.methodNotFound,o),internal:o=>Re(pe.rpc.internal,o),server:o=>{if(!o||typeof o!="object"||Array.isArray(o))throw new Error("Ethereum RPC Server errors must provide single object argument.");let{code:t}=o;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return Re(t,o)},invalidInput:o=>Re(pe.rpc.invalidInput,o),resourceNotFound:o=>Re(pe.rpc.resourceNotFound,o),resourceUnavailable:o=>Re(pe.rpc.resourceUnavailable,o),transactionRejected:o=>Re(pe.rpc.transactionRejected,o),methodNotSupported:o=>Re(pe.rpc.methodNotSupported,o),limitExceeded:o=>Re(pe.rpc.limitExceeded,o)},Ms={userRejectedRequest:o=>Pt(pe.provider.userRejectedRequest,o),unauthorized:o=>Pt(pe.provider.unauthorized,o),unsupportedMethod:o=>Pt(pe.provider.unsupportedMethod,o),disconnected:o=>Pt(pe.provider.disconnected,o),chainDisconnected:o=>Pt(pe.provider.chainDisconnected,o),custom:o=>{if(!o||typeof o!="object"||Array.isArray(o))throw new Error("Ethereum Provider custom errors must provide single object argument.");let{code:t,message:n,data:f}=o;if(!n||typeof n!="string")throw new Error('"message" must be a nonempty string');return new Rt(t,n,f)}};var Ls=Te(Ko());function Ds(o){return(t,n,f,d)=>{let h=o[t.method];return h===void 0?f():typeof h=="function"?h(t,n,f,d):(n.result=h,d())}}function Zr(o){return async(t,n,f,d)=>{let h,m=new Promise(fe=>{h=fe}),A=null,D=!1,z=async()=>{D=!0,f(fe=>{A=fe,h()}),await m};try{await o(t,n,z),D?(await m,A(null)):d(null)}catch(fe){let ie=fe;A?A(ie):d(ie)}}}var ks=Te(Ko());function eo(o){let{message:t="",code:n=-32603,stack:f="Stack trace is not available.",data:d=""}=o,h=parseInt(n?.toString()||"-32603");return{message:t||o?.toString()||ht(h),code:h,stack:f,data:d||t||o?.toString()}}var hr=class o extends ze{constructor(){super(),y(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(t,n,f){let d=[],h=null,m=!1;for(let A of f)if([h,m]=await o._runMiddleware(t,n,A,d),m)break;return[h,m,d.reverse()]}static _runMiddleware(t,n,f,d){return new Promise(h=>{let m=D=>{let z=D||n.error;z&&(typeof z=="object"&&Object.keys(z).includes("stack")===!1&&(z.stack="Stack trace is not available."),ve.error(z),n.error=ur(z,{shouldIncludeStack:!0,fallbackError:eo(z)})),h([z,!0])},A=D=>{n.error?m(n.error):(D&&(typeof D!="function"&&m(new qe({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),d.push(D)),h([null,!1]))};try{f(t,n,A,m)}catch(D){m(D)}})}static async _runReturnHandlers(t){for(let n of t)await new Promise((f,d)=>{n(h=>h?d(h):f())})}static _checkForCompletion(t,n,f){if(!("result"in n)&&!("error"in n))throw new qe({code:-32603,message:"Response has no error or result for request"});if(!f)throw new qe({code:-32603,message:"Nothing ended request"})}push(t){this._middleware.push(t)}handle(t,n){if(n&&typeof n!="function")throw new Error('"callback" must be a function if provided.');return Array.isArray(t)?n?this._handleBatch(t,n):this._handleBatch(t):n?this._handle(t,n):this._promiseHandle(t)}asMiddleware(){return async(t,n,f,d)=>{try{let[h,m,A]=await o._runAllMiddleware(t,n,this._middleware);return m?(await o._runReturnHandlers(A),d(h)):f(async D=>{try{await o._runReturnHandlers(A)}catch(z){return D(z)}return D()})}catch(h){return d(h)}}}async _handleBatch(t,n){try{let f=await Promise.all(t.map(this._promiseHandle.bind(this)));return n?n(null,f):f}catch(f){if(n)return n(f);throw f}}_promiseHandle(t){return new Promise((n,f)=>{this._handle(t,(d,h)=>{d&&h===void 0?f(d):n(h)}).catch(f)})}async _handle(t,n){if(!t||Array.isArray(t)||typeof t!="object"){let m=new qe({code:-32603,message:"request must be plain object"});return n(m,{id:void 0,jsonrpc:"2.0",error:m})}if(typeof t.method!="string"){let m=new qe({code:-32603,message:"method must be string"});return n(m,{id:t.id,jsonrpc:"2.0",error:m})}let f=M({},t),d={id:f.id,jsonrpc:f.jsonrpc},h=null;try{await this._processRequest(f,d)}catch(m){h=m}return h&&(delete d.result,d.error||(typeof h=="object"&&Object.keys(h).includes("stack")===!1&&(h.stack="Stack trace is not available."),ve.error(h),d.error=ur(h,{shouldIncludeStack:!0,fallbackError:eo(h)}))),n(h,d)}async _processRequest(t,n){let[f,d,h]=await o._runAllMiddleware(t,n,this._middleware);if(o._checkForCompletion(t,n,d),await o._runReturnHandlers(h),f)throw f}};function Bs(o){let t=new hr;return o.forEach(n=>{t.push(n)}),t.asMiddleware()}function Hs(o){let t=new ze;return t.sendAsync=async n=>{let f=await o.handle(n);if(f.error){typeof f.error=="object"&&Object.keys(f.error).includes("stack")===!1&&(f.error.stack="Stack trace is not available."),ve.error(f.error);let d=ur(f.error,{fallbackError:eo(f.error),shouldIncludeStack:!0});throw Ye.internal(d)}return f.result},t.send=(n,f)=>{if(typeof f!="function")throw new Error('Must provide callback to "send" method.');o.handle(n,f)},o.on&&o.on("notification",n=>{t.emit("data",null,n)}),t.request=async n=>{let f=M(M({},n),{},{id:Math.random().toString(36).slice(2),jsonrpc:"2.0"});return await t.sendAsync(f)},t}var to=class extends ze{constructor({config:t={},state:n={}}){super(),y(this,"defaultConfig",{}),y(this,"defaultState",{}),y(this,"disabled",!1),y(this,"name","BaseController"),y(this,"initialConfig",void 0),y(this,"initialState",void 0),y(this,"internalConfig",this.defaultConfig),y(this,"internalState",this.defaultState),this.initialState=n,this.initialConfig=t}get config(){return this.internalConfig}get state(){return this.internalState}configure(t,n=!1,f=!0){if(f){this.internalConfig=n?t:Object.assign(this.internalConfig,t);for(let d in this.internalConfig)typeof this.internalConfig[d]<"u"&&(this[d]=this.internalConfig[d])}else for(let d in t)typeof this.internalConfig[d]<"u"&&(this.internalConfig[d]=t[d],this[d]=t[d])}update(t,n=!1){this.internalState=n?M({},t):M(M({},this.internalState),t),this.emit("store",this.internalState)}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}};var Fs=()=>!0,Ks=["newListener","removeListener"],js=o=>!Ks.includes(o);function Ys(o,t){return typeof o.rawListeners<"u"?o.rawListeners(t):o.listeners(t)}function Vs(o,t){let f=(t||{}).eventFilter||Fs;if(typeof f=="string"&&f==="skipInternal"&&(f=js),typeof f!="function")throw new Error("createEventEmitterProxy - Invalid eventFilter");let d=o,h=A=>{if(d===A)return;let D=d;d=A,D.eventNames().filter(f).forEach(fe=>{Ys(D,fe).forEach(ie=>{A.on(fe,ie)})}),D.removeAllListeners()};return new Proxy({},{get:(A,D)=>D==="setTarget"?h:d[D],set:(A,D,z)=>D==="setTarget"?(h=z,!0):(d[D]=z,!0),has:(A,D)=>D[0]==="_"?!1:D in d})}var lr={EIP155:"eip155",SOLANA:"solana",CASPER:"casper",XRPL:"xrpl",OTHER:"other"};var Nn={ETH_SEND_RAW_TRANSACTION:"eth_sendRawTransaction",ETH_SEND_USER_OPERATION:"eth_sendUserOperation",ETH_SPONSOR_USER_OPERATION:"pm_sponsorUserOperation",SEND_TRANSACTION:"solana_sendTransaction"},ro={JRPC_REQUEST_COMPLETED:"JRPC Request Completed",JRPC_REQUEST_FAILED:"JRPC Request Failed"},oo={INTERNAL:"internal",NETWORK:"network"},Cn={"0x65":"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","0x66":"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","0x67":"EtWTRABZaYq6iMfeYKouRu166VU2xqa1"};var Gs=o=>{try{let t=o?.code;return{error_message:o instanceof Error?o.message:o?.message||o?.toString(),error_code:t}}catch{return{error_message:"Unknown error",error_code:void 0}}},no=o=>{try{return new URL(o).hostname}catch{return""}},so=o=>{if(o)return o.chainNamespace===lr.EIP155?`${o.chainNamespace}:${parseInt(o.chainId,16)}`:o.chainNamespace===lr.SOLANA?`${o.chainNamespace}:${Cn[o.chainId]}`:`${o.chainNamespace}:${o.chainId}`};function Ws(o){try{return structuredClone(o)}catch{return JSON.parse(JSON.stringify(o,(t,n)=>typeof n=="bigint"?n.toString():n))}}var Rn=Te(Gt()),io="https://authjs.web3auth.io",$s=async(o,t)=>{let h={payload:o,header:{t:t==="solana"?"sip99":"eip191"},network:t==="solana"?"solana":"ethereum"},m=await tt(`${io}/siww/get`,h);if(!m.success)throw new Error("Failed to authenticate user, Please reach out to Web3Auth Support team");return m.challenge},Js=async(o,t,n,f,d,h,m,A,D)=>{var z;let ie=M({signature:{s:t,t:o==="solana"?"sip99":"eip191"},message:n,issuer:f,audience:A||typeof window<"u"&&((z=window.location)===null||z===void 0?void 0:z.hostname)||"com://reactnative",timeout:d},D||{}),xe=await tt(`${io}/siww/verify`,ie,{headers:{client_id:h,wallet_provider:f,web3auth_network:m}});if(!xe.success)throw Rn.default.error("Failed to authenticate user, ,message verification failed",xe.error),new Error("Failed to authenticate user, ,message verification failed");return xe.token};var zs={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},qs={POPUP:"popup",MODAL:"modal",AUTO_APPROVE:"auto-approve",DEFAULT:"default"};var Qs=["Gateway timeout","ETIMEDOUT","failed to parse response body","Failed to fetch"];function Xs(o){switch(o.status){case 405:throw Ye.methodNotFound();case 418:throw Ye.internal({message:"Request is being rate limited.",data:{cause:o}});case 503:case 504:throw Ye.internal({message:"Gateway timeout. The request took too long to process.This can happen when querying over too wide a block range.",data:{cause:o}})}}function Zs(o){return new Promise(t=>{setTimeout(t,o)})}function ei(o,t){if(o.status!==200)throw Ye.internal({message:`Non-200 status code: '${o.status}'`,data:t});if(t.error){var n;throw Ye.internal({data:t.error,message:(n=t.error)===null||n===void 0?void 0:n.message})}return t.result}function Pn({req:o,rpcTarget:t,originHttpHeaderKey:n}){let f=new URL(t),d={id:o.id,jsonrpc:o.jsonrpc,method:o.method,params:o.params},h=o.origin,m=JSON.stringify(d),A={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:m};return n&&h&&(A.headers[n]=h),{fetchUrl:f.href,fetchParams:A}}function ti({rpcTarget:o,originHttpHeaderKey:t,analytics:n,providerConfig:f}){return Zr(async(d,h,m)=>{let{fetchUrl:A,fetchParams:D}=Pn({req:d,rpcTarget:o,originHttpHeaderKey:t}),z=5,fe=1e3,ie=Date.now(),xe=!Object.values(Nn).includes(d.method),Ae={chain_id:so(f),chain_rpc_target:no(A),method:d.method};for(let we=0;we<z;we++){try{let Ee=await fetch(A,D);Xs(Ee);let Le=await Ee.json(),ye=ei(Ee,Le);h.result=ye,xe||n?.track(ro.JRPC_REQUEST_COMPLETED,M(M({request_type:oo.NETWORK},Ae),{},{duration:Date.now()-ie}));return}catch(Ee){let Le=(Ee.message||Ee).toString();if(!Qs.some(Ot=>Le.includes(Ot)))throw xe||n?.track(ro.JRPC_REQUEST_FAILED,M(M({request_type:oo.NETWORK},Ae),{},{error_code:Ee?.code,error_message:Le,duration:Date.now()-ie})),await Fo(Ee)}await Zs(fe)}})}var lt=class extends sr{constructor(t,n,f){super(n),y(this,"code",void 0),y(this,"message",void 0),y(this,"cause",void 0),this.code=t,this.message=n||"",this.cause=f,Object.defineProperty(this,"name",{value:"Web3AuthError"})}toJSON(){return{name:this.name,code:this.code,message:this.message,cause:this.cause}}toString(){return JSON.stringify(this.toJSON())}},ao=class o extends lt{constructor(t,n,f){super(t,n,f),Object.defineProperty(this,"name",{value:"WalletInitializationError"})}static fromCode(t,n="",f){return new o(t,`${o.messages[t]}, ${n}`,f)}static notFound(t="",n){return o.fromCode(5001,t,n)}static notInstalled(t="",n){return o.fromCode(5002,t,n)}static notReady(t="",n){return o.fromCode(5003,t,n)}static windowBlocked(t="",n){return o.fromCode(5004,t,n)}static windowClosed(t="",n){return o.fromCode(5005,t,n)}static incompatibleChainNameSpace(t="",n){return o.fromCode(5006,t,n)}static duplicateConnectorError(t="",n){return o.fromCode(5007,t,n)}static invalidProviderConfigError(t="",n){return o.fromCode(5008,t,n)}static providerNotReadyError(t="",n){return o.fromCode(5009,t,n)}static rpcConnectionError(t="",n){return o.fromCode(5010,t,n)}static invalidParams(t="",n){return o.fromCode(5011,t,n)}static invalidNetwork(t="",n){return o.fromCode(5013,t,n)}};y(ao,"messages",{5e3:"Custom",5001:"Wallet is not found",5002:"Wallet is not installed",5003:"Wallet is not ready yet",5004:"Wallet window is blocked",5005:"Wallet window has been closed by the user",5006:"Incompatible chain namespace provided",5007:"Connector has already been included",5008:"Invalid provider Config",5009:"Provider is not ready yet",5010:"Failed to connect with rpc url",5011:"Invalid params passed in",5013:"Invalid network provided"});var fo=class o extends lt{constructor(t,n,f){super(t,n,f),Object.defineProperty(this,"name",{value:"WalletLoginError"})}static fromCode(t,n="",f){return new o(t,`${o.messages[t]}. ${n}`,f)}static connectionError(t="",n){return o.fromCode(5111,t,n)}static disconnectionError(t="",n){return o.fromCode(5112,t,n)}static notConnectedError(t="",n){return o.fromCode(5113,t,n)}static popupClosed(t="",n){return o.fromCode(5114,t,n)}static mfaEnabled(t="",n){return o.fromCode(5115,t,n)}static chainConfigNotAdded(t="",n){return o.fromCode(5116,t,n)}static unsupportedOperation(t="",n){return o.fromCode(5117,t,n)}static sfaKeyNotFound(t="",n){return o.fromCode(5118,t,n)}static userNotLoggedIn(t="",n){return o.fromCode(5119,t,n)}};y(fo,"messages",{5e3:"Custom",5111:"Failed to connect with wallet",5112:"Failed to disconnect from wallet",5113:"Wallet is not connected",5114:"Wallet popup has been closed by the user",5115:"User has already enabled mfa, please use the @web3auth/web3auth-web sdk for login with mfa",5116:"Chain config has not been added. Please add the chain config before calling switchChain",5117:"Unsupported operation",5118:"useSFAKey flag is enabled but SFA key is not available",5119:"User not logged in."});var nt=class o extends lt{constructor(t,n,f){super(t,n,f),Object.defineProperty(this,"name",{value:"WalletOperationsError"})}static fromCode(t,n="",f){return new o(t,`${o.messages[t]}, ${n}`,f)}static chainIDNotAllowed(t="",n){return o.fromCode(5201,t,n)}static operationNotAllowed(t="",n){return o.fromCode(5202,t,n)}static chainNamespaceNotAllowed(t="",n){return o.fromCode(5203,t,n)}};y(nt,"messages",{5e3:"Custom",5201:"Provided chainId is not allowed",5202:"This operation is not allowed"});var co=class o extends lt{constructor(t,n,f){super(t,n,f),Object.defineProperty(this,"name",{value:"WalletProviderError"})}static fromCode(t,n="",f){return new nt(t,`${o.messages[t]}, ${n}`,f)}static invalidRequestArgs(t="",n){return nt.fromCode(5301,t,n)}static invalidRequestMethod(t="",n){return nt.fromCode(5302,t,n)}static invalidRequestParams(t="",n){return nt.fromCode(5303,t,n)}};y(co,"messages",{5e3:"Custom",5301:"Expected a single, non-array, object argument.",5302:"'args.method' must be a non-empty string.",5303:"'args.params' must be an object or array if provided."});export{$n as a,zo as b,It as c,ps as d,je as e,Me as f,rr as g,ms as h,Nt as i,fr as j,cr as k,zr as l,Yn as m,ze as n,Ye as o,Ms as p,Ds as q,Zr as r,hr as s,Bs as t,Hs as u,to as v,Vs as w,zs as x,qs as y,lr as z,Gs as A,ti as B,Ws as C,$s as D,Js as E,lt as F,ao as G,fo as H,co as I};
