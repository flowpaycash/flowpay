import{a as Jt,c as ar}from"./chunk-4H2HG446.js";import{a as Wt,b as Kt,c as $t,d as Ct,e as Se,f as qe,g as Ae,h as _t,k as hr,l as Ft,m as Ht,n as lr,o as jt,q as Re}from"./chunk-BA3MPRCF.js";import{c as Hr}from"./chunk-W44JATXS.js";import{a as or,b as sr,d as fr,l as Gt,m as Ee,p as Lt,s as _e}from"./chunk-E62CRSR5.js";import{d as Kr}from"./chunk-BG6P72OF.js";var Ur=Kr((ur,Ie)=>{(function(c,m){"use strict";function d(o,t){if(!o)throw new Error(t||"Assertion failed")}function a(o,t){o.super_=t;var e=function(){};e.prototype=t.prototype,o.prototype=new e,o.prototype.constructor=o}function h(o,t,e){if(h.isBN(o))return o;this.negative=0,this.words=null,this.length=0,this.red=null,o!==null&&((t==="le"||t==="be")&&(e=t,t=10),this._init(o||0,t||10,e||"be"))}typeof c=="object"?c.exports=h:m.BN=h,h.BN=h,h.wordSize=26;var w;try{typeof window<"u"&&typeof window.Buffer<"u"?w=window.Buffer:w=Hr().Buffer}catch{}h.isBN=function(t){return t instanceof h?!0:t!==null&&typeof t=="object"&&t.constructor.wordSize===h.wordSize&&Array.isArray(t.words)},h.max=function(t,e){return t.cmp(e)>0?t:e},h.min=function(t,e){return t.cmp(e)<0?t:e},h.prototype._init=function(t,e,i){if(typeof t=="number")return this._initNumber(t,e,i);if(typeof t=="object")return this._initArray(t,e,i);e==="hex"&&(e=16),d(e===(e|0)&&e>=2&&e<=36),t=t.toString().replace(/\s+/g,"");var n=0;t[0]==="-"&&(n++,this.negative=1),n<t.length&&(e===16?this._parseHex(t,n,i):(this._parseBase(t,e,n),i==="le"&&this._initArray(this.toArray(),e,i)))},h.prototype._initNumber=function(t,e,i){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[t&67108863],this.length=1):t<4503599627370496?(this.words=[t&67108863,t/67108864&67108863],this.length=2):(d(t<9007199254740992),this.words=[t&67108863,t/67108864&67108863,1],this.length=3),i==="le"&&this._initArray(this.toArray(),e,i)},h.prototype._initArray=function(t,e,i){if(d(typeof t.length=="number"),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var f,u,v=0;if(i==="be")for(n=t.length-1,f=0;n>=0;n-=3)u=t[n]|t[n-1]<<8|t[n-2]<<16,this.words[f]|=u<<v&67108863,this.words[f+1]=u>>>26-v&67108863,v+=24,v>=26&&(v-=26,f++);else if(i==="le")for(n=0,f=0;n<t.length;n+=3)u=t[n]|t[n+1]<<8|t[n+2]<<16,this.words[f]|=u<<v&67108863,this.words[f+1]=u>>>26-v&67108863,v+=24,v>=26&&(v-=26,f++);return this._strip()};function g(o,t){var e=o.charCodeAt(t);if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-55;if(e>=97&&e<=102)return e-87;d(!1,"Invalid character in "+o)}function M(o,t,e){var i=g(o,e);return e-1>=t&&(i|=g(o,e-1)<<4),i}h.prototype._parseHex=function(t,e,i){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var f=0,u=0,v;if(i==="be")for(n=t.length-1;n>=e;n-=2)v=M(t,e,n)<<f,this.words[u]|=v&67108863,f>=18?(f-=18,u+=1,this.words[u]|=v>>>26):f+=8;else{var s=t.length-e;for(n=s%2===0?e+1:e;n<t.length;n+=2)v=M(t,e,n)<<f,this.words[u]|=v&67108863,f>=18?(f-=18,u+=1,this.words[u]|=v>>>26):f+=8}this._strip()};function b(o,t,e,i){for(var n=0,f=0,u=Math.min(o.length,e),v=t;v<u;v++){var s=o.charCodeAt(v)-48;n*=i,s>=49?f=s-49+10:s>=17?f=s-17+10:f=s,d(s>=0&&f<i,"Invalid character"),n+=f}return n}h.prototype._parseBase=function(t,e,i){this.words=[0],this.length=1;for(var n=0,f=1;f<=67108863;f*=e)n++;n--,f=f/e|0;for(var u=t.length-i,v=u%n,s=Math.min(u,u-v)+i,r=0,l=i;l<s;l+=n)r=b(t,l,l+n,e),this.imuln(f),this.words[0]+r<67108864?this.words[0]+=r:this._iaddn(r);if(v!==0){var x=1;for(r=b(t,l,t.length,e),l=0;l<v;l++)x*=e;this.imuln(x),this.words[0]+r<67108864?this.words[0]+=r:this._iaddn(r)}this._strip()},h.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red};function _(o,t){o.words=t.words,o.length=t.length,o.negative=t.negative,o.red=t.red}if(h.prototype._move=function(t){_(t,this)},h.prototype.clone=function(){var t=new h(null);return this.copy(t),t},h.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},h.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},h.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{h.prototype[Symbol.for("nodejs.util.inspect.custom")]=q}catch{h.prototype.inspect=q}else h.prototype.inspect=q;function q(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var N=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],p=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],E=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];h.prototype.toString=function(t,e){t=t||10,e=e|0||1;var i;if(t===16||t==="hex"){i="";for(var n=0,f=0,u=0;u<this.length;u++){var v=this.words[u],s=((v<<n|f)&16777215).toString(16);f=v>>>24-n&16777215,n+=2,n>=26&&(n-=26,u--),f!==0||u!==this.length-1?i=N[6-s.length]+s+i:i=s+i}for(f!==0&&(i=f.toString(16)+i);i.length%e!==0;)i="0"+i;return this.negative!==0&&(i="-"+i),i}if(t===(t|0)&&t>=2&&t<=36){var r=p[t],l=E[t];i="";var x=this.clone();for(x.negative=0;!x.isZero();){var y=x.modrn(l).toString(t);x=x.idivn(l),x.isZero()?i=y+i:i=N[r-y.length]+y+i}for(this.isZero()&&(i="0"+i);i.length%e!==0;)i="0"+i;return this.negative!==0&&(i="-"+i),i}d(!1,"Base should be between 2 and 36")},h.prototype.toNumber=function(){var t=this.words[0];return this.length===2?t+=this.words[1]*67108864:this.length===3&&this.words[2]===1?t+=4503599627370496+this.words[1]*67108864:this.length>2&&d(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-t:t},h.prototype.toJSON=function(){return this.toString(16,2)},w&&(h.prototype.toBuffer=function(t,e){return this.toArrayLike(w,t,e)}),h.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)};var R=function(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)};h.prototype.toArrayLike=function(t,e,i){this._strip();var n=this.byteLength(),f=i||Math.max(1,n);d(n<=f,"byte array longer than desired length"),d(f>0,"Requested array length <= 0");var u=R(t,f),v=e==="le"?"LE":"BE";return this["_toArrayLike"+v](u,n),u},h.prototype._toArrayLikeLE=function(t,e){for(var i=0,n=0,f=0,u=0;f<this.length;f++){var v=this.words[f]<<u|n;t[i++]=v&255,i<t.length&&(t[i++]=v>>8&255),i<t.length&&(t[i++]=v>>16&255),u===6?(i<t.length&&(t[i++]=v>>24&255),n=0,u=0):(n=v>>>24,u+=2)}if(i<t.length)for(t[i++]=n;i<t.length;)t[i++]=0},h.prototype._toArrayLikeBE=function(t,e){for(var i=t.length-1,n=0,f=0,u=0;f<this.length;f++){var v=this.words[f]<<u|n;t[i--]=v&255,i>=0&&(t[i--]=v>>8&255),i>=0&&(t[i--]=v>>16&255),u===6?(i>=0&&(t[i--]=v>>24&255),n=0,u=0):(n=v>>>24,u+=2)}if(i>=0)for(t[i--]=n;i>=0;)t[i--]=0},Math.clz32?h.prototype._countBits=function(t){return 32-Math.clz32(t)}:h.prototype._countBits=function(t){var e=t,i=0;return e>=4096&&(i+=13,e>>>=13),e>=64&&(i+=7,e>>>=7),e>=8&&(i+=4,e>>>=4),e>=2&&(i+=2,e>>>=2),i+e},h.prototype._zeroBits=function(t){if(t===0)return 26;var e=t,i=0;return(e&8191)===0&&(i+=13,e>>>=13),(e&127)===0&&(i+=7,e>>>=7),(e&15)===0&&(i+=4,e>>>=4),(e&3)===0&&(i+=2,e>>>=2),(e&1)===0&&i++,i},h.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return(this.length-1)*26+e};function O(o){for(var t=new Array(o.bitLength()),e=0;e<t.length;e++){var i=e/26|0,n=e%26;t[e]=o.words[i]>>>n&1}return t}h.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var i=this._zeroBits(this.words[e]);if(t+=i,i!==26)break}return t},h.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},h.prototype.toTwos=function(t){return this.negative!==0?this.abs().inotn(t).iaddn(1):this.clone()},h.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},h.prototype.isNeg=function(){return this.negative!==0},h.prototype.neg=function(){return this.clone().ineg()},h.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},h.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this._strip()},h.prototype.ior=function(t){return d((this.negative|t.negative)===0),this.iuor(t)},h.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},h.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},h.prototype.iuand=function(t){var e;this.length>t.length?e=t:e=this;for(var i=0;i<e.length;i++)this.words[i]=this.words[i]&t.words[i];return this.length=e.length,this._strip()},h.prototype.iand=function(t){return d((this.negative|t.negative)===0),this.iuand(t)},h.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},h.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},h.prototype.iuxor=function(t){var e,i;this.length>t.length?(e=this,i=t):(e=t,i=this);for(var n=0;n<i.length;n++)this.words[n]=e.words[n]^i.words[n];if(this!==e)for(;n<e.length;n++)this.words[n]=e.words[n];return this.length=e.length,this._strip()},h.prototype.ixor=function(t){return d((this.negative|t.negative)===0),this.iuxor(t)},h.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},h.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},h.prototype.inotn=function(t){d(typeof t=="number"&&t>=0);var e=Math.ceil(t/26)|0,i=t%26;this._expand(e),i>0&&e--;for(var n=0;n<e;n++)this.words[n]=~this.words[n]&67108863;return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this._strip()},h.prototype.notn=function(t){return this.clone().inotn(t)},h.prototype.setn=function(t,e){d(typeof t=="number"&&t>=0);var i=t/26|0,n=t%26;return this._expand(i+1),e?this.words[i]=this.words[i]|1<<n:this.words[i]=this.words[i]&~(1<<n),this._strip()},h.prototype.iadd=function(t){var e;if(this.negative!==0&&t.negative===0)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(this.negative===0&&t.negative!==0)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();var i,n;this.length>t.length?(i=this,n=t):(i=t,n=this);for(var f=0,u=0;u<n.length;u++)e=(i.words[u]|0)+(n.words[u]|0)+f,this.words[u]=e&67108863,f=e>>>26;for(;f!==0&&u<i.length;u++)e=(i.words[u]|0)+f,this.words[u]=e&67108863,f=e>>>26;if(this.length=i.length,f!==0)this.words[this.length]=f,this.length++;else if(i!==this)for(;u<i.length;u++)this.words[u]=i.words[u];return this},h.prototype.add=function(t){var e;return t.negative!==0&&this.negative===0?(t.negative=0,e=this.sub(t),t.negative^=1,e):t.negative===0&&this.negative!==0?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},h.prototype.isub=function(t){if(t.negative!==0){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var i=this.cmp(t);if(i===0)return this.negative=0,this.length=1,this.words[0]=0,this;var n,f;i>0?(n=this,f=t):(n=t,f=this);for(var u=0,v=0;v<f.length;v++)e=(n.words[v]|0)-(f.words[v]|0)+u,u=e>>26,this.words[v]=e&67108863;for(;u!==0&&v<n.length;v++)e=(n.words[v]|0)+u,u=e>>26,this.words[v]=e&67108863;if(u===0&&v<n.length&&n!==this)for(;v<n.length;v++)this.words[v]=n.words[v];return this.length=Math.max(this.length,v),n!==this&&(this.negative=1),this._strip()},h.prototype.sub=function(t){return this.clone().isub(t)};function L(o,t,e){e.negative=t.negative^o.negative;var i=o.length+t.length|0;e.length=i,i=i-1|0;var n=o.words[0]|0,f=t.words[0]|0,u=n*f,v=u&67108863,s=u/67108864|0;e.words[0]=v;for(var r=1;r<i;r++){for(var l=s>>>26,x=s&67108863,y=Math.min(r,t.length-1),B=Math.max(0,r-o.length+1);B<=y;B++){var S=r-B|0;n=o.words[S]|0,f=t.words[B]|0,u=n*f+x,l+=u/67108864|0,x=u&67108863}e.words[r]=x|0,s=l|0}return s!==0?e.words[r]=s|0:e.length--,e._strip()}var V=function(t,e,i){var n=t.words,f=e.words,u=i.words,v=0,s,r,l,x=n[0]|0,y=x&8191,B=x>>>13,S=n[1]|0,I=S&8191,A=S>>>13,U=n[2]|0,k=U&8191,H=U>>>13,Xt=n[3]|0,C=Xt&8191,D=Xt>>>13,De=n[4]|0,Y=De&8191,P=De>>>13,Ye=n[5]|0,X=Ye&8191,G=Ye>>>13,Pe=n[6]|0,W=Pe&8191,$=Pe>>>13,Xe=n[7]|0,j=Xe&8191,Q=Xe>>>13,Ge=n[8]|0,J=Ge&8191,F=Ge>>>13,We=n[9]|0,tt=We&8191,et=We>>>13,$e=f[0]|0,rt=$e&8191,it=$e>>>13,je=f[1]|0,nt=je&8191,ot=je>>>13,Qe=f[2]|0,st=Qe&8191,ft=Qe>>>13,Je=f[3]|0,at=Je&8191,ht=Je>>>13,Fe=f[4]|0,lt=Fe&8191,ut=Fe>>>13,tr=f[5]|0,ct=tr&8191,dt=tr>>>13,er=f[6]|0,mt=er&8191,vt=er>>>13,rr=f[7]|0,gt=rr&8191,pt=rr>>>13,ir=f[8]|0,wt=ir&8191,yt=ir>>>13,nr=f[9]|0,Mt=nr&8191,bt=nr>>>13;i.negative=t.negative^e.negative,i.length=19,s=Math.imul(y,rt),r=Math.imul(y,it),r=r+Math.imul(B,rt)|0,l=Math.imul(B,it);var oe=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(oe>>>26)|0,oe&=67108863,s=Math.imul(I,rt),r=Math.imul(I,it),r=r+Math.imul(A,rt)|0,l=Math.imul(A,it),s=s+Math.imul(y,nt)|0,r=r+Math.imul(y,ot)|0,r=r+Math.imul(B,nt)|0,l=l+Math.imul(B,ot)|0;var se=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(se>>>26)|0,se&=67108863,s=Math.imul(k,rt),r=Math.imul(k,it),r=r+Math.imul(H,rt)|0,l=Math.imul(H,it),s=s+Math.imul(I,nt)|0,r=r+Math.imul(I,ot)|0,r=r+Math.imul(A,nt)|0,l=l+Math.imul(A,ot)|0,s=s+Math.imul(y,st)|0,r=r+Math.imul(y,ft)|0,r=r+Math.imul(B,st)|0,l=l+Math.imul(B,ft)|0;var fe=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(fe>>>26)|0,fe&=67108863,s=Math.imul(C,rt),r=Math.imul(C,it),r=r+Math.imul(D,rt)|0,l=Math.imul(D,it),s=s+Math.imul(k,nt)|0,r=r+Math.imul(k,ot)|0,r=r+Math.imul(H,nt)|0,l=l+Math.imul(H,ot)|0,s=s+Math.imul(I,st)|0,r=r+Math.imul(I,ft)|0,r=r+Math.imul(A,st)|0,l=l+Math.imul(A,ft)|0,s=s+Math.imul(y,at)|0,r=r+Math.imul(y,ht)|0,r=r+Math.imul(B,at)|0,l=l+Math.imul(B,ht)|0;var ae=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(ae>>>26)|0,ae&=67108863,s=Math.imul(Y,rt),r=Math.imul(Y,it),r=r+Math.imul(P,rt)|0,l=Math.imul(P,it),s=s+Math.imul(C,nt)|0,r=r+Math.imul(C,ot)|0,r=r+Math.imul(D,nt)|0,l=l+Math.imul(D,ot)|0,s=s+Math.imul(k,st)|0,r=r+Math.imul(k,ft)|0,r=r+Math.imul(H,st)|0,l=l+Math.imul(H,ft)|0,s=s+Math.imul(I,at)|0,r=r+Math.imul(I,ht)|0,r=r+Math.imul(A,at)|0,l=l+Math.imul(A,ht)|0,s=s+Math.imul(y,lt)|0,r=r+Math.imul(y,ut)|0,r=r+Math.imul(B,lt)|0,l=l+Math.imul(B,ut)|0;var he=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(he>>>26)|0,he&=67108863,s=Math.imul(X,rt),r=Math.imul(X,it),r=r+Math.imul(G,rt)|0,l=Math.imul(G,it),s=s+Math.imul(Y,nt)|0,r=r+Math.imul(Y,ot)|0,r=r+Math.imul(P,nt)|0,l=l+Math.imul(P,ot)|0,s=s+Math.imul(C,st)|0,r=r+Math.imul(C,ft)|0,r=r+Math.imul(D,st)|0,l=l+Math.imul(D,ft)|0,s=s+Math.imul(k,at)|0,r=r+Math.imul(k,ht)|0,r=r+Math.imul(H,at)|0,l=l+Math.imul(H,ht)|0,s=s+Math.imul(I,lt)|0,r=r+Math.imul(I,ut)|0,r=r+Math.imul(A,lt)|0,l=l+Math.imul(A,ut)|0,s=s+Math.imul(y,ct)|0,r=r+Math.imul(y,dt)|0,r=r+Math.imul(B,ct)|0,l=l+Math.imul(B,dt)|0;var le=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(le>>>26)|0,le&=67108863,s=Math.imul(W,rt),r=Math.imul(W,it),r=r+Math.imul($,rt)|0,l=Math.imul($,it),s=s+Math.imul(X,nt)|0,r=r+Math.imul(X,ot)|0,r=r+Math.imul(G,nt)|0,l=l+Math.imul(G,ot)|0,s=s+Math.imul(Y,st)|0,r=r+Math.imul(Y,ft)|0,r=r+Math.imul(P,st)|0,l=l+Math.imul(P,ft)|0,s=s+Math.imul(C,at)|0,r=r+Math.imul(C,ht)|0,r=r+Math.imul(D,at)|0,l=l+Math.imul(D,ht)|0,s=s+Math.imul(k,lt)|0,r=r+Math.imul(k,ut)|0,r=r+Math.imul(H,lt)|0,l=l+Math.imul(H,ut)|0,s=s+Math.imul(I,ct)|0,r=r+Math.imul(I,dt)|0,r=r+Math.imul(A,ct)|0,l=l+Math.imul(A,dt)|0,s=s+Math.imul(y,mt)|0,r=r+Math.imul(y,vt)|0,r=r+Math.imul(B,mt)|0,l=l+Math.imul(B,vt)|0;var ue=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(ue>>>26)|0,ue&=67108863,s=Math.imul(j,rt),r=Math.imul(j,it),r=r+Math.imul(Q,rt)|0,l=Math.imul(Q,it),s=s+Math.imul(W,nt)|0,r=r+Math.imul(W,ot)|0,r=r+Math.imul($,nt)|0,l=l+Math.imul($,ot)|0,s=s+Math.imul(X,st)|0,r=r+Math.imul(X,ft)|0,r=r+Math.imul(G,st)|0,l=l+Math.imul(G,ft)|0,s=s+Math.imul(Y,at)|0,r=r+Math.imul(Y,ht)|0,r=r+Math.imul(P,at)|0,l=l+Math.imul(P,ht)|0,s=s+Math.imul(C,lt)|0,r=r+Math.imul(C,ut)|0,r=r+Math.imul(D,lt)|0,l=l+Math.imul(D,ut)|0,s=s+Math.imul(k,ct)|0,r=r+Math.imul(k,dt)|0,r=r+Math.imul(H,ct)|0,l=l+Math.imul(H,dt)|0,s=s+Math.imul(I,mt)|0,r=r+Math.imul(I,vt)|0,r=r+Math.imul(A,mt)|0,l=l+Math.imul(A,vt)|0,s=s+Math.imul(y,gt)|0,r=r+Math.imul(y,pt)|0,r=r+Math.imul(B,gt)|0,l=l+Math.imul(B,pt)|0;var ce=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(ce>>>26)|0,ce&=67108863,s=Math.imul(J,rt),r=Math.imul(J,it),r=r+Math.imul(F,rt)|0,l=Math.imul(F,it),s=s+Math.imul(j,nt)|0,r=r+Math.imul(j,ot)|0,r=r+Math.imul(Q,nt)|0,l=l+Math.imul(Q,ot)|0,s=s+Math.imul(W,st)|0,r=r+Math.imul(W,ft)|0,r=r+Math.imul($,st)|0,l=l+Math.imul($,ft)|0,s=s+Math.imul(X,at)|0,r=r+Math.imul(X,ht)|0,r=r+Math.imul(G,at)|0,l=l+Math.imul(G,ht)|0,s=s+Math.imul(Y,lt)|0,r=r+Math.imul(Y,ut)|0,r=r+Math.imul(P,lt)|0,l=l+Math.imul(P,ut)|0,s=s+Math.imul(C,ct)|0,r=r+Math.imul(C,dt)|0,r=r+Math.imul(D,ct)|0,l=l+Math.imul(D,dt)|0,s=s+Math.imul(k,mt)|0,r=r+Math.imul(k,vt)|0,r=r+Math.imul(H,mt)|0,l=l+Math.imul(H,vt)|0,s=s+Math.imul(I,gt)|0,r=r+Math.imul(I,pt)|0,r=r+Math.imul(A,gt)|0,l=l+Math.imul(A,pt)|0,s=s+Math.imul(y,wt)|0,r=r+Math.imul(y,yt)|0,r=r+Math.imul(B,wt)|0,l=l+Math.imul(B,yt)|0;var de=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(de>>>26)|0,de&=67108863,s=Math.imul(tt,rt),r=Math.imul(tt,it),r=r+Math.imul(et,rt)|0,l=Math.imul(et,it),s=s+Math.imul(J,nt)|0,r=r+Math.imul(J,ot)|0,r=r+Math.imul(F,nt)|0,l=l+Math.imul(F,ot)|0,s=s+Math.imul(j,st)|0,r=r+Math.imul(j,ft)|0,r=r+Math.imul(Q,st)|0,l=l+Math.imul(Q,ft)|0,s=s+Math.imul(W,at)|0,r=r+Math.imul(W,ht)|0,r=r+Math.imul($,at)|0,l=l+Math.imul($,ht)|0,s=s+Math.imul(X,lt)|0,r=r+Math.imul(X,ut)|0,r=r+Math.imul(G,lt)|0,l=l+Math.imul(G,ut)|0,s=s+Math.imul(Y,ct)|0,r=r+Math.imul(Y,dt)|0,r=r+Math.imul(P,ct)|0,l=l+Math.imul(P,dt)|0,s=s+Math.imul(C,mt)|0,r=r+Math.imul(C,vt)|0,r=r+Math.imul(D,mt)|0,l=l+Math.imul(D,vt)|0,s=s+Math.imul(k,gt)|0,r=r+Math.imul(k,pt)|0,r=r+Math.imul(H,gt)|0,l=l+Math.imul(H,pt)|0,s=s+Math.imul(I,wt)|0,r=r+Math.imul(I,yt)|0,r=r+Math.imul(A,wt)|0,l=l+Math.imul(A,yt)|0,s=s+Math.imul(y,Mt)|0,r=r+Math.imul(y,bt)|0,r=r+Math.imul(B,Mt)|0,l=l+Math.imul(B,bt)|0;var me=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(me>>>26)|0,me&=67108863,s=Math.imul(tt,nt),r=Math.imul(tt,ot),r=r+Math.imul(et,nt)|0,l=Math.imul(et,ot),s=s+Math.imul(J,st)|0,r=r+Math.imul(J,ft)|0,r=r+Math.imul(F,st)|0,l=l+Math.imul(F,ft)|0,s=s+Math.imul(j,at)|0,r=r+Math.imul(j,ht)|0,r=r+Math.imul(Q,at)|0,l=l+Math.imul(Q,ht)|0,s=s+Math.imul(W,lt)|0,r=r+Math.imul(W,ut)|0,r=r+Math.imul($,lt)|0,l=l+Math.imul($,ut)|0,s=s+Math.imul(X,ct)|0,r=r+Math.imul(X,dt)|0,r=r+Math.imul(G,ct)|0,l=l+Math.imul(G,dt)|0,s=s+Math.imul(Y,mt)|0,r=r+Math.imul(Y,vt)|0,r=r+Math.imul(P,mt)|0,l=l+Math.imul(P,vt)|0,s=s+Math.imul(C,gt)|0,r=r+Math.imul(C,pt)|0,r=r+Math.imul(D,gt)|0,l=l+Math.imul(D,pt)|0,s=s+Math.imul(k,wt)|0,r=r+Math.imul(k,yt)|0,r=r+Math.imul(H,wt)|0,l=l+Math.imul(H,yt)|0,s=s+Math.imul(I,Mt)|0,r=r+Math.imul(I,bt)|0,r=r+Math.imul(A,Mt)|0,l=l+Math.imul(A,bt)|0;var ve=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(ve>>>26)|0,ve&=67108863,s=Math.imul(tt,st),r=Math.imul(tt,ft),r=r+Math.imul(et,st)|0,l=Math.imul(et,ft),s=s+Math.imul(J,at)|0,r=r+Math.imul(J,ht)|0,r=r+Math.imul(F,at)|0,l=l+Math.imul(F,ht)|0,s=s+Math.imul(j,lt)|0,r=r+Math.imul(j,ut)|0,r=r+Math.imul(Q,lt)|0,l=l+Math.imul(Q,ut)|0,s=s+Math.imul(W,ct)|0,r=r+Math.imul(W,dt)|0,r=r+Math.imul($,ct)|0,l=l+Math.imul($,dt)|0,s=s+Math.imul(X,mt)|0,r=r+Math.imul(X,vt)|0,r=r+Math.imul(G,mt)|0,l=l+Math.imul(G,vt)|0,s=s+Math.imul(Y,gt)|0,r=r+Math.imul(Y,pt)|0,r=r+Math.imul(P,gt)|0,l=l+Math.imul(P,pt)|0,s=s+Math.imul(C,wt)|0,r=r+Math.imul(C,yt)|0,r=r+Math.imul(D,wt)|0,l=l+Math.imul(D,yt)|0,s=s+Math.imul(k,Mt)|0,r=r+Math.imul(k,bt)|0,r=r+Math.imul(H,Mt)|0,l=l+Math.imul(H,bt)|0;var ge=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(ge>>>26)|0,ge&=67108863,s=Math.imul(tt,at),r=Math.imul(tt,ht),r=r+Math.imul(et,at)|0,l=Math.imul(et,ht),s=s+Math.imul(J,lt)|0,r=r+Math.imul(J,ut)|0,r=r+Math.imul(F,lt)|0,l=l+Math.imul(F,ut)|0,s=s+Math.imul(j,ct)|0,r=r+Math.imul(j,dt)|0,r=r+Math.imul(Q,ct)|0,l=l+Math.imul(Q,dt)|0,s=s+Math.imul(W,mt)|0,r=r+Math.imul(W,vt)|0,r=r+Math.imul($,mt)|0,l=l+Math.imul($,vt)|0,s=s+Math.imul(X,gt)|0,r=r+Math.imul(X,pt)|0,r=r+Math.imul(G,gt)|0,l=l+Math.imul(G,pt)|0,s=s+Math.imul(Y,wt)|0,r=r+Math.imul(Y,yt)|0,r=r+Math.imul(P,wt)|0,l=l+Math.imul(P,yt)|0,s=s+Math.imul(C,Mt)|0,r=r+Math.imul(C,bt)|0,r=r+Math.imul(D,Mt)|0,l=l+Math.imul(D,bt)|0;var pe=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(pe>>>26)|0,pe&=67108863,s=Math.imul(tt,lt),r=Math.imul(tt,ut),r=r+Math.imul(et,lt)|0,l=Math.imul(et,ut),s=s+Math.imul(J,ct)|0,r=r+Math.imul(J,dt)|0,r=r+Math.imul(F,ct)|0,l=l+Math.imul(F,dt)|0,s=s+Math.imul(j,mt)|0,r=r+Math.imul(j,vt)|0,r=r+Math.imul(Q,mt)|0,l=l+Math.imul(Q,vt)|0,s=s+Math.imul(W,gt)|0,r=r+Math.imul(W,pt)|0,r=r+Math.imul($,gt)|0,l=l+Math.imul($,pt)|0,s=s+Math.imul(X,wt)|0,r=r+Math.imul(X,yt)|0,r=r+Math.imul(G,wt)|0,l=l+Math.imul(G,yt)|0,s=s+Math.imul(Y,Mt)|0,r=r+Math.imul(Y,bt)|0,r=r+Math.imul(P,Mt)|0,l=l+Math.imul(P,bt)|0;var we=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(we>>>26)|0,we&=67108863,s=Math.imul(tt,ct),r=Math.imul(tt,dt),r=r+Math.imul(et,ct)|0,l=Math.imul(et,dt),s=s+Math.imul(J,mt)|0,r=r+Math.imul(J,vt)|0,r=r+Math.imul(F,mt)|0,l=l+Math.imul(F,vt)|0,s=s+Math.imul(j,gt)|0,r=r+Math.imul(j,pt)|0,r=r+Math.imul(Q,gt)|0,l=l+Math.imul(Q,pt)|0,s=s+Math.imul(W,wt)|0,r=r+Math.imul(W,yt)|0,r=r+Math.imul($,wt)|0,l=l+Math.imul($,yt)|0,s=s+Math.imul(X,Mt)|0,r=r+Math.imul(X,bt)|0,r=r+Math.imul(G,Mt)|0,l=l+Math.imul(G,bt)|0;var ye=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(ye>>>26)|0,ye&=67108863,s=Math.imul(tt,mt),r=Math.imul(tt,vt),r=r+Math.imul(et,mt)|0,l=Math.imul(et,vt),s=s+Math.imul(J,gt)|0,r=r+Math.imul(J,pt)|0,r=r+Math.imul(F,gt)|0,l=l+Math.imul(F,pt)|0,s=s+Math.imul(j,wt)|0,r=r+Math.imul(j,yt)|0,r=r+Math.imul(Q,wt)|0,l=l+Math.imul(Q,yt)|0,s=s+Math.imul(W,Mt)|0,r=r+Math.imul(W,bt)|0,r=r+Math.imul($,Mt)|0,l=l+Math.imul($,bt)|0;var Me=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(Me>>>26)|0,Me&=67108863,s=Math.imul(tt,gt),r=Math.imul(tt,pt),r=r+Math.imul(et,gt)|0,l=Math.imul(et,pt),s=s+Math.imul(J,wt)|0,r=r+Math.imul(J,yt)|0,r=r+Math.imul(F,wt)|0,l=l+Math.imul(F,yt)|0,s=s+Math.imul(j,Mt)|0,r=r+Math.imul(j,bt)|0,r=r+Math.imul(Q,Mt)|0,l=l+Math.imul(Q,bt)|0;var be=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(be>>>26)|0,be&=67108863,s=Math.imul(tt,wt),r=Math.imul(tt,yt),r=r+Math.imul(et,wt)|0,l=Math.imul(et,yt),s=s+Math.imul(J,Mt)|0,r=r+Math.imul(J,bt)|0,r=r+Math.imul(F,Mt)|0,l=l+Math.imul(F,bt)|0;var xe=(v+s|0)+((r&8191)<<13)|0;v=(l+(r>>>13)|0)+(xe>>>26)|0,xe&=67108863,s=Math.imul(tt,Mt),r=Math.imul(tt,bt),r=r+Math.imul(et,Mt)|0,l=Math.imul(et,bt);var Be=(v+s|0)+((r&8191)<<13)|0;return v=(l+(r>>>13)|0)+(Be>>>26)|0,Be&=67108863,u[0]=oe,u[1]=se,u[2]=fe,u[3]=ae,u[4]=he,u[5]=le,u[6]=ue,u[7]=ce,u[8]=de,u[9]=me,u[10]=ve,u[11]=ge,u[12]=pe,u[13]=we,u[14]=ye,u[15]=Me,u[16]=be,u[17]=xe,u[18]=Be,v!==0&&(u[19]=v,i.length++),i};Math.imul||(V=L);function Tt(o,t,e){e.negative=t.negative^o.negative,e.length=o.length+t.length;for(var i=0,n=0,f=0;f<e.length-1;f++){var u=n;n=0;for(var v=i&67108863,s=Math.min(f,t.length-1),r=Math.max(0,f-o.length+1);r<=s;r++){var l=f-r,x=o.words[l]|0,y=t.words[r]|0,B=x*y,S=B&67108863;u=u+(B/67108864|0)|0,S=S+v|0,v=S&67108863,u=u+(S>>>26)|0,n+=u>>>26,u&=67108863}e.words[f]=v,i=u,u=n}return i!==0?e.words[f]=i:e.length--,e._strip()}function z(o,t,e){return Tt(o,t,e)}h.prototype.mulTo=function(t,e){var i,n=this.length+t.length;return this.length===10&&t.length===10?i=V(this,t,e):n<63?i=L(this,t,e):n<1024?i=Tt(this,t,e):i=z(this,t,e),i};function Bt(o,t){this.x=o,this.y=t}Bt.prototype.makeRBT=function(t){for(var e=new Array(t),i=h.prototype._countBits(t)-1,n=0;n<t;n++)e[n]=this.revBin(n,i,t);return e},Bt.prototype.revBin=function(t,e,i){if(t===0||t===i-1)return t;for(var n=0,f=0;f<e;f++)n|=(t&1)<<e-f-1,t>>=1;return n},Bt.prototype.permute=function(t,e,i,n,f,u){for(var v=0;v<u;v++)n[v]=e[t[v]],f[v]=i[t[v]]},Bt.prototype.transform=function(t,e,i,n,f,u){this.permute(u,t,e,i,n,f);for(var v=1;v<f;v<<=1)for(var s=v<<1,r=Math.cos(2*Math.PI/s),l=Math.sin(2*Math.PI/s),x=0;x<f;x+=s)for(var y=r,B=l,S=0;S<v;S++){var I=i[x+S],A=n[x+S],U=i[x+S+v],k=n[x+S+v],H=y*U-B*k;k=y*k+B*U,U=H,i[x+S]=I+U,n[x+S]=A+k,i[x+S+v]=I-U,n[x+S+v]=A-k,S!==s&&(H=r*y-l*B,B=r*B+l*y,y=H)}},Bt.prototype.guessLen13b=function(t,e){var i=Math.max(e,t)|1,n=i&1,f=0;for(i=i/2|0;i;i=i>>>1)f++;return 1<<f+1+n},Bt.prototype.conjugate=function(t,e,i){if(!(i<=1))for(var n=0;n<i/2;n++){var f=t[n];t[n]=t[i-n-1],t[i-n-1]=f,f=e[n],e[n]=-e[i-n-1],e[i-n-1]=-f}},Bt.prototype.normalize13b=function(t,e){for(var i=0,n=0;n<e/2;n++){var f=Math.round(t[2*n+1]/e)*8192+Math.round(t[2*n]/e)+i;t[n]=f&67108863,f<67108864?i=0:i=f/67108864|0}return t},Bt.prototype.convert13b=function(t,e,i,n){for(var f=0,u=0;u<e;u++)f=f+(t[u]|0),i[2*u]=f&8191,f=f>>>13,i[2*u+1]=f&8191,f=f>>>13;for(u=2*e;u<n;++u)i[u]=0;d(f===0),d((f&-8192)===0)},Bt.prototype.stub=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=0;return e},Bt.prototype.mulp=function(t,e,i){var n=2*this.guessLen13b(t.length,e.length),f=this.makeRBT(n),u=this.stub(n),v=new Array(n),s=new Array(n),r=new Array(n),l=new Array(n),x=new Array(n),y=new Array(n),B=i.words;B.length=n,this.convert13b(t.words,t.length,v,n),this.convert13b(e.words,e.length,l,n),this.transform(v,u,s,r,n,f),this.transform(l,u,x,y,n,f);for(var S=0;S<n;S++){var I=s[S]*x[S]-r[S]*y[S];r[S]=s[S]*y[S]+r[S]*x[S],s[S]=I}return this.conjugate(s,r,n),this.transform(s,r,B,u,n,f),this.conjugate(B,u,n),this.normalize13b(B,n),i.negative=t.negative^e.negative,i.length=t.length+e.length,i._strip()},h.prototype.mul=function(t){var e=new h(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},h.prototype.mulf=function(t){var e=new h(null);return e.words=new Array(this.length+t.length),z(this,t,e)},h.prototype.imul=function(t){return this.clone().mulTo(t,this)},h.prototype.imuln=function(t){var e=t<0;e&&(t=-t),d(typeof t=="number"),d(t<67108864);for(var i=0,n=0;n<this.length;n++){var f=(this.words[n]|0)*t,u=(f&67108863)+(i&67108863);i>>=26,i+=f/67108864|0,i+=u>>>26,this.words[n]=u&67108863}return i!==0&&(this.words[n]=i,this.length++),this.length=t===0?1:this.length,e?this.ineg():this},h.prototype.muln=function(t){return this.clone().imuln(t)},h.prototype.sqr=function(){return this.mul(this)},h.prototype.isqr=function(){return this.imul(this.clone())},h.prototype.pow=function(t){var e=O(t);if(e.length===0)return new h(1);for(var i=this,n=0;n<e.length&&e[n]===0;n++,i=i.sqr());if(++n<e.length)for(var f=i.sqr();n<e.length;n++,f=f.sqr())e[n]!==0&&(i=i.mul(f));return i},h.prototype.iushln=function(t){d(typeof t=="number"&&t>=0);var e=t%26,i=(t-e)/26,n=67108863>>>26-e<<26-e,f;if(e!==0){var u=0;for(f=0;f<this.length;f++){var v=this.words[f]&n,s=(this.words[f]|0)-v<<e;this.words[f]=s|u,u=v>>>26-e}u&&(this.words[f]=u,this.length++)}if(i!==0){for(f=this.length-1;f>=0;f--)this.words[f+i]=this.words[f];for(f=0;f<i;f++)this.words[f]=0;this.length+=i}return this._strip()},h.prototype.ishln=function(t){return d(this.negative===0),this.iushln(t)},h.prototype.iushrn=function(t,e,i){d(typeof t=="number"&&t>=0);var n;e?n=(e-e%26)/26:n=0;var f=t%26,u=Math.min((t-f)/26,this.length),v=67108863^67108863>>>f<<f,s=i;if(n-=u,n=Math.max(0,n),s){for(var r=0;r<u;r++)s.words[r]=this.words[r];s.length=u}if(u!==0)if(this.length>u)for(this.length-=u,r=0;r<this.length;r++)this.words[r]=this.words[r+u];else this.words[0]=0,this.length=1;var l=0;for(r=this.length-1;r>=0&&(l!==0||r>=n);r--){var x=this.words[r]|0;this.words[r]=l<<26-f|x>>>f,l=x&v}return s&&l!==0&&(s.words[s.length++]=l),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},h.prototype.ishrn=function(t,e,i){return d(this.negative===0),this.iushrn(t,e,i)},h.prototype.shln=function(t){return this.clone().ishln(t)},h.prototype.ushln=function(t){return this.clone().iushln(t)},h.prototype.shrn=function(t){return this.clone().ishrn(t)},h.prototype.ushrn=function(t){return this.clone().iushrn(t)},h.prototype.testn=function(t){d(typeof t=="number"&&t>=0);var e=t%26,i=(t-e)/26,n=1<<e;if(this.length<=i)return!1;var f=this.words[i];return!!(f&n)},h.prototype.imaskn=function(t){d(typeof t=="number"&&t>=0);var e=t%26,i=(t-e)/26;if(d(this.negative===0,"imaskn works only with positive numbers"),this.length<=i)return this;if(e!==0&&i++,this.length=Math.min(i,this.length),e!==0){var n=67108863^67108863>>>e<<e;this.words[this.length-1]&=n}return this._strip()},h.prototype.maskn=function(t){return this.clone().imaskn(t)},h.prototype.iaddn=function(t){return d(typeof t=="number"),d(t<67108864),t<0?this.isubn(-t):this.negative!==0?this.length===1&&(this.words[0]|0)<=t?(this.words[0]=t-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},h.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},h.prototype.isubn=function(t){if(d(typeof t=="number"),d(t<67108864),t<0)return this.iaddn(-t);if(this.negative!==0)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this._strip()},h.prototype.addn=function(t){return this.clone().iaddn(t)},h.prototype.subn=function(t){return this.clone().isubn(t)},h.prototype.iabs=function(){return this.negative=0,this},h.prototype.abs=function(){return this.clone().iabs()},h.prototype._ishlnsubmul=function(t,e,i){var n=t.length+i,f;this._expand(n);var u,v=0;for(f=0;f<t.length;f++){u=(this.words[f+i]|0)+v;var s=(t.words[f]|0)*e;u-=s&67108863,v=(u>>26)-(s/67108864|0),this.words[f+i]=u&67108863}for(;f<this.length-i;f++)u=(this.words[f+i]|0)+v,v=u>>26,this.words[f+i]=u&67108863;if(v===0)return this._strip();for(d(v===-1),v=0,f=0;f<this.length;f++)u=-(this.words[f]|0)+v,v=u>>26,this.words[f]=u&67108863;return this.negative=1,this._strip()},h.prototype._wordDiv=function(t,e){var i=this.length-t.length,n=this.clone(),f=t,u=f.words[f.length-1]|0,v=this._countBits(u);i=26-v,i!==0&&(f=f.ushln(i),n.iushln(i),u=f.words[f.length-1]|0);var s=n.length-f.length,r;if(e!=="mod"){r=new h(null),r.length=s+1,r.words=new Array(r.length);for(var l=0;l<r.length;l++)r.words[l]=0}var x=n.clone()._ishlnsubmul(f,1,s);x.negative===0&&(n=x,r&&(r.words[s]=1));for(var y=s-1;y>=0;y--){var B=(n.words[f.length+y]|0)*67108864+(n.words[f.length+y-1]|0);for(B=Math.min(B/u|0,67108863),n._ishlnsubmul(f,B,y);n.negative!==0;)B--,n.negative=0,n._ishlnsubmul(f,1,y),n.isZero()||(n.negative^=1);r&&(r.words[y]=B)}return r&&r._strip(),n._strip(),e!=="div"&&i!==0&&n.iushrn(i),{div:r||null,mod:n}},h.prototype.divmod=function(t,e,i){if(d(!t.isZero()),this.isZero())return{div:new h(0),mod:new h(0)};var n,f,u;return this.negative!==0&&t.negative===0?(u=this.neg().divmod(t,e),e!=="mod"&&(n=u.div.neg()),e!=="div"&&(f=u.mod.neg(),i&&f.negative!==0&&f.iadd(t)),{div:n,mod:f}):this.negative===0&&t.negative!==0?(u=this.divmod(t.neg(),e),e!=="mod"&&(n=u.div.neg()),{div:n,mod:u.mod}):(this.negative&t.negative)!==0?(u=this.neg().divmod(t.neg(),e),e!=="div"&&(f=u.mod.neg(),i&&f.negative!==0&&f.isub(t)),{div:u.div,mod:f}):t.length>this.length||this.cmp(t)<0?{div:new h(0),mod:this}:t.length===1?e==="div"?{div:this.divn(t.words[0]),mod:null}:e==="mod"?{div:null,mod:new h(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new h(this.modrn(t.words[0]))}:this._wordDiv(t,e)},h.prototype.div=function(t){return this.divmod(t,"div",!1).div},h.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},h.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},h.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var i=e.div.negative!==0?e.mod.isub(t):e.mod,n=t.ushrn(1),f=t.andln(1),u=i.cmp(n);return u<0||f===1&&u===0?e.div:e.div.negative!==0?e.div.isubn(1):e.div.iaddn(1)},h.prototype.modrn=function(t){var e=t<0;e&&(t=-t),d(t<=67108863);for(var i=(1<<26)%t,n=0,f=this.length-1;f>=0;f--)n=(i*n+(this.words[f]|0))%t;return e?-n:n},h.prototype.modn=function(t){return this.modrn(t)},h.prototype.idivn=function(t){var e=t<0;e&&(t=-t),d(t<=67108863);for(var i=0,n=this.length-1;n>=0;n--){var f=(this.words[n]|0)+i*67108864;this.words[n]=f/t|0,i=f%t}return this._strip(),e?this.ineg():this},h.prototype.divn=function(t){return this.clone().idivn(t)},h.prototype.egcd=function(t){d(t.negative===0),d(!t.isZero());var e=this,i=t.clone();e.negative!==0?e=e.umod(t):e=e.clone();for(var n=new h(1),f=new h(0),u=new h(0),v=new h(1),s=0;e.isEven()&&i.isEven();)e.iushrn(1),i.iushrn(1),++s;for(var r=i.clone(),l=e.clone();!e.isZero();){for(var x=0,y=1;(e.words[0]&y)===0&&x<26;++x,y<<=1);if(x>0)for(e.iushrn(x);x-- >0;)(n.isOdd()||f.isOdd())&&(n.iadd(r),f.isub(l)),n.iushrn(1),f.iushrn(1);for(var B=0,S=1;(i.words[0]&S)===0&&B<26;++B,S<<=1);if(B>0)for(i.iushrn(B);B-- >0;)(u.isOdd()||v.isOdd())&&(u.iadd(r),v.isub(l)),u.iushrn(1),v.iushrn(1);e.cmp(i)>=0?(e.isub(i),n.isub(u),f.isub(v)):(i.isub(e),u.isub(n),v.isub(f))}return{a:u,b:v,gcd:i.iushln(s)}},h.prototype._invmp=function(t){d(t.negative===0),d(!t.isZero());var e=this,i=t.clone();e.negative!==0?e=e.umod(t):e=e.clone();for(var n=new h(1),f=new h(0),u=i.clone();e.cmpn(1)>0&&i.cmpn(1)>0;){for(var v=0,s=1;(e.words[0]&s)===0&&v<26;++v,s<<=1);if(v>0)for(e.iushrn(v);v-- >0;)n.isOdd()&&n.iadd(u),n.iushrn(1);for(var r=0,l=1;(i.words[0]&l)===0&&r<26;++r,l<<=1);if(r>0)for(i.iushrn(r);r-- >0;)f.isOdd()&&f.iadd(u),f.iushrn(1);e.cmp(i)>=0?(e.isub(i),n.isub(f)):(i.isub(e),f.isub(n))}var x;return e.cmpn(1)===0?x=n:x=f,x.cmpn(0)<0&&x.iadd(t),x},h.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),i=t.clone();e.negative=0,i.negative=0;for(var n=0;e.isEven()&&i.isEven();n++)e.iushrn(1),i.iushrn(1);do{for(;e.isEven();)e.iushrn(1);for(;i.isEven();)i.iushrn(1);var f=e.cmp(i);if(f<0){var u=e;e=i,i=u}else if(f===0||i.cmpn(1)===0)break;e.isub(i)}while(!0);return i.iushln(n)},h.prototype.invm=function(t){return this.egcd(t).a.umod(t)},h.prototype.isEven=function(){return(this.words[0]&1)===0},h.prototype.isOdd=function(){return(this.words[0]&1)===1},h.prototype.andln=function(t){return this.words[0]&t},h.prototype.bincn=function(t){d(typeof t=="number");var e=t%26,i=(t-e)/26,n=1<<e;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var f=n,u=i;f!==0&&u<this.length;u++){var v=this.words[u]|0;v+=f,f=v>>>26,v&=67108863,this.words[u]=v}return f!==0&&(this.words[u]=f,this.length++),this},h.prototype.isZero=function(){return this.length===1&&this.words[0]===0},h.prototype.cmpn=function(t){var e=t<0;if(this.negative!==0&&!e)return-1;if(this.negative===0&&e)return 1;this._strip();var i;if(this.length>1)i=1;else{e&&(t=-t),d(t<=67108863,"Number is too big");var n=this.words[0]|0;i=n===t?0:n<t?-1:1}return this.negative!==0?-i|0:i},h.prototype.cmp=function(t){if(this.negative!==0&&t.negative===0)return-1;if(this.negative===0&&t.negative!==0)return 1;var e=this.ucmp(t);return this.negative!==0?-e|0:e},h.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,i=this.length-1;i>=0;i--){var n=this.words[i]|0,f=t.words[i]|0;if(n!==f){n<f?e=-1:n>f&&(e=1);break}}return e},h.prototype.gtn=function(t){return this.cmpn(t)===1},h.prototype.gt=function(t){return this.cmp(t)===1},h.prototype.gten=function(t){return this.cmpn(t)>=0},h.prototype.gte=function(t){return this.cmp(t)>=0},h.prototype.ltn=function(t){return this.cmpn(t)===-1},h.prototype.lt=function(t){return this.cmp(t)===-1},h.prototype.lten=function(t){return this.cmpn(t)<=0},h.prototype.lte=function(t){return this.cmp(t)<=0},h.prototype.eqn=function(t){return this.cmpn(t)===0},h.prototype.eq=function(t){return this.cmp(t)===0},h.red=function(t){return new K(t)},h.prototype.toRed=function(t){return d(!this.red,"Already a number in reduction context"),d(this.negative===0,"red works only with positives"),t.convertTo(this)._forceRed(t)},h.prototype.fromRed=function(){return d(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},h.prototype._forceRed=function(t){return this.red=t,this},h.prototype.forceRed=function(t){return d(!this.red,"Already a number in reduction context"),this._forceRed(t)},h.prototype.redAdd=function(t){return d(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},h.prototype.redIAdd=function(t){return d(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},h.prototype.redSub=function(t){return d(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},h.prototype.redISub=function(t){return d(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},h.prototype.redShl=function(t){return d(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},h.prototype.redMul=function(t){return d(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},h.prototype.redIMul=function(t){return d(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},h.prototype.redSqr=function(){return d(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},h.prototype.redISqr=function(){return d(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},h.prototype.redSqrt=function(){return d(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},h.prototype.redInvm=function(){return d(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},h.prototype.redNeg=function(){return d(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},h.prototype.redPow=function(t){return d(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var Rt={k256:null,p224:null,p192:null,p25519:null};function xt(o,t){this.name=o,this.p=new h(t,16),this.n=this.p.bitLength(),this.k=new h(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}xt.prototype._tmp=function(){var t=new h(null);return t.words=new Array(Math.ceil(this.n/13)),t},xt.prototype.ireduce=function(t){var e=t,i;do this.split(e,this.tmp),e=this.imulK(e),e=e.iadd(this.tmp),i=e.bitLength();while(i>this.n);var n=i<this.n?-1:e.ucmp(this.p);return n===0?(e.words[0]=0,e.length=1):n>0?e.isub(this.p):e.strip!==void 0?e.strip():e._strip(),e},xt.prototype.split=function(t,e){t.iushrn(this.n,0,e)},xt.prototype.imulK=function(t){return t.imul(this.k)};function It(){xt.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(It,xt),It.prototype.split=function(t,e){for(var i=4194303,n=Math.min(t.length,9),f=0;f<n;f++)e.words[f]=t.words[f];if(e.length=n,t.length<=9){t.words[0]=0,t.length=1;return}var u=t.words[9];for(e.words[e.length++]=u&i,f=10;f<t.length;f++){var v=t.words[f]|0;t.words[f-10]=(v&i)<<4|u>>>22,u=v}u>>>=22,t.words[f-10]=u,u===0&&t.length>10?t.length-=10:t.length-=9},It.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,i=0;i<t.length;i++){var n=t.words[i]|0;e+=n*977,t.words[i]=e&67108863,e=n*64+(e/67108864|0)}return t.words[t.length-1]===0&&(t.length--,t.words[t.length-1]===0&&t.length--),t};function Ot(){xt.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(Ot,xt);function T(){xt.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(T,xt);function kt(){xt.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(kt,xt),kt.prototype.imulK=function(t){for(var e=0,i=0;i<t.length;i++){var n=(t.words[i]|0)*19+e,f=n&67108863;n>>>=26,t.words[i]=f,e=n}return e!==0&&(t.words[t.length++]=e),t},h._prime=function(t){if(Rt[t])return Rt[t];var e;if(t==="k256")e=new It;else if(t==="p224")e=new Ot;else if(t==="p192")e=new T;else if(t==="p25519")e=new kt;else throw new Error("Unknown prime "+t);return Rt[t]=e,e};function K(o){if(typeof o=="string"){var t=h._prime(o);this.m=t.p,this.prime=t}else d(o.gtn(1),"modulus must be greater than 1"),this.m=o,this.prime=null}K.prototype._verify1=function(t){d(t.negative===0,"red works only with positives"),d(t.red,"red works only with red numbers")},K.prototype._verify2=function(t,e){d((t.negative|e.negative)===0,"red works only with positives"),d(t.red&&t.red===e.red,"red works only with red numbers")},K.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):(_(t,t.umod(this.m)._forceRed(this)),t)},K.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},K.prototype.add=function(t,e){this._verify2(t,e);var i=t.add(e);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},K.prototype.iadd=function(t,e){this._verify2(t,e);var i=t.iadd(e);return i.cmp(this.m)>=0&&i.isub(this.m),i},K.prototype.sub=function(t,e){this._verify2(t,e);var i=t.sub(e);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},K.prototype.isub=function(t,e){this._verify2(t,e);var i=t.isub(e);return i.cmpn(0)<0&&i.iadd(this.m),i},K.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},K.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},K.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},K.prototype.isqr=function(t){return this.imul(t,t.clone())},K.prototype.sqr=function(t){return this.mul(t,t)},K.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(d(e%2===1),e===3){var i=this.m.add(new h(1)).iushrn(2);return this.pow(t,i)}for(var n=this.m.subn(1),f=0;!n.isZero()&&n.andln(1)===0;)f++,n.iushrn(1);d(!n.isZero());var u=new h(1).toRed(this),v=u.redNeg(),s=this.m.subn(1).iushrn(1),r=this.m.bitLength();for(r=new h(2*r*r).toRed(this);this.pow(r,s).cmp(v)!==0;)r.redIAdd(v);for(var l=this.pow(r,n),x=this.pow(t,n.addn(1).iushrn(1)),y=this.pow(t,n),B=f;y.cmp(u)!==0;){for(var S=y,I=0;S.cmp(u)!==0;I++)S=S.redSqr();d(I<B);var A=this.pow(l,new h(1).iushln(B-I-1));x=x.redMul(A),l=A.redSqr(),y=y.redMul(l),B=I}return x},K.prototype.invm=function(t){var e=t._invmp(this.m);return e.negative!==0?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},K.prototype.pow=function(t,e){if(e.isZero())return new h(1).toRed(this);if(e.cmpn(1)===0)return t.clone();var i=4,n=new Array(1<<i);n[0]=new h(1).toRed(this),n[1]=t;for(var f=2;f<n.length;f++)n[f]=this.mul(n[f-1],t);var u=n[0],v=0,s=0,r=e.bitLength()%26;for(r===0&&(r=26),f=e.length-1;f>=0;f--){for(var l=e.words[f],x=r-1;x>=0;x--){var y=l>>x&1;if(u!==n[0]&&(u=this.sqr(u)),y===0&&v===0){s=0;continue}v<<=1,v|=y,s++,!(s!==i&&(f!==0||x!==0))&&(u=this.mul(u,n[v]),s=0,v=0)}r=26}return u},K.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},K.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},h.mont=function(t){return new Z(t)};function Z(o){K.call(this,o),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new h(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(Z,K),Z.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},Z.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},Z.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var i=t.imul(e),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),f=i.isub(n).iushrn(this.shift),u=f;return f.cmp(this.m)>=0?u=f.isub(this.m):f.cmpn(0)<0&&(u=f.iadd(this.m)),u._forceRed(this)},Z.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new h(0)._forceRed(this);var i=t.mul(e),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),f=i.isub(n).iushrn(this.shift),u=f;return f.cmp(this.m)>=0?u=f.isub(this.m):f.cmpn(0)<0&&(u=f.iadd(this.m)),u._forceRed(this)},Z.prototype.invm=function(t){var e=this.imod(t._invmp(this.m).mul(this.r2));return e._forceRed(this)}})(typeof Ie>"u"||Ie,ur)});var hi=Jt;var St=BigInt(0),Et=BigInt(1),Vt=BigInt(2),mr=BigInt(3),vr=BigInt(4),gr=BigInt(5),Vr=BigInt(7),pr=BigInt(8),zr=BigInt(9),wr=BigInt(16);function qt(c,m){let d=c%m;return d>=St?d:m+d}function At(c,m,d){let a=c;for(;m-- >St;)a*=a,a%=d;return a}function cr(c,m){if(c===St)throw new Error("invert: expected non-zero number");if(m<=St)throw new Error("invert: expected positive modulus, got "+m);let d=qt(c,m),a=m,h=St,w=Et,g=Et,M=St;for(;d!==St;){let _=a/d,q=a%d,N=h-g*_,p=w-M*_;a=d,d=q,h=g,w=M,g=N,M=p}if(a!==Et)throw new Error("invert: does not exist");return qt(h,m)}function Oe(c,m,d){if(!c.eql(c.sqr(m),d))throw new Error("Cannot find square root")}function yr(c,m){let d=(c.ORDER+Et)/vr,a=c.pow(m,d);return Oe(c,a,m),a}function Cr(c,m){let d=(c.ORDER-gr)/pr,a=c.mul(m,Vt),h=c.pow(a,d),w=c.mul(m,h),g=c.mul(c.mul(w,Vt),h),M=c.mul(w,c.sub(g,c.ONE));return Oe(c,M,m),M}function Dr(c){let m=Ut(c),d=Mr(c),a=d(m,m.neg(m.ONE)),h=d(m,a),w=d(m,m.neg(a)),g=(c+Vr)/wr;return(M,b)=>{let _=M.pow(b,g),q=M.mul(_,a),N=M.mul(_,h),p=M.mul(_,w),E=M.eql(M.sqr(q),b),R=M.eql(M.sqr(N),b);_=M.cmov(_,q,E),q=M.cmov(p,N,R);let O=M.eql(M.sqr(q),b),L=M.cmov(_,q,O);return Oe(M,L,b),L}}function Mr(c){if(c<mr)throw new Error("sqrt is not defined for small field");let m=c-Et,d=0;for(;m%Vt===St;)m/=Vt,d++;let a=Vt,h=Ut(c);for(;dr(h,a)===1;)if(a++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(d===1)return yr;let w=h.pow(a,m),g=(m+Et)/Vt;return function(b,_){if(b.is0(_))return _;if(dr(b,_)!==1)throw new Error("Cannot find square root");let q=d,N=b.mul(b.ONE,w),p=b.pow(_,m),E=b.pow(_,g);for(;!b.eql(p,b.ONE);){if(b.is0(p))return b.ZERO;let R=1,O=b.sqr(p);for(;!b.eql(O,b.ONE);)if(R++,O=b.sqr(O),R===q)throw new Error("Cannot find square root");let L=Et<<BigInt(q-R-1),V=b.pow(N,L);q=R,N=b.sqr(V),p=b.mul(p,N),E=b.mul(E,V)}return E}}function Yr(c){return c%vr===mr?yr:c%pr===gr?Cr:c%wr===zr?Dr(c):Mr(c)}var ci=(c,m)=>(qt(c,m)&Et)===Et,Pr=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ne(c){let m={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},d=Pr.reduce((a,h)=>(a[h]="function",a),m);return jt(c,d),c}function Xr(c,m,d){if(d<St)throw new Error("invalid exponent, negatives unsupported");if(d===St)return c.ONE;if(d===Et)return m;let a=c.ONE,h=m;for(;d>St;)d&Et&&(a=c.mul(a,h)),h=c.sqr(h),d>>=Et;return a}function te(c,m,d=!1){let a=new Array(m.length).fill(d?c.ZERO:void 0),h=m.reduce((g,M,b)=>c.is0(M)?g:(a[b]=g,c.mul(g,M)),c.ONE),w=c.inv(h);return m.reduceRight((g,M,b)=>c.is0(M)?g:(a[b]=c.mul(g,a[b]),c.mul(g,M)),w),a}function dr(c,m){let d=(c.ORDER-Et)/Vt,a=c.pow(m,d),h=c.eql(a,c.ONE),w=c.eql(a,c.ZERO),g=c.eql(a,c.neg(c.ONE));if(!h&&!w&&!g)throw new Error("invalid Legendre symbol result");return h?1:w?0:-1}function ee(c,m){m!==void 0&&sr(m);let d=m!==void 0?m:c.toString(2).length,a=Math.ceil(d/8);return{nBitLength:d,nByteLength:a}}function Ut(c,m,d=!1,a={}){if(c<=St)throw new Error("invalid field: expected ORDER > 0, got "+c);let h,w,g=!1,M;if(typeof m=="object"&&m!=null){if(a.sqrt||d)throw new Error("cannot specify opts in two arguments");let p=m;p.BITS&&(h=p.BITS),p.sqrt&&(w=p.sqrt),typeof p.isLE=="boolean"&&(d=p.isLE),typeof p.modFromBytes=="boolean"&&(g=p.modFromBytes),M=p.allowedLengths}else typeof m=="number"&&(h=m),a.sqrt&&(w=a.sqrt);let{nBitLength:b,nByteLength:_}=ee(c,h);if(_>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let q,N=Object.freeze({ORDER:c,isLE:d,BITS:b,BYTES:_,MASK:Ht(b),ZERO:St,ONE:Et,allowedLengths:M,create:p=>qt(p,c),isValid:p=>{if(typeof p!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof p);return St<=p&&p<c},is0:p=>p===St,isValidNot0:p=>!N.is0(p)&&N.isValid(p),isOdd:p=>(p&Et)===Et,neg:p=>qt(-p,c),eql:(p,E)=>p===E,sqr:p=>qt(p*p,c),add:(p,E)=>qt(p+E,c),sub:(p,E)=>qt(p-E,c),mul:(p,E)=>qt(p*E,c),pow:(p,E)=>Xr(N,p,E),div:(p,E)=>qt(p*cr(E,c),c),sqrN:p=>p*p,addN:(p,E)=>p+E,subN:(p,E)=>p-E,mulN:(p,E)=>p*E,inv:p=>cr(p,c),sqrt:w||(p=>(q||(q=Yr(c)),q(N,p))),toBytes:p=>d?Ae(p,_):qe(p,_),fromBytes:(p,E=!0)=>{if(M){if(!M.includes(p.length)||p.length>_)throw new Error("Field.fromBytes: expected "+M+" bytes, got "+p.length);let O=new Uint8Array(_);O.set(p,d?0:O.length-p.length),p=O}if(p.length!==_)throw new Error("Field.fromBytes: expected "+_+" bytes, got "+p.length);let R=d?Se(p):Ct(p);if(g&&(R=qt(R,c)),!E&&!N.isValid(R))throw new Error("invalid field element: outside of range 0..ORDER");return R},invertBatch:p=>te(N,p),cmov:(p,E,R)=>R?E:p});return Object.freeze(N)}function br(c){if(typeof c!="bigint")throw new Error("field order must be bigint");let m=c.toString(2).length;return Math.ceil(m/8)}function Ze(c){let m=br(c);return m+Math.ceil(m/2)}function Te(c,m,d=!1){let a=c.length,h=br(m),w=Ze(m);if(a<16||a<w||a>1024)throw new Error("expected "+w+"-1024 bytes of input, got "+a);let g=d?Se(c):Ct(c),M=qt(g,m-Et)+Et;return d?Ae(M,h):qe(M,h)}var Dt=BigInt(0),zt=BigInt(1);function Qt(c,m){let d=m.negate();return c?d:m}function ie(c,m){let d=te(c.Fp,m.map(a=>a.Z));return m.map((a,h)=>c.fromAffine(a.toAffine(d[h])))}function _r(c,m){if(!Number.isSafeInteger(c)||c<=0||c>m)throw new Error("invalid window size, expected [1.."+m+"], got W="+c)}function ke(c,m){_r(c,m);let d=Math.ceil(m/c)+1,a=2**(c-1),h=2**c,w=Ht(c),g=BigInt(c);return{windows:d,windowSize:a,mask:w,maxNumber:h,shiftBy:g}}function xr(c,m,d){let{windowSize:a,mask:h,maxNumber:w,shiftBy:g}=d,M=Number(c&h),b=c>>g;M>a&&(M-=w,b+=zt);let _=m*a,q=_+Math.abs(M)-1,N=M===0,p=M<0,E=m%2!==0;return{nextN:b,offset:q,isZero:N,isNeg:p,isNegF:E,offsetF:_}}function Gr(c,m){if(!Array.isArray(c))throw new Error("array expected");c.forEach((d,a)=>{if(!(d instanceof m))throw new Error("invalid point at index "+a)})}function Wr(c,m){if(!Array.isArray(c))throw new Error("array of scalars expected");c.forEach((d,a)=>{if(!m.isValid(d))throw new Error("invalid scalar at index "+a)})}var Le=new WeakMap,Sr=new WeakMap;function Ke(c){return Sr.get(c)||1}function Br(c){if(c!==Dt)throw new Error("invalid wNAF")}var re=class{constructor(m,d){this.BASE=m.BASE,this.ZERO=m.ZERO,this.Fn=m.Fn,this.bits=d}_unsafeLadder(m,d,a=this.ZERO){let h=m;for(;d>Dt;)d&zt&&(a=a.add(h)),h=h.double(),d>>=zt;return a}precomputeWindow(m,d){let{windows:a,windowSize:h}=ke(d,this.bits),w=[],g=m,M=g;for(let b=0;b<a;b++){M=g,w.push(M);for(let _=1;_<h;_++)M=M.add(g),w.push(M);g=M.double()}return w}wNAF(m,d,a){if(!this.Fn.isValid(a))throw new Error("invalid scalar");let h=this.ZERO,w=this.BASE,g=ke(m,this.bits);for(let M=0;M<g.windows;M++){let{nextN:b,offset:_,isZero:q,isNeg:N,isNegF:p,offsetF:E}=xr(a,M,g);a=b,q?w=w.add(Qt(p,d[E])):h=h.add(Qt(N,d[_]))}return Br(a),{p:h,f:w}}wNAFUnsafe(m,d,a,h=this.ZERO){let w=ke(m,this.bits);for(let g=0;g<w.windows&&a!==Dt;g++){let{nextN:M,offset:b,isZero:_,isNeg:q}=xr(a,g,w);if(a=M,!_){let N=d[b];h=h.add(q?N.negate():N)}}return Br(a),h}getPrecomputes(m,d,a){let h=Le.get(d);return h||(h=this.precomputeWindow(d,m),m!==1&&(typeof a=="function"&&(h=a(h)),Le.set(d,h))),h}cached(m,d,a){let h=Ke(m);return this.wNAF(h,this.getPrecomputes(h,m,a),d)}unsafe(m,d,a,h){let w=Ke(m);return w===1?this._unsafeLadder(m,d,h):this.wNAFUnsafe(w,this.getPrecomputes(w,m,a),d,h)}createCache(m,d){_r(d,this.bits),Sr.set(m,d),Le.delete(m)}hasCache(m){return Ke(m)!==1}};function qr(c,m,d,a){let h=m,w=c.ZERO,g=c.ZERO;for(;d>Dt||a>Dt;)d&zt&&(w=w.add(h)),a&zt&&(g=g.add(h)),h=h.double(),d>>=zt,a>>=zt;return{p1:w,p2:g}}function Ar(c,m,d,a){Gr(d,c),Wr(a,m);let h=d.length,w=a.length;if(h!==w)throw new Error("arrays of points and scalars must have equal length");let g=c.ZERO,M=Ft(BigInt(h)),b=1;M>12?b=M-3:M>4?b=M-2:M>0&&(b=2);let _=Ht(b),q=new Array(Number(_)+1).fill(g),N=Math.floor((m.BITS-1)/b)*b,p=g;for(let E=N;E>=0;E-=b){q.fill(g);for(let O=0;O<w;O++){let L=a[O],V=Number(L>>BigInt(E)&_);q[V]=q[V].add(d[O])}let R=g;for(let O=q.length-1,L=g;O>0;O--)L=L.add(q[O]),R=R.add(L);if(p=p.add(R),E!==0)for(let O=0;O<b;O++)p=p.double()}return p}function Er(c,m,d){if(m){if(m.ORDER!==c)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Ne(m),m}else return Ut(c,{isLE:d})}function Rr(c,m,d={},a){if(a===void 0&&(a=c==="edwards"),!m||typeof m!="object")throw new Error(`expected valid ${c} CURVE object`);for(let b of["p","n","h"]){let _=m[b];if(!(typeof _=="bigint"&&_>Dt))throw new Error(`CURVE.${b} must be positive bigint`)}let h=Er(m.p,d.Fp,a),w=Er(m.n,d.Fn,a),M=["Gx","Gy","a",c==="weierstrass"?"b":"d"];for(let b of M)if(!h.isValid(m[b]))throw new Error(`CURVE.${b} must be valid field element of CURVE.Fp`);return m=Object.freeze(Object.assign({},m)),{CURVE:m,Fp:h,Fn:w}}var Ir=(c,m)=>(c+(c>=0?m:-m)/Or)/m;function $r(c,m,d){let[[a,h],[w,g]]=m,M=Ir(g*c,d),b=Ir(-h*c,d),_=c-M*a-b*w,q=-M*h-b*g,N=_<Zt,p=q<Zt;N&&(_=-_),p&&(q=-q);let E=Ht(Math.ceil(Ft(d)/2))+Pt;if(_<Zt||_>=E||q<Zt||q>=E)throw new Error("splitScalar (endomorphism): failed, k="+c);return{k1neg:N,k1:_,k2neg:p,k2:q}}function Ue(c){if(!["compact","recovered","der"].includes(c))throw new Error('Signature format must be "compact", "recovered", or "der"');return c}function He(c,m){let d={};for(let a of Object.keys(m))d[a]=c[a]===void 0?m[a]:c[a];return Wt(d.lowS,"lowS"),Wt(d.prehash,"prehash"),d.format!==void 0&&Ue(d.format),d}var Ve=class extends Error{constructor(m=""){super(m)}},Nt={Err:Ve,_tlv:{encode:(c,m)=>{let{Err:d}=Nt;if(c<0||c>256)throw new d("tlv.encode: wrong tag");if(m.length&1)throw new d("tlv.encode: unpadded data");let a=m.length/2,h=$t(a);if(h.length/2&128)throw new d("tlv.encode: long form length too big");let w=a>127?$t(h.length/2|128):"";return $t(c)+w+h+m},decode(c,m){let{Err:d}=Nt,a=0;if(c<0||c>256)throw new d("tlv.encode: wrong tag");if(m.length<2||m[a++]!==c)throw new d("tlv.decode: wrong tlv");let h=m[a++],w=!!(h&128),g=0;if(!w)g=h;else{let b=h&127;if(!b)throw new d("tlv.decode(long): indefinite length not supported");if(b>4)throw new d("tlv.decode(long): byte length is too big");let _=m.subarray(a,a+b);if(_.length!==b)throw new d("tlv.decode: length bytes not complete");if(_[0]===0)throw new d("tlv.decode(long): zero leftmost byte");for(let q of _)g=g<<8|q;if(a+=b,g<128)throw new d("tlv.decode(long): not minimal encoding")}let M=m.subarray(a,a+g);if(M.length!==g)throw new d("tlv.decode: wrong value length");return{v:M,l:m.subarray(a+g)}}},_int:{encode(c){let{Err:m}=Nt;if(c<Zt)throw new m("integer: negative integers are not allowed");let d=$t(c);if(Number.parseInt(d[0],16)&8&&(d="00"+d),d.length&1)throw new m("unexpected DER parsing assertion: unpadded hex");return d},decode(c){let{Err:m}=Nt;if(c[0]&128)throw new m("invalid signature integer: negative");if(c[0]===0&&!(c[1]&128))throw new m("invalid signature integer: unnecessary leading zero");return Ct(c)}},toSig(c){let{Err:m,_int:d,_tlv:a}=Nt,h=_t("signature",c),{v:w,l:g}=a.decode(48,h);if(g.length)throw new m("invalid signature: left bytes after parsing");let{v:M,l:b}=a.decode(2,w),{v:_,l:q}=a.decode(2,b);if(q.length)throw new m("invalid signature: left bytes after parsing");return{r:d.decode(M),s:d.decode(_)}},hexFromSig(c){let{_tlv:m,_int:d}=Nt,a=m.encode(2,d.encode(c.r)),h=m.encode(2,d.encode(c.s)),w=a+h;return m.encode(48,w)}},Zt=BigInt(0),Pt=BigInt(1),Or=BigInt(2),ne=BigInt(3),jr=BigInt(4);function Yt(c,m){let{BYTES:d}=c,a;if(typeof m=="bigint")a=m;else{let h=_t("private key",m);try{a=c.fromBytes(h)}catch{throw new Error(`invalid private key: expected ui8a of size ${d}, got ${typeof m}`)}}if(!c.isValidNot0(a))throw new Error("invalid private key: out of range [1..N-1]");return a}function Qr(c,m={}){let d=Rr("weierstrass",c,m),{Fp:a,Fn:h}=d,w=d.CURVE,{h:g,n:M}=w;jt(m,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:b}=m;if(b&&(!a.is0(w.a)||typeof b.beta!="bigint"||!Array.isArray(b.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let _=Zr(a,h);function q(){if(!a.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function N(Z,o,t){let{x:e,y:i}=o.toAffine(),n=a.toBytes(e);if(Wt(t,"isCompressed"),t){q();let f=!a.isOdd(i);return Lt(Nr(f),n)}else return Lt(Uint8Array.of(4),n,a.toBytes(i))}function p(Z){Kt(Z,void 0,"Point");let{publicKey:o,publicKeyUncompressed:t}=_,e=Z.length,i=Z[0],n=Z.subarray(1);if(e===o&&(i===2||i===3)){let f=a.fromBytes(n);if(!a.isValid(f))throw new Error("bad point: is not on curve, wrong x");let u=O(f),v;try{v=a.sqrt(u)}catch(l){let x=l instanceof Error?": "+l.message:"";throw new Error("bad point: is not on curve, sqrt error"+x)}q();let s=a.isOdd(v);return(i&1)===1!==s&&(v=a.neg(v)),{x:f,y:v}}else if(e===t&&i===4){let f=a.BYTES,u=a.fromBytes(n.subarray(0,f)),v=a.fromBytes(n.subarray(f,f*2));if(!L(u,v))throw new Error("bad point: is not on curve");return{x:u,y:v}}else throw new Error(`bad point: got length ${e}, expected compressed=${o} or uncompressed=${t}`)}let E=m.toBytes||N,R=m.fromBytes||p;function O(Z){let o=a.sqr(Z),t=a.mul(o,Z);return a.add(a.add(t,a.mul(Z,w.a)),w.b)}function L(Z,o){let t=a.sqr(o),e=O(Z);return a.eql(t,e)}if(!L(w.Gx,w.Gy))throw new Error("bad curve params: generator point");let V=a.mul(a.pow(w.a,ne),jr),Tt=a.mul(a.sqr(w.b),BigInt(27));if(a.is0(a.add(V,Tt)))throw new Error("bad curve params: a or b");function z(Z,o,t=!1){if(!a.isValid(o)||t&&a.is0(o))throw new Error(`bad point coordinate ${Z}`);return o}function Bt(Z){if(!(Z instanceof T))throw new Error("ProjectivePoint expected")}function Rt(Z){if(!b||!b.basises)throw new Error("no endo");return $r(Z,b.basises,h.ORDER)}let xt=Re((Z,o)=>{let{X:t,Y:e,Z:i}=Z;if(a.eql(i,a.ONE))return{x:t,y:e};let n=Z.is0();o==null&&(o=n?a.ONE:a.inv(i));let f=a.mul(t,o),u=a.mul(e,o),v=a.mul(i,o);if(n)return{x:a.ZERO,y:a.ZERO};if(!a.eql(v,a.ONE))throw new Error("invZ was invalid");return{x:f,y:u}}),It=Re(Z=>{if(Z.is0()){if(m.allowInfinityPoint&&!a.is0(Z.Y))return;throw new Error("bad point: ZERO")}let{x:o,y:t}=Z.toAffine();if(!a.isValid(o)||!a.isValid(t))throw new Error("bad point: x or y not field elements");if(!L(o,t))throw new Error("bad point: equation left != right");if(!Z.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function Ot(Z,o,t,e,i){return t=new T(a.mul(t.X,Z),t.Y,t.Z),o=Qt(e,o),t=Qt(i,t),o.add(t)}class T{constructor(o,t,e){this.X=z("x",o),this.Y=z("y",t,!0),this.Z=z("z",e),Object.freeze(this)}static CURVE(){return w}static fromAffine(o){let{x:t,y:e}=o||{};if(!o||!a.isValid(t)||!a.isValid(e))throw new Error("invalid affine point");if(o instanceof T)throw new Error("projective point not allowed");return a.is0(t)&&a.is0(e)?T.ZERO:new T(t,e,a.ONE)}static fromBytes(o){let t=T.fromAffine(R(Kt(o,void 0,"point")));return t.assertValidity(),t}static fromHex(o){return T.fromBytes(_t("pointHex",o))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(o=8,t=!0){return K.createCache(this,o),t||this.multiply(ne),this}assertValidity(){It(this)}hasEvenY(){let{y:o}=this.toAffine();if(!a.isOdd)throw new Error("Field doesn't support isOdd");return!a.isOdd(o)}equals(o){Bt(o);let{X:t,Y:e,Z:i}=this,{X:n,Y:f,Z:u}=o,v=a.eql(a.mul(t,u),a.mul(n,i)),s=a.eql(a.mul(e,u),a.mul(f,i));return v&&s}negate(){return new T(this.X,a.neg(this.Y),this.Z)}double(){let{a:o,b:t}=w,e=a.mul(t,ne),{X:i,Y:n,Z:f}=this,u=a.ZERO,v=a.ZERO,s=a.ZERO,r=a.mul(i,i),l=a.mul(n,n),x=a.mul(f,f),y=a.mul(i,n);return y=a.add(y,y),s=a.mul(i,f),s=a.add(s,s),u=a.mul(o,s),v=a.mul(e,x),v=a.add(u,v),u=a.sub(l,v),v=a.add(l,v),v=a.mul(u,v),u=a.mul(y,u),s=a.mul(e,s),x=a.mul(o,x),y=a.sub(r,x),y=a.mul(o,y),y=a.add(y,s),s=a.add(r,r),r=a.add(s,r),r=a.add(r,x),r=a.mul(r,y),v=a.add(v,r),x=a.mul(n,f),x=a.add(x,x),r=a.mul(x,y),u=a.sub(u,r),s=a.mul(x,l),s=a.add(s,s),s=a.add(s,s),new T(u,v,s)}add(o){Bt(o);let{X:t,Y:e,Z:i}=this,{X:n,Y:f,Z:u}=o,v=a.ZERO,s=a.ZERO,r=a.ZERO,l=w.a,x=a.mul(w.b,ne),y=a.mul(t,n),B=a.mul(e,f),S=a.mul(i,u),I=a.add(t,e),A=a.add(n,f);I=a.mul(I,A),A=a.add(y,B),I=a.sub(I,A),A=a.add(t,i);let U=a.add(n,u);return A=a.mul(A,U),U=a.add(y,S),A=a.sub(A,U),U=a.add(e,i),v=a.add(f,u),U=a.mul(U,v),v=a.add(B,S),U=a.sub(U,v),r=a.mul(l,A),v=a.mul(x,S),r=a.add(v,r),v=a.sub(B,r),r=a.add(B,r),s=a.mul(v,r),B=a.add(y,y),B=a.add(B,y),S=a.mul(l,S),A=a.mul(x,A),B=a.add(B,S),S=a.sub(y,S),S=a.mul(l,S),A=a.add(A,S),y=a.mul(B,A),s=a.add(s,y),y=a.mul(U,A),v=a.mul(I,v),v=a.sub(v,y),y=a.mul(I,B),r=a.mul(U,r),r=a.add(r,y),new T(v,s,r)}subtract(o){return this.add(o.negate())}is0(){return this.equals(T.ZERO)}multiply(o){let{endo:t}=m;if(!h.isValidNot0(o))throw new Error("invalid scalar: out of range");let e,i,n=f=>K.cached(this,f,u=>ie(T,u));if(t){let{k1neg:f,k1:u,k2neg:v,k2:s}=Rt(o),{p:r,f:l}=n(u),{p:x,f:y}=n(s);i=l.add(y),e=Ot(t.beta,r,x,f,v)}else{let{p:f,f:u}=n(o);e=f,i=u}return ie(T,[e,i])[0]}multiplyUnsafe(o){let{endo:t}=m,e=this;if(!h.isValid(o))throw new Error("invalid scalar: out of range");if(o===Zt||e.is0())return T.ZERO;if(o===Pt)return e;if(K.hasCache(this))return this.multiply(o);if(t){let{k1neg:i,k1:n,k2neg:f,k2:u}=Rt(o),{p1:v,p2:s}=qr(T,e,n,u);return Ot(t.beta,v,s,i,f)}else return K.unsafe(e,o)}multiplyAndAddUnsafe(o,t,e){let i=this.multiplyUnsafe(t).add(o.multiplyUnsafe(e));return i.is0()?void 0:i}toAffine(o){return xt(this,o)}isTorsionFree(){let{isTorsionFree:o}=m;return g===Pt?!0:o?o(T,this):K.unsafe(this,M).is0()}clearCofactor(){let{clearCofactor:o}=m;return g===Pt?this:o?o(T,this):this.multiplyUnsafe(g)}isSmallOrder(){return this.multiplyUnsafe(g).is0()}toBytes(o=!0){return Wt(o,"isCompressed"),this.assertValidity(),E(T,this,o)}toHex(o=!0){return Gt(this.toBytes(o))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(o=!0){return this.toBytes(o)}_setWindowSize(o){this.precompute(o)}static normalizeZ(o){return ie(T,o)}static msm(o,t){return Ar(T,h,o,t)}static fromPrivateKey(o){return T.BASE.multiply(Yt(h,o))}}T.BASE=new T(w.Gx,w.Gy,a.ONE),T.ZERO=new T(a.ZERO,a.ONE,a.ZERO),T.Fp=a,T.Fn=h;let kt=h.BITS,K=new re(T,m.endo?Math.ceil(kt/2):kt);return T.BASE.precompute(8),T}function Nr(c){return Uint8Array.of(c?2:3)}function Zr(c,m){return{secretKey:m.BYTES,publicKey:1+c.BYTES,publicKeyUncompressed:1+2*c.BYTES,publicKeyHasPrefix:!0,signature:2*m.BYTES}}function Jr(c,m={}){let{Fn:d}=c,a=m.randomBytes||_e,h=Object.assign(Zr(c.Fp,d),{seed:Ze(d.ORDER)});function w(E){try{return!!Yt(d,E)}catch{return!1}}function g(E,R){let{publicKey:O,publicKeyUncompressed:L}=h;try{let V=E.length;return R===!0&&V!==O||R===!1&&V!==L?!1:!!c.fromBytes(E)}catch{return!1}}function M(E=a(h.seed)){return Te(Kt(E,h.seed,"seed"),d.ORDER)}function b(E,R=!0){return c.BASE.multiply(Yt(d,E)).toBytes(R)}function _(E){let R=M(E);return{secretKey:R,publicKey:b(R)}}function q(E){if(typeof E=="bigint")return!1;if(E instanceof c)return!0;let{secretKey:R,publicKey:O,publicKeyUncompressed:L}=h;if(d.allowedLengths||R===O)return;let V=_t("key",E).length;return V===O||V===L}function N(E,R,O=!0){if(q(E)===!0)throw new Error("first arg must be private key");if(q(R)===!1)throw new Error("second arg must be public key");let L=Yt(d,E);return c.fromHex(R).multiply(L).toBytes(O)}return Object.freeze({getPublicKey:b,getSharedSecret:N,keygen:_,Point:c,utils:{isValidSecretKey:w,isValidPublicKey:g,randomSecretKey:M,isValidPrivateKey:w,randomPrivateKey:M,normPrivateKeyToScalar:E=>Yt(d,E),precompute(E=8,R=c.BASE){return R.precompute(E,!1)}},lengths:h})}function Fr(c,m,d={}){fr(m),jt(d,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let a=d.randomBytes||_e,h=d.hmac||((t,...e)=>ar(m,t,Lt(...e))),{Fp:w,Fn:g}=c,{ORDER:M,BITS:b}=g,{keygen:_,getPublicKey:q,getSharedSecret:N,utils:p,lengths:E}=Jr(c,d),R={prehash:!1,lowS:typeof d.lowS=="boolean"?d.lowS:!1,format:void 0,extraEntropy:!1},O="compact";function L(t){let e=M>>Pt;return t>e}function V(t,e){if(!g.isValidNot0(e))throw new Error(`invalid signature ${t}: out of range 1..Point.Fn.ORDER`);return e}function Tt(t,e){Ue(e);let i=E.signature,n=e==="compact"?i:e==="recovered"?i+1:void 0;return Kt(t,n,`${e} signature`)}class z{constructor(e,i,n){this.r=V("r",e),this.s=V("s",i),n!=null&&(this.recovery=n),Object.freeze(this)}static fromBytes(e,i=O){Tt(e,i);let n;if(i==="der"){let{r:s,s:r}=Nt.toSig(Kt(e));return new z(s,r)}i==="recovered"&&(n=e[0],i="compact",e=e.subarray(1));let f=g.BYTES,u=e.subarray(0,f),v=e.subarray(f,f*2);return new z(g.fromBytes(u),g.fromBytes(v),n)}static fromHex(e,i){return this.fromBytes(Ee(e),i)}addRecoveryBit(e){return new z(this.r,this.s,e)}recoverPublicKey(e){let i=w.ORDER,{r:n,s:f,recovery:u}=this;if(u==null||![0,1,2,3].includes(u))throw new Error("recovery id invalid");if(M*Or<i&&u>1)throw new Error("recovery id is ambiguous for h>1 curve");let s=u===2||u===3?n+M:n;if(!w.isValid(s))throw new Error("recovery id 2 or 3 invalid");let r=w.toBytes(s),l=c.fromBytes(Lt(Nr((u&1)===0),r)),x=g.inv(s),y=Rt(_t("msgHash",e)),B=g.create(-y*x),S=g.create(f*x),I=c.BASE.multiplyUnsafe(B).add(l.multiplyUnsafe(S));if(I.is0())throw new Error("point at infinify");return I.assertValidity(),I}hasHighS(){return L(this.s)}toBytes(e=O){if(Ue(e),e==="der")return Ee(Nt.hexFromSig(this));let i=g.toBytes(this.r),n=g.toBytes(this.s);if(e==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return Lt(Uint8Array.of(this.recovery),i,n)}return Lt(i,n)}toHex(e){return Gt(this.toBytes(e))}assertValidity(){}static fromCompact(e){return z.fromBytes(_t("sig",e),"compact")}static fromDER(e){return z.fromBytes(_t("sig",e),"der")}normalizeS(){return this.hasHighS()?new z(this.r,g.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Gt(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Gt(this.toBytes("compact"))}}let Bt=d.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");let i=Ct(e),n=e.length*8-b;return n>0?i>>BigInt(n):i},Rt=d.bits2int_modN||function(e){return g.create(Bt(e))},xt=Ht(b);function It(t){return hr("num < 2^"+b,t,Zt,xt),g.toBytes(t)}function Ot(t,e){return Kt(t,void 0,"message"),e?Kt(m(t),void 0,"prehashed message"):t}function T(t,e,i){if(["recovered","canonical"].some(B=>B in i))throw new Error("sign() legacy options not supported");let{lowS:n,prehash:f,extraEntropy:u}=He(i,R);t=Ot(t,f);let v=Rt(t),s=Yt(g,e),r=[It(s),It(v)];if(u!=null&&u!==!1){let B=u===!0?a(E.secretKey):u;r.push(_t("extraEntropy",B))}let l=Lt(...r),x=v;function y(B){let S=Bt(B);if(!g.isValidNot0(S))return;let I=g.inv(S),A=c.BASE.multiply(S).toAffine(),U=g.create(A.x);if(U===Zt)return;let k=g.create(I*g.create(x+U*s));if(k===Zt)return;let H=(A.x===U?0:2)|Number(A.y&Pt),Xt=k;return n&&L(k)&&(Xt=g.neg(k),H^=1),new z(U,Xt,H)}return{seed:l,k2sig:y}}function kt(t,e,i={}){t=_t("message",t);let{seed:n,k2sig:f}=T(t,e,i);return lr(m.outputLen,g.BYTES,h)(n,f)}function K(t){let e,i=typeof t=="string"||or(t),n=!i&&t!==null&&typeof t=="object"&&typeof t.r=="bigint"&&typeof t.s=="bigint";if(!i&&!n)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(n)e=new z(t.r,t.s);else if(i){try{e=z.fromBytes(_t("sig",t),"der")}catch(f){if(!(f instanceof Nt.Err))throw f}if(!e)try{e=z.fromBytes(_t("sig",t),"compact")}catch{return!1}}return e||!1}function Z(t,e,i,n={}){let{lowS:f,prehash:u,format:v}=He(n,R);if(i=_t("publicKey",i),e=Ot(_t("message",e),u),"strict"in n)throw new Error("options.strict was renamed to lowS");let s=v===void 0?K(t):z.fromBytes(_t("sig",t),v);if(s===!1)return!1;try{let r=c.fromBytes(i);if(f&&s.hasHighS())return!1;let{r:l,s:x}=s,y=Rt(e),B=g.inv(x),S=g.create(y*B),I=g.create(l*B),A=c.BASE.multiplyUnsafe(S).add(r.multiplyUnsafe(I));return A.is0()?!1:g.create(A.x)===l}catch{return!1}}function o(t,e,i={}){let{prehash:n}=He(i,R);return e=Ot(e,n),z.fromBytes(t,"recovered").recoverPublicKey(e).toBytes()}return Object.freeze({keygen:_,getPublicKey:q,getSharedSecret:N,utils:p,lengths:E,Point:c,sign:kt,verify:Z,recoverPublicKey:o,Signature:z,hash:m})}function ti(c){let m={a:c.a,b:c.b,p:c.Fp.ORDER,n:c.n,h:c.h,Gx:c.Gx,Gy:c.Gy},d=c.Fp,a=c.allowedPrivateKeyLengths?Array.from(new Set(c.allowedPrivateKeyLengths.map(g=>Math.ceil(g/2)))):void 0,h=Ut(m.n,{BITS:c.nBitLength,allowedLengths:a,modFromBytes:c.wrapPrivateKey}),w={Fp:d,Fn:h,allowInfinityPoint:c.allowInfinityPoint,endo:c.endo,isTorsionFree:c.isTorsionFree,clearCofactor:c.clearCofactor,fromBytes:c.fromBytes,toBytes:c.toBytes};return{CURVE:m,curveOpts:w}}function ei(c){let{CURVE:m,curveOpts:d}=ti(c),a={hmac:c.hmac,randomBytes:c.randomBytes,lowS:c.lowS,bits2int:c.bits2int,bits2int_modN:c.bits2int_modN};return{CURVE:m,curveOpts:d,hash:c.hash,ecdsaOpts:a}}function ri(c,m){let d=m.Point;return Object.assign({},m,{ProjectivePoint:d,CURVE:Object.assign({},c,ee(d.Fn.ORDER,d.Fn.BITS))})}function Tr(c){let{CURVE:m,curveOpts:d,hash:a,ecdsaOpts:h}=ei(c),w=Qr(m,d),g=Fr(w,a,h);return ri(c,g)}function kr(c,m){let d=a=>Tr({...c,hash:a});return{...d(m),create:d}}var Ce={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},ii={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]};var Lr=BigInt(2);function ni(c){let m=Ce.p,d=BigInt(3),a=BigInt(6),h=BigInt(11),w=BigInt(22),g=BigInt(23),M=BigInt(44),b=BigInt(88),_=c*c*c%m,q=_*_*c%m,N=At(q,d,m)*q%m,p=At(N,d,m)*q%m,E=At(p,Lr,m)*_%m,R=At(E,h,m)*E%m,O=At(R,w,m)*R%m,L=At(O,M,m)*O%m,V=At(L,b,m)*L%m,Tt=At(V,M,m)*O%m,z=At(Tt,d,m)*q%m,Bt=At(z,g,m)*R%m,Rt=At(Bt,a,m)*_%m,xt=At(Rt,Lr,m);if(!ze.eql(ze.sqr(xt),c))throw new Error("Cannot find square root");return xt}var ze=Ut(Ce.p,{sqrt:ni}),Ii=kr({...Ce,Fp:ze,lowS:!0,endo:ii},Jt);export{Ur as a,qt as b,At as c,ci as d,Ut as e,ie as f,re as g,Ar as h,Rr as i,hi as j,Ii as k};
