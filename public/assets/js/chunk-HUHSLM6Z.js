import{m as yt,o as Le,u as j}from"./chunk-GWB75M73.js";import{a,b as f,f as de}from"./chunk-W44JATXS.js";import{d as D,g as _}from"./chunk-BG6P72OF.js";var tt=D((Hr,et)=>{et.exports=Xe;function Xe(t,e){if(t&&e)return Xe(t)(e);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(i){r[i]=t[i]}),r;function r(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];var o=t.apply(this,i),s=i[i.length-1];return typeof o=="function"&&o!==s&&Object.keys(s).forEach(function(c){o[c]=s[c]}),o}}});var oe=D((Wr,Te)=>{var rt=tt();Te.exports=rt(ne);Te.exports.strict=rt(it);ne.proto=ne(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return ne(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return it(this)},configurable:!0})});function ne(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function it(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}});var ge=D((Fr,ot)=>{var Gt=oe(),Vt=function(){},kt=global.Bare?queueMicrotask:process.nextTick.bind(process),jt=function(t){return t.setHeader&&typeof t.abort=="function"},Bt=function(t){return t.stdio&&Array.isArray(t.stdio)&&t.stdio.length===3},nt=function(t,e,r){if(typeof e=="function")return nt(t,null,e);e||(e={}),r=Gt(r||Vt);var i=t._writableState,n=t._readableState,o=e.readable||e.readable!==!1&&t.readable,s=e.writable||e.writable!==!1&&t.writable,c=!1,d=function(){t.writable||l()},l=function(){s=!1,o||r.call(t)},T=function(){o=!1,s||r.call(t)},h=function(C){r.call(t,C?new Error("exited with error code: "+C):null)},S=function(C){r.call(t,C)},m=function(){kt(p)},p=function(){if(!c){if(o&&!(n&&n.ended&&!n.destroyed))return r.call(t,new Error("premature close"));if(s&&!(i&&i.ended&&!i.destroyed))return r.call(t,new Error("premature close"))}},R=function(){t.req.on("finish",l)};return jt(t)?(t.on("complete",l),t.on("abort",m),t.req?R():t.on("request",R)):s&&!i&&(t.on("end",d),t.on("close",d)),Bt(t)&&t.on("exit",h),t.on("end",T),t.on("finish",l),e.error!==!1&&t.on("error",S),t.on("close",m),function(){c=!0,t.removeListener("complete",l),t.removeListener("abort",m),t.removeListener("request",R),t.req&&t.req.removeListener("finish",l),t.removeListener("end",d),t.removeListener("close",d),t.removeListener("finish",l),t.removeListener("exit",h),t.removeListener("end",T),t.removeListener("error",S),t.removeListener("close",m)}};ot.exports=nt});var st=D(()=>{});var we=D((kr,ct)=>{var Yt=oe(),qt=ge(),se;try{se=st()}catch{}var $=function(){},$t=typeof process>"u"?!1:/^v?\.0/.test(process.version),ae=function(t){return typeof t=="function"},zt=function(t){return!$t||!se?!1:(t instanceof(se.ReadStream||$)||t instanceof(se.WriteStream||$))&&ae(t.close)},Kt=function(t){return t.setHeader&&ae(t.abort)},Jt=function(t,e,r,i){i=Yt(i);var n=!1;t.on("close",function(){n=!0}),qt(t,{readable:e,writable:r},function(s){if(s)return i(s);n=!0,i()});var o=!1;return function(s){if(!n&&!o){if(o=!0,zt(t))return t.close($);if(Kt(t))return t.abort();if(ae(t.destroy))return t.destroy();i(s||new Error("stream was destroyed"))}}},at=function(t){t()},Qt=function(t,e){return t.pipe(e)},Zt=function(){var t=Array.prototype.slice.call(arguments),e=ae(t[t.length-1]||$)&&t.pop()||$;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var r,i=t.map(function(n,o){var s=o<t.length-1,c=o>0;return Jt(n,s,c,function(d){r||(r=d),d&&i.forEach(at),!s&&(i.forEach(at),e(r))})});return t.reduce(Qt)};ct.exports=Zt});var gt=D((uo,Tt)=>{"use strict";Tt.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var i,n,o;if(Array.isArray(e)){if(i=e.length,i!=r.length)return!1;for(n=i;n--!==0;)if(!t(e[n],r[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),i=o.length,i!==Object.keys(r).length)return!1;for(n=i;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[n]))return!1;for(n=i;n--!==0;){var s=o[n];if(!t(e[s],r[s]))return!1}return!0}return e!==e&&r!==r}});var O={GET_ACCOUNTS:"getAccounts",SOLANA_REQUEST_ACCOUNTS:"solana_requestAccounts",SEND_TRANSACTION:"solana_sendTransaction",SIGN_TRANSACTION:"solana_signTransaction",SIGN_ALL_TRANSACTIONS:"solana_signAllTransactions",SIGN_MESSAGE:"solana_signMessage",SOLANA_PRIVATE_KEY:"solana_privateKey",PRIVATE_KEY:"private_key",SOLANA_PUBLIC_KEY:"solana_publicKey",PUBLIC_KEY:"public_key"},le={SOLANA_MAINNET:"0x65",SOLANA_TESTNET:"0x66",SOLANA_DEVNET:"0x67"},A={GET_ACCOUNTS:"eth_accounts",ETH_TRANSACTION:"eth_sendTransaction",ETH_ESTIMATE_AA_TRANSACTION_GAS:"eth_estimateAATransactionGas",ETH_REQUEST_ACCOUNTS:"eth_requestAccounts",ETH_SEND_RAW_TRANSACTION:"eth_sendRawTransaction",ETH_SIGN:"eth_sign",ETH_SIGN_TYPED_DATA_V4:"eth_signTypedData_v4",PERSONAL_SIGN:"personal_sign",ETH_GET_TRANSACTION_COUNT:"eth_getTransactionCount",ETH_GET_TRANSACTION_BY_HASH:"eth_getTransactionByHash",ETH_GET_TRANSACTION_RECEIPT:"eth_getTransactionReceipt",WATCH_ASSET:"wallet_watchAsset",ETH_GET_BLOCK_BY_HASH:"eth_getBlockByHash",ETH_GET_CODE:"eth_getCode",ETH_GET_GAS_PRICE:"eth_gasPrice",ETH_PRIVATE_KEY:"eth_privateKey",PRIVATE_KEY:"private_key",ETH_PUBLIC_KEY:"eth_publicKey",PUBLIC_KEY:"public_key",SWITCH_CHAIN:"wallet_switchEthereumChain",ADD_CHAIN:"wallet_addEthereumChain"};var Ue=_(de()),ee=Ue.default.getLogger("auth");ee.setLevel("error");var B={light:"light",dark:"dark",auto:"auto"};var He=_(j());function te(){}var De="SYN",ue="ACK",xe="BRK",x=class extends He.Duplex{constructor({name:e,target:r,targetWindow:i=window,targetOrigin:n="*"}){if(super({objectMode:!0}),a(this,"_init",void 0),a(this,"_haveSyn",void 0),a(this,"_name",void 0),a(this,"_target",void 0),a(this,"_targetWindow",void 0),a(this,"_targetOrigin",void 0),a(this,"_onMessage",void 0),a(this,"_synIntervalId",void 0),!e||!r)throw new Error("Invalid input.");this._init=!1,this._haveSyn=!1,this._name=e,this._target=r,this._targetWindow=i,this._targetOrigin=n,this._onMessage=this.onMessage.bind(this),this._synIntervalId=null,window.addEventListener("message",this._onMessage,!1),this._handShake()}_break(){this.cork(),this._write(xe,null,te),this._haveSyn=!1,this._init=!1}_handShake(){this._write(De,null,te),this.cork()}_onData(e){if(!this._init)e===De?(this._haveSyn=!0,this._write(ue,null,te)):e===ue&&(this._init=!0,this._haveSyn||this._write(ue,null,te),this.uncork());else if(e===xe)this._break();else try{this.push(e)}catch(r){this.emit("error",r)}}_postMessage(e){let r=this._targetOrigin;this._targetWindow.postMessage({target:this._target,data:e},r)}onMessage(e){let r=e.data;this._targetOrigin!=="*"&&e.origin!==this._targetOrigin||e.source!==this._targetWindow||typeof r!="object"||r.target!==this._name||!r.data||this._onData(r.data)}_read(){}_write(e,r,i){this._postMessage(e),i()}_destroy(){window.removeEventListener("message",this._onMessage,!1)}};var Fe=_(yt());function We(t,e,r){try{Reflect.apply(t,e,r)}catch(i){setTimeout(()=>{throw i})}}function Rt(t){let e=t.length,r=new Array(e);for(let i=0;i<e;i+=1)r[i]=t[i];return r}var N=class extends Fe.EventEmitter{emit(e,...r){let i=e==="error",n=this._events;if(n!==void 0)i=i&&n.error===void 0;else if(!i)return!1;if(i){let s;if(r.length>0&&([s]=r),s instanceof Error)throw s;let c=new Error(`Unhandled error.${s?` (${s.message})`:""}`);throw c.context=s,c}let o=n[e];if(o===void 0)return!1;if(typeof o=="function")We(o,this,r);else{let s=o.length,c=Rt(o);for(let d=0;d<s;d+=1)We(c[d],this,r)}return!0}};var Ge=_(Le()),P=class extends Error{constructor({code:e,message:r,data:i}){if(!Number.isInteger(e))throw new Error("code must be an integer");if(!r||typeof r!="string")throw new Error("message must be string");super(r),a(this,"code",void 0),a(this,"data",void 0),this.code=e,i!==void 0&&(this.data=i)}toString(){return(0,Ge.default)({code:this.code,message:this.message,data:this.data,stack:this.stack})}};var Ve=_(j()),re=class extends Ve.Duplex{constructor({parent:e,name:r}){super({objectMode:!0}),a(this,"_parent",void 0),a(this,"_name",void 0),this._parent=e,this._name=r}_read(){}_write(e,r,i){this._parent.push({name:this._name,data:e}),i()}};var Je=_(Le());var w={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}},fe={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}};var Ye=function(t,e){if(typeof t>"u"||t===null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)},ke=w.rpc.internal,Pt="Unspecified error message. This is a bug, please report it.",bt="Unspecified server error.";function qe(t){return Number.isInteger(t)}function je(t){return typeof t=="string"&&t.length>0}function ie(t){return!!t&&typeof t=="object"&&!Array.isArray(t)}function $e(t){if(typeof t!="object"||t===null)return!1;try{let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}catch{return!1}}function Mt(t){return t>=-32099&&t<=-32e3}function ze(t){let e=t;return!(!e||!qe(e.code)||!je(e.message)||e.stack&&!je(e.stack))}function Y(t,e=Pt){if(qe(t)){let r=t.toString();if(Ye(fe,r))return fe[r].message;if(Mt(t))return bt}return e}var Lt={code:ke,message:Y(ke)};function he(t){try{JSON.parse(JSON.stringify(t,(e,r)=>{if(e==="__proto__"||e==="constructor")throw new Error("Not valid json");if(typeof r=="function"||typeof r=="symbol")throw new Error("Not valid json");return r}),(e,r)=>{if(!(e==="__proto__"||e==="constructor"))return r})}catch{return!1}return!0}function Be(t){return Object.getOwnPropertyNames(t).reduce((e,r)=>{let i=t[r];return he(i)&&(e[r]=i),e},{})}function me(t){return Array.isArray(t)?t.map(e=>he(e)?e:ie(e)?Be(e):null):ie(t)?Be(t):he(t)?t:null}function Ut(t,e){if(t&&typeof t=="object"&&"serialize"in t&&typeof t.serialize=="function")return t.serialize();if(ze(t))return t;let r=me(t);return f(f({},e),{},{data:{cause:r}})}function pe(t,{fallbackError:e=Lt,shouldIncludeStack:r=!0}={}){if(!ze(e))throw new Error("Must provide fallback error with integer number code and string message.");let i=Ut(t,e);return r||delete i.stack,i}function Ke(t){return ie(t)&&Ye(t,"cause")&&ie(t.cause)}var Dt=function(t,e){if(typeof t>"u"||t===null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)};function xt(t){return Number.isInteger(t)&&t>=1e3&&t<=4999}function Ht(t,e){if(e!=="[Circular]")return e}var H=class extends Error{constructor(e,r,i){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!r||typeof r!="string")throw new Error('"message" must be a non-empty string.');Ke(i)?(super(r,{cause:i.cause}),a(this,"cause",void 0),a(this,"code",void 0),a(this,"data",void 0),Dt(this,"cause")||Object.assign(this,{cause:i.cause})):(super(r),a(this,"cause",void 0),a(this,"code",void 0),a(this,"data",void 0)),i!==void 0&&(this.data=i),this.code=e,this.cause=i?.cause}serialize(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data,$e(this.data)&&(e.data.cause=me(this.data.cause))),this.stack&&(e.stack=this.stack),e}toString(){return(0,Je.default)(this.serialize(),{replacer:Ht,space:2})}},v=class extends H{constructor(e,r,i){if(!xt(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,r,i)}};function Wt(t){if(t){if(typeof t=="string")return[t];if(typeof t=="object"&&!Array.isArray(t)){let{message:e,data:r}=t;if(e&&typeof e!="string")throw new Error("Must specify string message.");return[e??void 0,r]}}return[]}function I(t,e){let[r,i]=Wt(e);return new H(t,r??Y(t),i)}var L={parse:t=>I(w.rpc.parse,t),invalidRequest:t=>I(w.rpc.invalidRequest,t),invalidParams:t=>I(w.rpc.invalidParams,t),methodNotFound:t=>I(w.rpc.methodNotFound,t),internal:t=>I(w.rpc.internal,t),server:t=>{if(!t||typeof t!="object"||Array.isArray(t))throw new Error("Ethereum RPC Server errors must provide single object argument.");let{code:e}=t;if(!Number.isInteger(e)||e>-32005||e<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return I(e,t)},invalidInput:t=>I(w.rpc.invalidInput,t),resourceNotFound:t=>I(w.rpc.resourceNotFound,t),resourceUnavailable:t=>I(w.rpc.resourceUnavailable,t),transactionRejected:t=>I(w.rpc.transactionRejected,t),methodNotSupported:t=>I(w.rpc.methodNotSupported,t),limitExceeded:t=>I(w.rpc.limitExceeded,t)};var Qe=_(j());var W=(t,e,r=!0)=>(i,n)=>{i||n.error?e(i||n.error):!r||Array.isArray(n)?t(n):t(n.result)};function _e(){let t={};function e(){return!1}let r=new N;function i(d){let l=t[d.id];if(!l)throw new Error(`StreamMiddleware - Unknown response id "${d.id}"`);delete t[d.id],Object.assign(l.res,d),setTimeout(l.end)}function n(d){r.emit("notification",d)}function o(d,l,T){let h;try{!d.id?n(d):i(d)}catch(S){h=S}T(h)}let s=new Qe.Duplex({objectMode:!0,read:e,write:o});return{events:r,middleware:(d,l,T,h)=>{s.push(d),t[d.id]={req:d,res:l,next:T,end:h}},stream:s}}function Ee(){return(t,e,r,i)=>{let n=t.id,o=Math.random().toString(36).slice(2);t.id=o,e.id=o,r(s=>{t.id=n,e.id=n,s()})}}var Ft=_(j());function Ze(t){let{message:e="",code:r=-32603,stack:i="Stack trace is not available.",data:n=""}=t,o=parseInt(r?.toString()||"-32603");return{message:e||t?.toString()||Y(o),code:o,stack:i,data:n||e||t?.toString()}}var q=class t extends N{constructor(){super(),a(this,"_middleware",void 0),this._middleware=[]}static async _runAllMiddleware(e,r,i){let n=[],o=null,s=!1;for(let c of i)if([o,s]=await t._runMiddleware(e,r,c,n),s)break;return[o,s,n.reverse()]}static _runMiddleware(e,r,i,n){return new Promise(o=>{let s=d=>{let l=d||r.error;l&&(typeof l=="object"&&Object.keys(l).includes("stack")===!1&&(l.stack="Stack trace is not available."),ee.error(l),r.error=pe(l,{shouldIncludeStack:!0,fallbackError:Ze(l)})),o([l,!0])},c=d=>{r.error?s(r.error):(d&&(typeof d!="function"&&s(new P({code:-32603,message:"JRPCEngine: 'next' return handlers must be functions"})),n.push(d)),o([null,!1]))};try{i(e,r,c,s)}catch(d){s(d)}})}static async _runReturnHandlers(e){for(let r of e)await new Promise((i,n)=>{r(o=>o?n(o):i())})}static _checkForCompletion(e,r,i){if(!("result"in r)&&!("error"in r))throw new P({code:-32603,message:"Response has no error or result for request"});if(!i)throw new P({code:-32603,message:"Nothing ended request"})}push(e){this._middleware.push(e)}handle(e,r){if(r&&typeof r!="function")throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?r?this._handleBatch(e,r):this._handleBatch(e):r?this._handle(e,r):this._promiseHandle(e)}asMiddleware(){return async(e,r,i,n)=>{try{let[o,s,c]=await t._runAllMiddleware(e,r,this._middleware);return s?(await t._runReturnHandlers(c),n(o)):i(async d=>{try{await t._runReturnHandlers(c)}catch(l){return d(l)}return d()})}catch(o){return n(o)}}}async _handleBatch(e,r){try{let i=await Promise.all(e.map(this._promiseHandle.bind(this)));return r?r(null,i):i}catch(i){if(r)return r(i);throw i}}_promiseHandle(e){return new Promise((r,i)=>{this._handle(e,(n,o)=>{n&&o===void 0?i(n):r(o)}).catch(i)})}async _handle(e,r){if(!e||Array.isArray(e)||typeof e!="object"){let s=new P({code:-32603,message:"request must be plain object"});return r(s,{id:void 0,jsonrpc:"2.0",error:s})}if(typeof e.method!="string"){let s=new P({code:-32603,message:"method must be string"});return r(s,{id:e.id,jsonrpc:"2.0",error:s})}let i=f({},e),n={id:i.id,jsonrpc:i.jsonrpc},o=null;try{await this._processRequest(i,n)}catch(s){o=s}return o&&(delete n.result,n.error||(typeof o=="object"&&Object.keys(o).includes("stack")===!1&&(o.stack="Stack trace is not available."),ee.error(o),n.error=pe(o,{shouldIncludeStack:!0,fallbackError:Ze(o)}))),r(o,n)}async _processRequest(e,r){let[i,n,o]=await t._runAllMiddleware(e,r,this._middleware);if(t._checkForCompletion(e,r,n),await t._runReturnHandlers(o),i)throw i}};var Ae=_(ge()),dt=_(oe()),Xt=_(we()),lt=_(j());var Se=Symbol("IGNORE_SUBSTREAM"),z=class extends lt.Duplex{constructor(e={}){super(f(f({},e),{},{objectMode:!0})),a(this,"_substreams",void 0),a(this,"getStream",void 0),this._substreams={}}createStream(e){if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error(`ObjectMultiplex - Substream for name "${e}" already exists`);let r=new re({parent:this,name:e});return this._substreams[e]=r,er(this,i=>r.destroy(i||void 0)),r}ignoreStream(e){if(!e)throw new Error("ObjectMultiplex - name must not be empty");if(this._substreams[e])throw new Error(`ObjectMultiplex - Substream for name "${e}" already exists`);this._substreams[e]=Se}_read(){}_write(e,r,i){let{name:n,data:o}=e;if(!n)return window.console.warn(`ObjectMultiplex - malformed chunk without name "${e}"`),i();let s=this._substreams[n];return s?(s!==Se&&s.push(o),i()):(window.console.warn(`ObjectMultiplex - orphaned data for stream "${n}"`),i())}};function er(t,e){let r=(0,dt.default)(e);(0,Ae.default)(t,{readable:!1},r),(0,Ae.default)(t,{writable:!1},r)}var Ie={height:660,width:375};var Ce={height:700,width:1200},Oe={height:700,width:450};var Ne="setup_complete";var b={IFRAME_STATUS:"iframe_status",CLOSE_WINDOW:"close_window",USER_LOGGED_IN:"user_logged_in",USER_LOGGED_OUT:"user_logged_out",TOGGLE_WIDGET_BUTTON:"toggle_widget_button",ALLOW_WALLET_SERVICE:"allow_wallet_service"},g={LOGOUT:"logout",WALLET_INSTANCE_ID:"wallet_instance_id",USER_INFO:"user_info",SET_PROVIDER:"set_provider",TOPUP:"topup",IFRAME_STATUS:"iframe_status",CLOSED_WINDOW:"closed_window",WINDOW_BLOCKED:"window_blocked",GET_PROVIDER_STATE:"get_provider_state",LOGIN_WITH_PRIVATE_KEY:"login_with_private_key",SHOW_WALLET_CONNECT:"show_wallet_connect",SHOW_CHECKOUT:"show_checkout",SHOW_WALLET_UI:"show_wallet_ui",SHOW_SWAP:"show_swap",LOGIN_WITH_SESSION_ID:"login_with_session_id"},K={GET_PROVIDER_STATE:"wallet_get_provider_state",WALLET_SWITCH_CHAIN:"wallet_switchChain"},J={ACCOUNTS_CHANGED:"wallet_accounts_changed",CHAIN_CHANGED:"wallet_chain_changed",UNLOCK_STATE_CHANGED:"wallet_unlock_state_changed"};var y={POPUP:"popup",MODAL:"modal",AUTO_APPROVE:"auto-approve",DEFAULT:"default"};var Q=()=>Math.random().toString(36).slice(2);function F({width:t,height:e}){let r=window.screenLeft!==void 0?window.screenLeft:window.screenX,i=window.screenTop!==void 0?window.screenTop:window.screenY,n=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,s=1,c=Math.abs((n-t)/2/s+r),d=Math.abs((o-e)/2/s+i);return`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${e/s},width=${t/s},top=${d},left=${c}`}var ve=_(de());function ye(t){return function(r,i,n){n(o=>{i.error&&ve.default.warn(`Error in RPC response:
`,i),!r.isTorusInternal&&(ve.default.info(`RPC (${t.origin}):`,r,"->",i),o())})}}var Re=_(we());function ut(t){return t!==null&&typeof t=="object"&&typeof t.pipe=="function"}function tr(t){return ut(t)&&t.writable!==!1&&typeof t._write=="function"&&typeof t._writableState=="object"}function rr(t){return ut(t)&&t.readable!==!1&&typeof t._read=="function"&&typeof t._readableState=="object"}function ft(t){return tr(t)&&rr(t)}var E={errors:{disconnected:()=>"Web3Auth: Lost connection to Web3Auth.",permanentlyDisconnected:()=>"Web3Auth: Disconnected from iframe. Page reload required.",unsupportedSync:t=>`Web3Auth: The Web3Auth Ethereum provider does not support synchronous methods like ${t} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:t=>`Invalid options. Received: { maxEventListeners: ${t}}`,invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:t=>`'args.logger' must include required method '${t}'.`},info:{connected:t=>`Web3Auth: Connected to chain with ID "${t}".`}};var ht=_(de()),u=ht.default.getLogger("ws-embed");function mt(){return(t,e,r)=>{(typeof t.method!="string"||!t.method)&&(e.error=L.invalidRequest({message:"The request 'method' must be a non-empty string.",data:f(f({},t||{}),{},{cause:"The request 'method' must be a non-empty string."})})),r(i=>{let{error:n}=e;return n&&u.error(`Ws-Embed - RPC Error: ${n.message}`,n),i()})}}function pt(t,e,r){let i=`Web3Auth: Lost connection to "${t}".`;e!=null&&e.stack&&(i+=`
${e.stack}`),u.warn(i),r&&r.listenerCount("error")>0&&r.emit("error",i)}var _t=["eth_subscription"];var G=class extends N{constructor(e,{maxEventListeners:r=100,jsonRpcStreamName:i="provider"}){if(super(),a(this,"rpcEngine",void 0),a(this,"jsonRpcConnectionEvents",void 0),a(this,"isWeb3Auth",void 0),a(this,"state",void 0),!ft(e))throw new Error(E.errors.invalidDuplexStream());this.isWeb3Auth=!0,this.setMaxListeners(r),this.handleConnect=this.handleConnect.bind(this),this.handleDisconnect=this.handleDisconnect.bind(this),this.handleStreamDisconnect=this.handleStreamDisconnect.bind(this),this.rpcRequest=this.rpcRequest.bind(this),this.initializeState=this.initializeState.bind(this),this.request=this.request.bind(this),this.sendAsync=this.sendAsync.bind(this),this.send=this.send.bind(this);let n=new z;(0,Re.default)(e,n,e,this.handleStreamDisconnect.bind(this,"Web3Auth")),n.ignoreStream("phishing");let o=_e();(0,Re.default)(o.stream,n.createStream(i),o.stream,this.handleStreamDisconnect.bind(this,"Web3Auth RpcProvider"));let s=new q;s.push(Ee()),s.push(mt()),s.push(ye({origin:location.origin})),s.push(o.middleware),this.rpcEngine=s,this.jsonRpcConnectionEvents=o.events}async request(e){if(!e||typeof e!="object"||Array.isArray(e))throw L.invalidRequest({message:E.errors.invalidRequestArgs(),data:f(f({},e||{}),{},{cause:E.errors.invalidRequestArgs()})});let{method:r,params:i}=e;if(typeof r!="string"||r.length===0)throw L.invalidRequest({message:E.errors.invalidRequestMethod(),data:f(f({},e||{}),{},{cause:E.errors.invalidRequestArgs()})});if(i!==void 0&&!Array.isArray(i)&&(typeof i!="object"||i===null))throw L.invalidRequest({message:E.errors.invalidRequestParams(),data:f(f({},e||{}),{},{cause:E.errors.invalidRequestArgs()})});return new Promise((n,o)=>{this.rpcRequest({method:r,params:i},W(n,o))})}send(e,r){this.rpcRequest(e,r)}sendAsync(e){return new Promise((r,i)=>{this.rpcRequest(e,W(r,i))})}handleStreamDisconnect(e,r){pt(e,r,this),this.handleDisconnect(!1,r?r.message:void 0)}};var U={PRODUCTION:"production",STAGING:"staging",DEVELOPMENT:"development",TESTING:"testing"},M={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"};var ce=class extends N{constructor({url:e,target:r,features:i,timeout:n=3e4}){super(),a(this,"url",void 0),a(this,"target",void 0),a(this,"features",void 0),a(this,"window",void 0),a(this,"windowTimer",void 0),a(this,"iClosedWindow",void 0),a(this,"timeout",void 0),this.url=e,this.target=r||"_blank",this.features=i||F(Ce),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this.timeout=n,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),setTimeout(()=>{this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0},this.timeout)),this.window===void 0&&clearInterval(this.windowTimer)},500))}open(){var e;this.window=window.open(this.url.href,this.target,this.features),(e=this.window)!==null&&e!==void 0&&e.focus&&this.window.focus()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url.href):window.location.href=this.url.href}};var Z=class t extends G{constructor(e,{maxEventListeners:r=100,jsonRpcStreamName:i="provider"},n){super(e,{maxEventListeners:r,jsonRpcStreamName:i}),a(this,"tryWindowHandle",void 0),a(this,"windowRefs",void 0),a(this,"iframeUrl",void 0),a(this,"iframeId",void 0),this.state=f(f({},t.defaultState),n),this.iframeUrl="",this.iframeId="",this.windowRefs=new Map,this.on("connect",()=>{this.state.isConnected=!0});let o=s=>{let{method:c,params:d}=s;if(c===b.IFRAME_STATUS){let{isFullScreen:l,rid:T}=d;this.displayIframe({isFull:l,rid:T},!0)}else if(c===b.CLOSE_WINDOW)this.handleCloseWindow(d);else if(c===b.USER_LOGGED_IN){let{currentAuthConnection:l}=d;this.state.isLoggedIn=!0,this.state.currentAuthConnection=l}else if(c===b.USER_LOGGED_OUT)this.state.isLoggedIn=!1,this.state.currentAuthConnection=null,this.displayIframe({isFull:!1},!0);else if(c===b.TOGGLE_WIDGET_BUTTON){let{show:l}=d;this.state.widgetVisibility=l,this.displayIframe()}else if(c===b.ALLOW_WALLET_SERVICE){let{allow:l}=d;this.state.allowWalletService=l}};this.jsonRpcConnectionEvents.on("notification",o)}get isLoggedIn(){return this.state.isLoggedIn}get isIFrameFullScreen(){return this.state.isIFrameFullScreen}get allowWalletService(){return this.state.allowWalletService}isConnected(){return this.state.isConnected}async initializeState(e){try{let{torusUrl:r,torusIframeId:i}=e;this.iframeUrl=r,this.iframeId=i;let{currentAuthConnection:n,isLoggedIn:o}=await this.request({method:g.GET_PROVIDER_STATE,params:[]});o&&this.handleConnect(n,o)}catch(r){u.error("Web3Auth: Failed to get initial state. Please report this bug.",r)}finally{u.info("initialized communication state"),this.state.initialized=!0}}displayIframe({isFull:e=!1,rid:r=""}={},i=!1){let n={};if(e)n.display="block",n.width="100%",n.height="100%",n.top="0px",n.right="0px",n.left="0px",n.bottom="0px";else switch(n.display=this.state.widgetVisibility?"block":"none",n.height=this.state.widgetVisibility?"70px":"0px",n.width=this.state.widgetVisibility?"70px":"0px",this.state.buttonPosition){case M.TOP_LEFT:n.top="0px",n.left="0px",n.right="auto",n.bottom="auto";break;case M.TOP_RIGHT:n.top="0px",n.right="0px",n.left="auto",n.bottom="auto";break;case M.BOTTOM_RIGHT:n.bottom="0px",n.right="0px",n.top="auto",n.left="auto";break;case M.BOTTOM_LEFT:default:n.bottom="0px",n.left="0px",n.top="auto",n.right="auto";break}let o=document.getElementById(this.iframeId);Object.assign(o.style,n),this.state.isIFrameFullScreen=e,i||this.request({method:g.IFRAME_STATUS,params:{isIFrameFullScreen:e,rid:r}})}async handleWindow(e,{url:r,target:i,features:n,timeout:o}={}){let s=new URL(r||`${this.iframeUrl}/redirect?windowId=${e}&sessionNamespace=${window.location.hostname}`),c=new ce({url:s,target:i,features:n,timeout:o});if(c.open(),!c.window){this.displayIframe({isFull:!0}),this.request({method:g.WINDOW_BLOCKED,params:{windowId:e,finalUrl:s.href}});return}this.windowRefs.set(e,c),c.once("close",()=>{this.windowRefs.delete(e),this.request({method:g.CLOSED_WINDOW,params:{windowId:e}})})}rpcRequest(e,r){let i=r,n=e;Array.isArray(n)||n.jsonrpc||(n.jsonrpc="2.0"),this.rpcEngine.handle(n,i)}handleConnect(e,r){this.state.isConnected||(this.state.isConnected=!0,this.emit("connect",{currentAuthConnection:e,isLoggedIn:r}),u.debug(E.info.connected(e)))}handleDisconnect(e,r){if(this.state.isConnected||!this.state.isPermanentlyDisconnected&&!e){this.state.isConnected=!1;let i;e?(i=new v(1013,r||E.errors.disconnected()),u.debug(i)):(i=new v(1011,r||E.errors.permanentlyDisconnected()),u.error(i),this.state.currentAuthConnection=null,this.state.isLoggedIn=!1,this.state.widgetVisibility=!1,this.state.isIFrameFullScreen=!1,this.state.isPermanentlyDisconnected=!0),this.emit("disconnect",i)}}handleCloseWindow(e){let{windowId:r}=e;this.windowRefs.has(r)&&(this.windowRefs.get(r).close(),this.windowRefs.delete(r))}};a(Z,"defaultState",{buttonPosition:"bottom-left",currentAuthConnection:null,isIFrameFullScreen:!1,widgetVisibility:!1,initialized:!1,isLoggedIn:!1,isPermanentlyDisconnected:!1,isConnected:!1,hasEmittedConnection:!1,allowWalletService:!1});var Et=t=>{let e=window.document.createElement("template"),r=t.trim();return e.innerHTML=r,e.content.firstChild};var wt=_(gt());var V=class t extends G{constructor(e,{maxEventListeners:r=100,jsonRpcStreamName:i="provider"}){super(e,{maxEventListeners:r,jsonRpcStreamName:i}),a(this,"chainId",void 0),a(this,"selectedAddress",void 0),a(this,"tryWindowHandle",void 0),this.state=f({},t.defaultState),this.selectedAddress=null,this.chainId=null,this.handleAccountsChanged=this.handleAccountsChanged.bind(this),this.handleChainChanged=this.handleChainChanged.bind(this),this.handleUnlockStateChanged=this.handleUnlockStateChanged.bind(this),this.on("connect",()=>{this.state.isConnected=!0});let n=o=>{let{method:s,params:c}=o;s===J.ACCOUNTS_CHANGED?this.handleAccountsChanged(c):s===J.UNLOCK_STATE_CHANGED?this.handleUnlockStateChanged(c):s===J.CHAIN_CHANGED?this.handleChainChanged(c):_t.includes(s)&&(this.emit("data",o),this.emit("notification",c.result),this.emit("message",{type:s,data:c}))};this.jsonRpcConnectionEvents.on("notification",n)}isConnected(){return this.state.isConnected}async initializeState(){try{let{accounts:e,chainId:r,isUnlocked:i}=await this.request({method:K.GET_PROVIDER_STATE,params:[]});this.emit("connect",{chainId:r}),this.handleChainChanged({chainId:r}),this.handleUnlockStateChanged({accounts:e,isUnlocked:i}),this.handleAccountsChanged(e)}catch(e){u.error("WsEmbed: Failed to get initial state. Please report this bug.",e)}finally{u.info("initialized provider state"),this.state.initialized=!0}}rpcRequest(e,r,i=!1){let n=r,o=e;if(!Array.isArray(o)){if(o.jsonrpc||(o.jsonrpc="2.0"),[A.GET_ACCOUNTS,A.ETH_REQUEST_ACCOUNTS,O.SOLANA_REQUEST_ACCOUNTS,O.GET_ACCOUNTS].includes(o.method))n=(s,c)=>{this.handleAccountsChanged(c.result||[],o.method==="eth_accounts",i),r(s,c)};else if(o.method==="wallet_getProviderState"){this.rpcEngine.handle(e,n);return}}this.tryWindowHandle(o,n)}handleConnect(e){this.state.isConnected||(this.state.isConnected=!0,this.emit("connect",{chainId:e}),u.debug(E.info.connected(e)))}handleDisconnect(e,r){if(this.state.isConnected||!this.state.isPermanentlyDisconnected&&!e){this.state.isConnected=!1;let i;e?(i=new v(1013,r||E.errors.disconnected()),u.debug(i)):(i=new v(1011,r||E.errors.permanentlyDisconnected()),u.error(i),this.chainId=null,this.state.accounts=null,this.selectedAddress=null,this.state.isUnlocked=!1,this.state.isPermanentlyDisconnected=!0),this.emit("disconnect",i)}}handleAccountsChanged(e,r=!1,i=!1){let n=e;Array.isArray(n)||(u.error("WsEmbed: Received non-array accounts parameter. Please report this bug.",n),n=[]);for(let o of e)if(typeof o!="string"){u.error("WsEmbed: Received non-string account. Please report this bug.",e),n=[];break}(0,wt.default)(this.state.accounts,n)||(r&&Array.isArray(this.state.accounts)&&this.state.accounts.length>0&&!i&&u.error('WsEmbed: "eth_accounts" unexpectedly updated accounts. Please report this bug.',n),this.state.accounts=n,this.emit("accountsChanged",n)),this.selectedAddress!==n[0]&&(this.selectedAddress=n[0]||null)}handleChainChanged({chainId:e}={}){if(!e){u.error("WsEmbed: Received invalid network parameters. Please report this bug.",{chainId:e});return}e==="loading"?this.handleDisconnect(!0):(this.handleConnect(e),e!==this.chainId&&(this.chainId=e,this.state.initialized&&this.emit("chainChanged",this.chainId)))}handleUnlockStateChanged({accounts:e,isUnlocked:r}={}){if(typeof r!="boolean"){u.error("WsEmbed: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:r});return}r!==this.state.isUnlocked&&(this.state.isUnlocked=r,this.handleAccountsChanged(e||[]))}};a(V,"defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});function At(t){return new Promise((e,r)=>{try{let i=document.createElement("img");i.onload=()=>e(!0),i.onerror=()=>e(!1),i.src=t}catch(i){r(i)}})}var ir=t=>{let{document:e}=t,r=e.querySelector('head > meta[property="og:site_name"]');if(r)return r.content;let i=e.querySelector('head > meta[name="title"]');return i?i.content:e.title&&e.title.length>0?e.title:t.location.hostname};async function nr(t){try{let{document:e}=t,r=e.querySelector('head > link[rel="shortcut icon"]');return r&&await At(r.href)||(r=Array.from(e.querySelectorAll('head > link[rel="icon"]')).find(i=>!!i.href),r&&await At(r.href))?r.href:""}catch{return""}}var St=async()=>({name:ir(window),icon:await nr(window)});var or="5.0.22",It=`v${or.split(".")[0]}`,Pe={[U.TESTING]:{url:"https://develop-wallet.web3auth.io",logLevel:"debug"},[U.DEVELOPMENT]:{url:"http://localhost:4050",logLevel:"debug"},[U.STAGING]:{url:`https://staging-wallet.web3auth.io/${It}`,logLevel:"debug"},[U.PRODUCTION]:{url:`https://wallet.web3auth.io/${It}`,logLevel:"error"}};(async function(){try{if(typeof document>"u")return;let e=document.createElement("link"),{url:r}=Pe.production;e.href=`${r}/frame`,e.crossOrigin="anonymous",e.type="text/html",e.rel="prefetch",e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&document.head.appendChild(e)}catch(e){u.warn(e)}})();g.SET_PROVIDER;var sr=new Set([O.SEND_TRANSACTION,O.SIGN_MESSAGE,O.SIGN_TRANSACTION,O.SIGN_ALL_TRANSACTIONS,A.ETH_SIGN,A.ETH_SIGN_TYPED_DATA_V4,A.PERSONAL_SIGN,A.ETH_TRANSACTION,A.ADD_CHAIN,A.SWITCH_CHAIN,K.WALLET_SWITCH_CHAIN]),be=class{constructor({modalZIndex:e=99999,web3AuthClientId:r,web3AuthNetwork:i}){a(this,"isInitialized",void 0),a(this,"modalZIndex",void 0),a(this,"provider",void 0),a(this,"communicationProvider",void 0),a(this,"buttonPosition",void 0),a(this,"web3AuthClientId",void 0),a(this,"web3AuthNetwork",void 0),a(this,"isPluginMode",void 0),a(this,"confirmationStrategy",void 0),a(this,"buildEnv",void 0),a(this,"embedNonce",Q()),this.isInitialized=!1,this.modalZIndex=e,this.web3AuthClientId=r,this.web3AuthNetwork=i}get isLoggedIn(){var e;return((e=this.communicationProvider)===null||e===void 0?void 0:e.isLoggedIn)||!1}get getBuildEnv(){return this.buildEnv}async init({buildEnv:e=U.PRODUCTION,enableLogging:r=!1,chains:i,chainId:n,walletUrls:o,whiteLabel:s,confirmationStrategy:c=y.DEFAULT,accountAbstractionConfig:d,enableKeyExport:l=!1}){if(this.isInitialized)throw new Error("Already initialized");if(!(s?.logoDark&&s?.logoLight))throw new Error("Dapp logo is required to be set in whiteLabel");this.buildEnv=e,this.confirmationStrategy=c;let{url:h,logLevel:S}=o&&o[e]?f(f({},Pe[e]),o[e]):Pe[e];u.info(h,"url loaded"),u.setDefaultLevel(S),r?u.enableAll():u.disableAll();let m=new URL(h);m.pathname.endsWith("/")?m.pathname+="frame":m.pathname+="/frame";let p=new URLSearchParams;p.append("origin",window.location.origin),p.append("nonce",this.embedNonce),m.hash=p.toString();let R=this.getTheme(s?.mode||B.light),C=Et(`<iframe
        id="walletIframe-${this.embedNonce}"
        class="walletIframe-${this.embedNonce}"
        sandbox="allow-popups allow-scripts allow-same-origin allow-forms allow-modals allow-downloads"
        src="${m.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%;
        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex.toString()};
        color-scheme: ${R}"
        allow="clipboard-write"
      ></iframe>`);this.buttonPosition=s?.buttonPosition||M.BOTTOM_LEFT;let k=await St();return new Promise((Ct,Ot)=>{try{window.document.body.appendChild(C);let X=async Me=>{if(Me.origin!==m.origin)return;let{message:Nt,nonce:vt}=Me.data||{};Nt===Ne&&vt===this.embedNonce&&(window.removeEventListener("message",X),C.contentWindow.postMessage({chains:i,chainId:n,dappMetadata:k,enableLogging:r,web3AuthClientId:this.web3AuthClientId,web3AuthNetwork:this.web3AuthNetwork,whiteLabel:s,confirmationStrategy:c,accountAbstractionConfig:d,enableKeyExport:l},m.origin),await this.setupWeb3({torusUrl:h,walletIframe:C}),this.isInitialized=!0,Ct())};window.addEventListener("message",X)}catch(X){Ot(X)}})}async login(e={}){if(!this.isInitialized)throw new Error("Call init() first");let r=this.communicationProvider.isIFrameFullScreen;try{!e.authConnection&&!r&&this.communicationProvider.displayIframe({isFull:!0});let i=await new Promise((n,o)=>{let c=Object.values(le).includes(this.provider.chainId)?O.SOLANA_REQUEST_ACCOUNTS:A.ETH_REQUEST_ACCOUNTS;this.provider.rpcRequest({method:c,params:[e.authConnection,e.login_hint]},W(n,o))});if(u.info("check: res",i),Array.isArray(i)&&i.length>0)return this.confirmationStrategy===y.AUTO_APPROVE&&u.warn("Confirmation strategy auto approve is not allowed on Embed Mode, using Default instead."),i;throw new Error("Login failed")}catch(i){throw u.error("login failed",i),i}finally{r||this.communicationProvider.displayIframe({isFull:!1})}}async loginWithSessionId(e){if(!this.isInitialized)throw new Error("Call init() first");if(!e.sessionId)throw new Error("sessionId is required");try{let r=await this.communicationProvider.request({method:g.LOGIN_WITH_SESSION_ID,params:[e.sessionId,e.sessionNamespace||""]});if(u.info("check: res",r),r.success)return this.isPluginMode=!0,this.confirmationStrategy===y.POPUP&&u.warn("Confirmation strategy popup is not allowed on Plugin Mode, using Default instead."),r.success;throw new Error("Login failed")}catch(r){throw u.error("login with session id failed",r),r}}async logout(){if(!this.communicationProvider.isLoggedIn)throw new Error("Not logged in");await this.communicationProvider.request({method:g.LOGOUT,params:[]})}async cleanUp(){var e;(e=this.communicationProvider)!==null&&e!==void 0&&e.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function e(i){return i instanceof Element||i instanceof Document}let r=window.document.getElementById(`walletIframe-${this.embedNonce}`);e(r)&&r.remove(),this.isInitialized=!1}async getUserInfo(){return await this.communicationProvider.request({method:g.USER_INFO,params:[]})}async showWalletConnectScanner(e){let r=e?e.show:!0;this.communicationProvider.displayIframe({isFull:r});try{await this.communicationProvider.request({method:g.SHOW_WALLET_CONNECT,params:e})}catch{this.communicationProvider.displayIframe({isFull:!1})}}async showWalletUi(e){let r=e?e.show:!0;this.communicationProvider.displayIframe({isFull:r});try{await this.communicationProvider.request({method:g.SHOW_WALLET_UI,params:e})}catch{this.communicationProvider.displayIframe({isFull:!1})}}async showCheckout(e){let r=e?e.show:!0;this.communicationProvider.displayIframe({isFull:r});try{await this.communicationProvider.request({method:g.SHOW_CHECKOUT,params:e})}catch{this.communicationProvider.displayIframe({isFull:!1})}}async showSwap(e){let r=e?e.show:!0;this.communicationProvider.displayIframe({isFull:r});try{await this.communicationProvider.request({method:g.SHOW_SWAP,params:e})}catch{this.communicationProvider.displayIframe({isFull:!1})}}getConfirmationStrategyFinal(e){let r=this.confirmationStrategy;return!Array.isArray(e)&&sr.has(e.method)&&this.confirmationStrategy!==y.MODAL&&!this.isPluginMode&&(r=y.POPUP),r}getTheme(e){return e===B.light?"light":e===B.dark||window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}async setupWeb3(e){u.info("setupWeb3 running");let r=new x({name:"embed_torus",target:"iframe_torus",targetWindow:e.walletIframe.contentWindow,targetOrigin:new URL(e.torusUrl).origin}),i=new x({name:"embed_communication",target:"iframe_communication",targetWindow:e.walletIframe.contentWindow,targetOrigin:new URL(e.torusUrl).origin}),n=new V(r,{}),o=new Z(i,{},{buttonPosition:this.buttonPosition});n.tryWindowHandle=(l,T)=>{let h=l,S=this.getConfirmationStrategyFinal(l),{allowWalletService:m}=o;if(S===y.POPUP&&m){let p=Q();o.handleWindow(p,{target:"_blank",features:F(Oe),timeout:500}),h.windowId=p}n.rpcEngine.handle(h,T)},o.tryWindowHandle=(l,T)=>{let h=l,S=this.getConfirmationStrategyFinal(l),{allowWalletService:m}=o;if(S===y.POPUP&&m){let p=Q();o.handleWindow(p,{target:"_blank",features:F(Ie),timeout:500}),h.params.windowId=p}o.rpcEngine.handle(h,T)};let s=l=>{let T=n[l],h=this;n[l]=function(m,p){let{method:R,params:C=[]}=m;if(R===A.ETH_REQUEST_ACCOUNTS||R===O.SOLANA_REQUEST_ACCOUNTS){if(!p)return h.login({authConnection:C[0]});h.login({authConnection:C[0]}).then(k=>p(null,k)).catch(k=>p(k))}return T.apply(this,[m,p])}};s("request"),s("sendAsync"),s("send");let c=new Proxy(n,{deleteProperty:()=>!0}),d=new Proxy(o,{deleteProperty:()=>!0});this.provider=c,this.communicationProvider=d,u.info("test setupWeb3 "),await Promise.all([n.initializeState(),o.initializeState(f(f({},e),{},{torusIframeId:e.walletIframe.id}))]),u.debug("WsEmbed - injected provider")}};export{O as a,le as b,A as c,y as d,U as e,M as f,V as g,be as h};
